<!doctype html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta charset="utf-8"><meta name="generator" content="quarto-1.8.25"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes"><title>DiscoverSolutions</title><style>code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}div.columns{display:flex;gap:min(4vw,1.5em)}div.column{flex:auto;overflow-x:auto}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}ul.task-list li input[type=checkbox]{width:.8em;margin:0 .8em .2em -1em;vertical-align:middle}html{-webkit-text-size-adjust:100%}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em}pre.numberSource{margin-left:3em;padding-left:4px}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}</style><script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script><link href="../../images/atlas-icon.svg" rel="icon" type="image/svg+xml"><script src="../../site_libs/clipboard/clipboard.min.js"></script><script src="../../site_libs/quarto-html/quarto.js" type="module"></script><script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script><script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script><script src="../../site_libs/quarto-html/popper.min.js"></script><script src="../../site_libs/quarto-html/tippy.umd.min.js"></script><link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet"><link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="../../site_libs/bootstrap/bootstrap.min.js"></script><link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"><link href="../../site_libs/bootstrap/bootstrap-53a0a1c902e82bd70cf7a7f6e7189f61.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&amp;display=swap" rel="stylesheet"><script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet"><link rel="stylesheet" href="../../styles.css"></head><body class="nav-fixed fullcontent quarto-light"><div id="quarto-search-results"></div><header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg" data-bs-theme="dark"><div class="navbar-container container-fluid"><div class="navbar-brand-container mx-auto"><a href="https://adaptationatlas.cgiar.org" class="navbar-brand navbar-brand-logo"><img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo light-content"> <img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo dark-content"></a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="window.quartoToggleHeadroom&&window.quartoToggleHeadroom()"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav navbar-nav-scroll ms-auto"><li class="nav-item"><a class="nav-link" href="../../docs/doc_index.html"><i class="bi bi-info-circle" role="img" aria-label="More Information"></i> <span class="menu-text">Documentation</span></a></li><li class="nav-item"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks/issues/new"><span class="menu-text">Report an Issue</span></a></li><li class="nav-item compact"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks"><i class="bi bi-github" role="img" aria-label="GitHub"></i> <span class="menu-text"></span></a></li></ul></div><div class="quarto-navbar-tools"></div></div></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"><main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><section id="notebook-title" class="level1 title"><h1 class="title"><span><span id="ojs-element-id-1"></span></span></h1><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb1" data-startfrom="13" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 12"><span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>viewof prettyLanguageView <span class="op">=</span> {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span> <span class="st">"Language"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Langue"</span>})<span class="op">,</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    viewof language</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-1" data-nodetype="declaration"></div></div></div></section><section id="overview" class="level1"><h1><span><span id="ojs-element-id-2"></span></span></h1><p><span><span id="ojs-element-id-3"></span></span></p></section><section id="interventions" class="level1"><h1><span><span id="ojs-element-id-4"></span></span></h1><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb2" data-startfrom="31" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 30"><span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">// find total observations</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> raw <span class="op">=</span> d3<span class="op">.</span><span class="fu">sum</span>(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    data_extendedTable2_total<span class="op">,</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">observations</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formatted <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(raw <span class="op">/</span> <span class="dv">1000</span>) <span class="op">*</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> totalObs <span class="op">=</span> <span class="fu">formatNumStandard</span>(formatted<span class="op">,</span> {</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">locale</span><span class="op">:</span> language<span class="op">.</span><span class="at">locale</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langString <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">interventions</span><span class="op">.</span><span class="at">blocks</span><span class="op">.</span><span class="at">opener1</span>)<span class="op">;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formattedString <span class="op">=</span> langString<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(<span class="st">"totalObs"</span>)<span class="op">,</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    totalObs</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>formattedString<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-2" data-nodetype="expression"></div></div></div><div class="cell"><details class="code-fold"><summary>View table code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3" data-startfrom="56" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 55"><span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> data_extendedTable2_total<span class="op">;</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorFill <span class="op">=</span> <span class="st">"#216729"</span><span class="op">;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langLook <span class="op">=</span> {</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="dt">obs</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">700</span><span class="op">,</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">190</span><span class="op">,</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"s"</span><span class="op">,</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">obs</span><span class="op">,</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"center"</span><span class="op">,</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelArrow</span><span class="op">:</span> <span class="st">"none"</span><span class="op">,</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barX</span>(data<span class="op">,</span> {</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">practice</span>)<span class="op">,</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sort</span><span class="op">:</span> { <span class="dt">y</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> colorFill</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textX</span>(</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        data<span class="op">,</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">text</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".2s"</span>)(d)<span class="sc">}</span><span class="vs"> obs.`</span>) }<span class="op">,</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">practice</span>)<span class="op">,</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>            <span class="dt">text</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>            <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dx</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"#333"</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></details><div class="cell-output cell-output-display"><div id="ojs-cell-3" data-nodetype="expression"></div></div></div></section><section id="practicalImpact" class="level1"><h1><span><span id="ojs-element-id-5"></span></span></h1><p><span><span id="ojs-element-id-6"></span></span></p><section id="cropDiff" class="level2"><h2 data-anchor-id="cropDiff"><span><span id="ojs-element-id-7"></span></span></h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb4" data-startfrom="119" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 118"><span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>viewof selectCropMeanDiff_new <span class="op">=</span> {</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(data_meanDiff_practiceCrop_new<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span>))]</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">Crop</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d] }<span class="op">;</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(a<span class="op">.</span><span class="at">translation</span>) <span class="op">&gt;</span> <span class="fu">_lang</span>(b<span class="op">.</span><span class="at">translation</span>))<span class="op">;</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(data<span class="op">,</span> {</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop</span>)<span class="op">,</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>(x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="st">'Maize'</span>)<span class="op">,</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (x) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>viewof radioSortDotPlotCrop_new <span class="op">=</span> {</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">mean</span>)<span class="op">,</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">observations</span>)<span class="op">,</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"nObs"</span><span class="op">,</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"alpha"</span><span class="op">,</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">alpha</span>)<span class="op">,</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(data<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">sort</span>)<span class="op">,</span> <span class="dt">format</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>(x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">'mean'</span>) })<span class="op">;</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>viewof toggleCIsCrop_new <span class="op">=</span> {</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">toggleConfInt</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">visible</span>)</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(data<span class="op">,</span> {</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">confidenceIntervals</span>)</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-3" data-nodetype="declaration"></div></div></div></div><div class="cell"><details class="code-fold"><summary>View table code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5" data-startfrom="169" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 168"><span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plotData <span class="op">=</span> data_meanDiff_practiceCrop_new<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span> <span class="op">===</span> selectCropMeanDiff_new<span class="op">.</span><span class="at">field</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginBottom <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginTop <span class="op">=</span> <span class="dv">60</span><span class="op">;</span></span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yHeight <span class="op">=</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>    marginTop <span class="op">+</span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>    marginBottom <span class="op">+</span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">group</span>(plotData<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Practice</span>)<span class="op">.</span><span class="at">size</span> <span class="op">*</span> yHeight<span class="op">;</span></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _formatNum <span class="op">=</span> formatNum<span class="op">;</span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _toggleCIs <span class="op">=</span> toggleCIsCrop_new<span class="op">;</span></span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _radioSort <span class="op">=</span> radioSortDotPlotCrop_new<span class="op">;</span></span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langLookup <span class="op">=</span> {</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xLabel</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">xMeanDiff</span>)<span class="op">,</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>      <span class="dt">aez</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">aez</span>)<span class="op">,</span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>      <span class="dt">meanDiff</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">meanDiff</span>)<span class="op">,</span></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>      <span class="dt">meanControl</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">meanControl</span>)<span class="op">,</span></span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>      <span class="dt">crop</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">crop</span><span class="op">.</span><span class="at">singular</span>))<span class="op">,</span></span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ciLo</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">ciLower</span>)<span class="op">,</span></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ciHi</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">ciUpper</span>)<span class="op">,</span></span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>      <span class="dt">obs</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>))<span class="op">,</span></span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>))</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>    height<span class="op">,</span></span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>    marginBottom<span class="op">,</span></span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>    marginTop<span class="op">,</span></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">70</span><span class="op">,</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>      <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">xLabel</span><span class="op">,</span></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"center"</span><span class="op">,</span></span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelArrow</span><span class="op">:</span> <span class="st">"none"</span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> colorYellowGreen</span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>      <span class="co">// main y-axis</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({</span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>      <span class="co">// pointer white-out</span></span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStrokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a>      <span class="co">// bold pointer</span></span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>      <span class="co">// zero point</span></span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>]<span class="op">,</span> { <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> [<span class="dv">4</span>] })<span class="op">,</span></span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>      <span class="co">// span lines: CI</span></span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>(_toggleCIs<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> plotData <span class="op">:</span> []<span class="op">,</span> {</span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x1</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Lower</span><span class="op">,</span></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x2</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Upper</span><span class="op">,</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span></span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>      <span class="co">// mean diff dots</span></span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(plotData<span class="op">,</span> {</span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"Mean_Difference"</span><span class="op">,</span></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sort</span><span class="op">:</span> { <span class="dt">y</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">channel</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">reverse</span> }<span class="op">,</span></span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Mean_Difference</span><span class="op">,</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>          <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a>          <span class="dt">prac</span><span class="op">:</span> {</span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>          <span class="dt">crop</span><span class="op">:</span> {</span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Crop"</span></span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a>          <span class="dt">diff</span><span class="op">:</span> {</span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">meanDiff</span><span class="op">,</span></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Mean_Difference"</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a>          <span class="dt">control</span><span class="op">:</span> {</span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">meanControl</span><span class="op">,</span></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">'Mean_Control'</span><span class="op">,</span></span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciLow</span><span class="op">:</span> {</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">ciLo</span><span class="op">,</span></span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Lower"</span></span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciHigh</span><span class="op">:</span> {</span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">ciHi</span><span class="op">,</span></span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Upper"</span></span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tip</span><span class="op">:</span> {</span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a>          <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a>            <span class="dt">prac</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a>            <span class="dt">crop</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nObs</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a>            <span class="dt">diff</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a>            <span class="dt">control</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciLow</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciHigh</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)</span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a>      <span class="co">// dot highlight on hover</span></span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(plotData<span class="op">,</span> Plot<span class="op">.</span><span class="fu">pointer</span>({</span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"Mean_Difference"</span><span class="op">,</span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a>          <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"# Observations"</span><span class="op">,</span></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a>      }))<span class="op">,</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a>      <span class="co">// observation counts</span></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(plotData<span class="op">,</span> {</span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">N_Obs</span> <span class="op">+</span> <span class="st">" obs."</span><span class="op">,</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>        <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>        <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>      <span class="co">// counts white-out</span></span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>        plotData<span class="op">,</span></span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">N_Obs</span> <span class="op">+</span> <span class="st">" obs."</span><span class="op">,</span></span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>          <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>          <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a>      <span class="co">// counts bold hover</span></span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>        plotData<span class="op">,</span></span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">N_Obs</span> <span class="op">+</span> <span class="st">" obs."</span><span class="op">,</span></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>          <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>          <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></details><div class="cell-output cell-output-display"><div id="ojs-cell-5" data-nodetype="expression"></div></div></div><section id="quickinsight" class="level3"><h3 data-anchor-id="quickinsight"><span><span id="ojs-element-id-8"></span></span></h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb6" data-startfrom="358" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 357"><span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a><span class="co">// insights</span></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langRoot <span class="op">=</span> nbText<span class="op">;</span></span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBasePath <span class="op">=</span> langRoot<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiff</span><span class="op">.</span><span class="at">insights</span><span class="op">;</span> <span class="co">// base path for language</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> data_meanDiff_practiceCrop_new<span class="op">;</span></span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selection <span class="op">=</span> selectCropMeanDiff_new<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tl_crop <span class="op">=</span> (crop) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[crop])<span class="op">;</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tl_crop_article <span class="op">=</span> (crop) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop_with_articles</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[crop])<span class="op">;</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tl_prac <span class="op">=</span> (prac) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[prac])<span class="op">;</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a>  <span class="co">// top 5 crops by unique practices</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> top5CropsByPractices <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">count</span>([<span class="st">"Crop"</span>])<span class="op">,</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(T<span class="op">.</span><span class="fu">desc</span>(<span class="st">"n"</span>))<span class="op">,</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceHead</span>(<span class="dv">5</span>)</span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> top5CropsByPracticesString <span class="op">=</span> top5CropsByPractices</span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="op">==</span> top5CropsByPractices<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="vs">`and **</span><span class="sc">${</span><span class="fu">tl_crop</span>(d<span class="op">.</span><span class="at">Crop</span>)<span class="sc">}</span><span class="vs">**`</span><span class="op">;</span></span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`**</span><span class="sc">${</span><span class="fu">tl_crop</span>(d<span class="op">.</span><span class="at">Crop</span>)<span class="sc">}</span><span class="vs">**`</span><span class="op">;</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)<span class="op">;</span></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTop5 <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">top5</span>)<span class="op">;</span></span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTop5Format <span class="op">=</span> langTop5<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>    Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(<span class="st">"top5CropsByPracticesString"</span>)<span class="op">,</span></span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a>    top5CropsByPracticesString</span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightTop5 <span class="op">=</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>langTop5Format<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>  <span class="co">// crop selection</span></span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedCrop <span class="op">=</span> selection<span class="op">;</span></span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCrop <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span> <span class="op">==</span> selectedCrop)</span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a>  <span class="co">// crop overview</span></span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cropOverview <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">summarize</span>({</span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalObs</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"N_Obs"</span>)<span class="op">,</span></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalPractices</span><span class="op">:</span> T<span class="op">.</span><span class="fu">n</span>()</span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropOverview <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">cropOverview</span>)<span class="op">;</span></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropOverviewItems <span class="op">=</span> [</span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"selectedCrop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(<span class="fu">tl_crop_article</span>(selectedCrop)) }<span class="op">,</span></span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(cropOverview<span class="op">.</span><span class="at">totalObs</span>) }<span class="op">,</span></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalPractices"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> cropOverview<span class="op">.</span><span class="at">totalPractices</span> }</span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightCropOverview <span class="op">=</span> langCropOverviewItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langCropOverview)<span class="op">;</span></span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a>  <span class="co">// positive yield</span></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cropPositive <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropPositive <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropSubstring <span class="op">=</span> <span class="vs">`**</span><span class="sc">${</span>cropPositive<span class="sc">}</span><span class="vs">** </span><span class="sc">${</span></span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a>    cropPositive <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a>  <span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightCropPositive <span class="op">=</span> langCropPositive<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a>    Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(<span class="st">"cropPositiveText"</span>)<span class="op">,</span></span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a>    langCropSubstring</span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a>  <span class="co">// top for selected crop</span></span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> n <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// # top crops to include</span></span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> topCrop <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(n<span class="op">,</span> <span class="st">"Mean_Difference"</span>)<span class="op">,</span></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(T<span class="op">.</span><span class="fu">desc</span>(<span class="st">"Mean_Difference"</span>))</span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff1 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff2 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffFirst</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst_incDec <span class="op">=</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a>    diff1<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)<span class="op">;</span></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst_observations <span class="op">=</span> diff1<span class="op">.</span><span class="at">N_Obs</span><span class="op">;</span></span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirstItems <span class="op">=</span> [</span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_prac</span>(diff1<span class="op">.</span><span class="at">Practice</span>) }<span class="op">,</span></span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"incDec"</span><span class="op">,</span></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a>        diff1<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)</span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"meanDiff"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff1<span class="op">.</span><span class="at">Mean_Difference</span>) }<span class="op">,</span></span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationCount"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(diff1<span class="op">.</span><span class="at">N_Obs</span>) }<span class="op">,</span></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a>        diff1<span class="op">.</span><span class="at">N_Obs</span> <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffFirst <span class="op">=</span> langDiffFirstItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langDiffFirst)<span class="op">;</span></span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffSecond</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond_incDec <span class="op">=</span></span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a>    diff2<span class="op">?.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)<span class="op">;</span></span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond_observations <span class="op">=</span> diff2<span class="op">?.</span><span class="at">N_Obs</span><span class="op">;</span></span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecondItems <span class="op">=</span> [</span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_prac</span>(diff2<span class="op">?.</span><span class="at">Practice</span>) }<span class="op">,</span></span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"incDec"</span><span class="op">,</span></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a>        diff2<span class="op">?.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)</span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"meanDiff"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff2<span class="op">?.</span><span class="at">Mean_Difference</span>) }<span class="op">,</span></span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationCount"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(diff2<span class="op">?.</span><span class="at">N_Obs</span>) }<span class="op">,</span></span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a>        diff2<span class="op">?.</span><span class="at">N_Obs</span> <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffSecond <span class="op">=</span> diff2</span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> langDiffSecondItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a>          Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a>          item<span class="op">.</span><span class="at">value</span></span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> langDiffSecond)</span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>insightTop5<span class="sc">}</span></span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insightCropOverview<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>insightCropPositive<span class="sc">}</span></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insightDiffFirst<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>insightDiffSecond<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-515"><a href="#cb6-515" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-6" data-nodetype="expression"></div></div></div></section></section><section id="cropDiffAEZ" class="level2"><h2 data-anchor-id="cropDiffAEZ"><span><span id="ojs-element-id-9"></span></span></h2><p><span><span id="ojs-element-id-10"></span></span></p><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb7" data-startfrom="524" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 523"><span id="cb7-524"><a href="#cb7-524" aria-hidden="true" tabindex="-1"></a>viewof selectCropMeanDiffAEZ <span class="op">=</span> {</span>
<span id="cb7-525"><a href="#cb7-525" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb7-526"><a href="#cb7-526" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(data_meanDiff_aezPracticeCrop_new<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span>))</span>
<span id="cb7-527"><a href="#cb7-527" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb7-528"><a href="#cb7-528" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb7-529"><a href="#cb7-529" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">Crop</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d] }<span class="op">;</span></span>
<span id="cb7-530"><a href="#cb7-530" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb7-531"><a href="#cb7-531" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(a<span class="op">.</span><span class="at">translation</span>) <span class="op">&gt;</span> <span class="fu">_lang</span>(b<span class="op">.</span><span class="at">translation</span>))<span class="op">;</span></span>
<span id="cb7-532"><a href="#cb7-532" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(data<span class="op">,</span> {</span>
<span id="cb7-533"><a href="#cb7-533" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop</span>)<span class="op">,</span></span>
<span id="cb7-534"><a href="#cb7-534" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="st">"Maize"</span>)<span class="op">,</span></span>
<span id="cb7-535"><a href="#cb7-535" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (x) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)</span>
<span id="cb7-536"><a href="#cb7-536" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-537"><a href="#cb7-537" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-538"><a href="#cb7-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-539"><a href="#cb7-539" aria-hidden="true" tabindex="-1"></a>viewof radioSortDotPlotCropAEZ_new <span class="op">=</span> {</span>
<span id="cb7-540"><a href="#cb7-540" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb7-541"><a href="#cb7-541" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb7-542"><a href="#cb7-542" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span></span>
<span id="cb7-543"><a href="#cb7-543" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">mean</span>)<span class="op">,</span></span>
<span id="cb7-544"><a href="#cb7-544" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb7-545"><a href="#cb7-545" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb7-546"><a href="#cb7-546" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb7-547"><a href="#cb7-547" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb7-548"><a href="#cb7-548" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb7-549"><a href="#cb7-549" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">observations</span>)<span class="op">,</span></span>
<span id="cb7-550"><a href="#cb7-550" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"nObs"</span><span class="op">,</span></span>
<span id="cb7-551"><a href="#cb7-551" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb7-552"><a href="#cb7-552" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb7-553"><a href="#cb7-553" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb7-554"><a href="#cb7-554" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"alpha"</span><span class="op">,</span></span>
<span id="cb7-555"><a href="#cb7-555" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">alpha</span>)<span class="op">,</span></span>
<span id="cb7-556"><a href="#cb7-556" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb7-557"><a href="#cb7-557" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb7-558"><a href="#cb7-558" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-559"><a href="#cb7-559" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb7-560"><a href="#cb7-560" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(data<span class="op">,</span> {</span>
<span id="cb7-561"><a href="#cb7-561" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">sort</span>)<span class="op">,</span></span>
<span id="cb7-562"><a href="#cb7-562" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span><span class="op">,</span></span>
<span id="cb7-563"><a href="#cb7-563" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">"mean"</span>)</span>
<span id="cb7-564"><a href="#cb7-564" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-565"><a href="#cb7-565" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-566"><a href="#cb7-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-567"><a href="#cb7-567" aria-hidden="true" tabindex="-1"></a>viewof aezSelect_new <span class="op">=</span> {</span>
<span id="cb7-568"><a href="#cb7-568" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> data_meanDiff_aezPracticeCrop_new<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb7-569"><a href="#cb7-569" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span> <span class="op">===</span> selectCropMeanDiffAEZ<span class="op">.</span><span class="at">field</span></span>
<span id="cb7-570"><a href="#cb7-570" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb7-571"><a href="#cb7-571" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezNames <span class="op">=</span> d3</span>
<span id="cb7-572"><a href="#cb7-572" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">groups</span>(data<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">AEZ_Class_FAO</span>)</span>
<span id="cb7-573"><a href="#cb7-573" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[<span class="dv">0</span>])</span>
<span id="cb7-574"><a href="#cb7-574" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>()<span class="op">;</span></span>
<span id="cb7-575"><a href="#cb7-575" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> aezNames<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> ({</span>
<span id="cb7-576"><a href="#cb7-576" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span></span>
<span id="cb7-577"><a href="#cb7-577" aria-hidden="true" tabindex="-1"></a>    <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">AEZ_Class_FAO</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d]</span>
<span id="cb7-578"><a href="#cb7-578" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb7-579"><a href="#cb7-579" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nullValue <span class="op">=</span> {</span>
<span id="cb7-580"><a href="#cb7-580" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb7-581"><a href="#cb7-581" aria-hidden="true" tabindex="-1"></a>    <span class="dt">translation</span><span class="op">:</span> nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">defaults</span><span class="op">.</span><span class="at">aez</span></span>
<span id="cb7-582"><a href="#cb7-582" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb7-583"><a href="#cb7-583" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> inputNames <span class="op">=</span> [nullValue<span class="op">,</span> <span class="op">...</span>options]<span class="op">;</span></span>
<span id="cb7-584"><a href="#cb7-584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(inputNames<span class="op">,</span> {</span>
<span id="cb7-585"><a href="#cb7-585" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">highlightAez</span>)<span class="op">,</span></span>
<span id="cb7-586"><a href="#cb7-586" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> aezNames<span class="op">,</span></span>
<span id="cb7-587"><a href="#cb7-587" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)</span>
<span id="cb7-588"><a href="#cb7-588" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-589"><a href="#cb7-589" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-590"><a href="#cb7-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-591"><a href="#cb7-591" aria-hidden="true" tabindex="-1"></a>viewof toggleCIsCropAEZ_new <span class="op">=</span> {</span>
<span id="cb7-592"><a href="#cb7-592" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb7-593"><a href="#cb7-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">toggleConfInt</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">visible</span>)</span>
<span id="cb7-594"><a href="#cb7-594" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb7-595"><a href="#cb7-595" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(data<span class="op">,</span> {</span>
<span id="cb7-596"><a href="#cb7-596" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">confidenceIntervals</span>)</span>
<span id="cb7-597"><a href="#cb7-597" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-598"><a href="#cb7-598" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-7-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-7-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-7-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-7-4" data-nodetype="declaration"></div></div></div></div><div class="cell"><details class="code-fold"><summary>View table code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8" data-startfrom="606" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 605"><span id="cb8-606"><a href="#cb8-606" aria-hidden="true" tabindex="-1"></a>plotDotAEZ_new <span class="op">=</span> {</span>
<span id="cb8-607"><a href="#cb8-607" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseData <span class="op">=</span> data_meanDiff_aezPracticeCrop_new<span class="op">;</span></span>
<span id="cb8-608"><a href="#cb8-608" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plotData <span class="op">=</span> baseData<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb8-609"><a href="#cb8-609" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span> <span class="op">===</span> selectCropMeanDiffAEZ<span class="op">.</span><span class="at">field</span></span>
<span id="cb8-610"><a href="#cb8-610" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb8-611"><a href="#cb8-611" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezData <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb8-612"><a href="#cb8-612" aria-hidden="true" tabindex="-1"></a>    plotData<span class="op">,</span></span>
<span id="cb8-613"><a href="#cb8-613" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb8-614"><a href="#cb8-614" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (aezSelect_new<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb8-615"><a href="#cb8-615" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> d<span class="op">.</span><span class="at">AEZ_Class_FAO</span> <span class="op">==</span> aezSelect_new<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb8-616"><a href="#cb8-616" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb8-617"><a href="#cb8-617" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(<span class="st">"Mean_Difference"</span>)</span>
<span id="cb8-618"><a href="#cb8-618" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb8-619"><a href="#cb8-619" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorDomain <span class="op">=</span> aezColor_new<span class="op">.</span><span class="at">domain</span><span class="op">;</span></span>
<span id="cb8-620"><a href="#cb8-620" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorRange <span class="op">=</span> aezColor_new<span class="op">.</span><span class="at">range</span><span class="op">;</span></span>
<span id="cb8-621"><a href="#cb8-621" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginBottom <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-622"><a href="#cb8-622" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginTop <span class="op">=</span> <span class="dv">80</span><span class="op">;</span></span>
<span id="cb8-623"><a href="#cb8-623" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yHeight <span class="op">=</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb8-624"><a href="#cb8-624" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span></span>
<span id="cb8-625"><a href="#cb8-625" aria-hidden="true" tabindex="-1"></a>    marginTop <span class="op">+</span></span>
<span id="cb8-626"><a href="#cb8-626" aria-hidden="true" tabindex="-1"></a>    marginBottom <span class="op">+</span></span>
<span id="cb8-627"><a href="#cb8-627" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">group</span>(plotData<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Practice</span>)<span class="op">.</span><span class="at">size</span> <span class="op">*</span> yHeight<span class="op">;</span></span>
<span id="cb8-628"><a href="#cb8-628" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _formatNum <span class="op">=</span> formatNum<span class="op">;</span></span>
<span id="cb8-629"><a href="#cb8-629" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _toggleCIs <span class="op">=</span> toggleCIsCropAEZ_new<span class="op">;</span></span>
<span id="cb8-630"><a href="#cb8-630" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _radioSort <span class="op">=</span> radioSortDotPlotCropAEZ_new<span class="op">;</span></span>
<span id="cb8-631"><a href="#cb8-631" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langLookup <span class="op">=</span> {</span>
<span id="cb8-632"><a href="#cb8-632" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xLabel</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">xMeanDiff</span>)<span class="op">,</span></span>
<span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a>      <span class="dt">aez</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">aez</span>)<span class="op">,</span></span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a>      <span class="dt">meanDiff</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">meanDiff</span>)<span class="op">,</span></span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a>      <span class="dt">meanControl</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">meanControl</span>)<span class="op">,</span></span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a>      <span class="dt">crop</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">crop</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ciLo</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">ciLower</span>)<span class="op">,</span></span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ciHi</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">tooltips</span><span class="op">.</span><span class="at">ciUpper</span>)<span class="op">,</span></span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a>      <span class="dt">obs</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">AEZ_Class_FAO</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a>    height<span class="op">,</span></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a>    marginBottom<span class="op">,</span></span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a>    marginTop<span class="op">,</span></span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb8-658"><a href="#cb8-658" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">70</span><span class="op">,</span></span>
<span id="cb8-659"><a href="#cb8-659" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb8-660"><a href="#cb8-660" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb8-661"><a href="#cb8-661" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb8-662"><a href="#cb8-662" aria-hidden="true" tabindex="-1"></a>      <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb8-663"><a href="#cb8-663" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb8-664"><a href="#cb8-664" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">xLabel</span><span class="op">,</span></span>
<span id="cb8-665"><a href="#cb8-665" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"center"</span><span class="op">,</span></span>
<span id="cb8-666"><a href="#cb8-666" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb8-667"><a href="#cb8-667" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelArrow</span><span class="op">:</span> <span class="st">"none"</span></span>
<span id="cb8-668"><a href="#cb8-668" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb8-669"><a href="#cb8-669" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb8-670"><a href="#cb8-670" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb8-671"><a href="#cb8-671" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb8-672"><a href="#cb8-672" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb8-673"><a href="#cb8-673" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb8-674"><a href="#cb8-674" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> colorDomain<span class="op">,</span></span>
<span id="cb8-675"><a href="#cb8-675" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> colorRange</span>
<span id="cb8-676"><a href="#cb8-676" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb8-677"><a href="#cb8-677" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb8-678"><a href="#cb8-678" aria-hidden="true" tabindex="-1"></a>      <span class="co">// main y-axis</span></span>
<span id="cb8-679"><a href="#cb8-679" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({</span>
<span id="cb8-680"><a href="#cb8-680" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb8-681"><a href="#cb8-681" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb8-682"><a href="#cb8-682" aria-hidden="true" tabindex="-1"></a>      <span class="co">// pointer white-out</span></span>
<span id="cb8-683"><a href="#cb8-683" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb8-684"><a href="#cb8-684" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb8-685"><a href="#cb8-685" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb8-686"><a href="#cb8-686" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb8-687"><a href="#cb8-687" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStrokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb8-688"><a href="#cb8-688" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb8-689"><a href="#cb8-689" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb8-690"><a href="#cb8-690" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-691"><a href="#cb8-691" aria-hidden="true" tabindex="-1"></a>      <span class="co">// bold pointer</span></span>
<span id="cb8-692"><a href="#cb8-692" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb8-693"><a href="#cb8-693" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb8-694"><a href="#cb8-694" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb8-695"><a href="#cb8-695" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb8-696"><a href="#cb8-696" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb8-697"><a href="#cb8-697" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-698"><a href="#cb8-698" aria-hidden="true" tabindex="-1"></a>      <span class="co">// zero point</span></span>
<span id="cb8-699"><a href="#cb8-699" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>]<span class="op">,</span> { <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> [<span class="dv">4</span>] })<span class="op">,</span></span>
<span id="cb8-700"><a href="#cb8-700" aria-hidden="true" tabindex="-1"></a>      <span class="co">// base dots</span></span>
<span id="cb8-701"><a href="#cb8-701" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(plotData<span class="op">,</span> {</span>
<span id="cb8-702"><a href="#cb8-702" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"Mean_Difference"</span><span class="op">,</span></span>
<span id="cb8-703"><a href="#cb8-703" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-704"><a href="#cb8-704" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sort</span><span class="op">:</span> { <span class="dt">y</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">channel</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">reverse</span> }<span class="op">,</span></span>
<span id="cb8-705"><a href="#cb8-705" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb8-706"><a href="#cb8-706" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb8-707"><a href="#cb8-707" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb8-708"><a href="#cb8-708" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#efefef"</span><span class="op">,</span></span>
<span id="cb8-709"><a href="#cb8-709" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb8-710"><a href="#cb8-710" aria-hidden="true" tabindex="-1"></a>          <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb8-711"><a href="#cb8-711" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"# Observations"</span><span class="op">,</span></span>
<span id="cb8-712"><a href="#cb8-712" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb8-713"><a href="#cb8-713" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb8-714"><a href="#cb8-714" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-715"><a href="#cb8-715" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb8-716"><a href="#cb8-716" aria-hidden="true" tabindex="-1"></a>      <span class="co">// selection: span lines: CI</span></span>
<span id="cb8-717"><a href="#cb8-717" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>(_toggleCIs<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> aezData <span class="op">:</span> []<span class="op">,</span> {</span>
<span id="cb8-718"><a href="#cb8-718" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-719"><a href="#cb8-719" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x1</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">Lower</span> <span class="op">==</span> <span class="st">"NA"</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> d<span class="op">.</span><span class="at">Lower</span>)<span class="op">,</span></span>
<span id="cb8-720"><a href="#cb8-720" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x2</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">Upper</span> <span class="op">==</span> <span class="st">"NA"</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> d<span class="op">.</span><span class="at">Upper</span>)<span class="op">,</span></span>
<span id="cb8-721"><a href="#cb8-721" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span></span>
<span id="cb8-722"><a href="#cb8-722" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb8-723"><a href="#cb8-723" aria-hidden="true" tabindex="-1"></a>      <span class="co">// selection: mean diff dots</span></span>
<span id="cb8-724"><a href="#cb8-724" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(aezData<span class="op">,</span> {</span>
<span id="cb8-725"><a href="#cb8-725" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"Mean_Difference"</span><span class="op">,</span></span>
<span id="cb8-726"><a href="#cb8-726" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-727"><a href="#cb8-727" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb8-728"><a href="#cb8-728" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">AEZ_Class_FAO</span>)<span class="op">;</span></span>
<span id="cb8-729"><a href="#cb8-729" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb8-730"><a href="#cb8-730" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb8-731"><a href="#cb8-731" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb8-732"><a href="#cb8-732" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb8-733"><a href="#cb8-733" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb8-734"><a href="#cb8-734" aria-hidden="true" tabindex="-1"></a>          <span class="dt">aez</span><span class="op">:</span> {</span>
<span id="cb8-735"><a href="#cb8-735" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">aez</span><span class="op">,</span></span>
<span id="cb8-736"><a href="#cb8-736" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">AEZ_Class_FAO</span>)</span>
<span id="cb8-737"><a href="#cb8-737" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-738"><a href="#cb8-738" aria-hidden="true" tabindex="-1"></a>          <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb8-739"><a href="#cb8-739" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">obs</span><span class="op">,</span></span>
<span id="cb8-740"><a href="#cb8-740" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb8-741"><a href="#cb8-741" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-742"><a href="#cb8-742" aria-hidden="true" tabindex="-1"></a>          <span class="dt">diff</span><span class="op">:</span> {</span>
<span id="cb8-743"><a href="#cb8-743" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">meanDiff</span><span class="op">,</span></span>
<span id="cb8-744"><a href="#cb8-744" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Mean_Difference"</span></span>
<span id="cb8-745"><a href="#cb8-745" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-746"><a href="#cb8-746" aria-hidden="true" tabindex="-1"></a>          <span class="dt">control</span><span class="op">:</span> {</span>
<span id="cb8-747"><a href="#cb8-747" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">meanControl</span><span class="op">,</span></span>
<span id="cb8-748"><a href="#cb8-748" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Mean_Control"</span></span>
<span id="cb8-749"><a href="#cb8-749" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-750"><a href="#cb8-750" aria-hidden="true" tabindex="-1"></a>          <span class="dt">prac</span><span class="op">:</span> {</span>
<span id="cb8-751"><a href="#cb8-751" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">practice</span><span class="op">,</span></span>
<span id="cb8-752"><a href="#cb8-752" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)</span>
<span id="cb8-753"><a href="#cb8-753" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-754"><a href="#cb8-754" aria-hidden="true" tabindex="-1"></a>          <span class="dt">crop</span><span class="op">:</span> {</span>
<span id="cb8-755"><a href="#cb8-755" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">crop</span><span class="op">,</span></span>
<span id="cb8-756"><a href="#cb8-756" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Crop"</span></span>
<span id="cb8-757"><a href="#cb8-757" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-758"><a href="#cb8-758" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciLow</span><span class="op">:</span> {</span>
<span id="cb8-759"><a href="#cb8-759" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">ciLo</span><span class="op">,</span></span>
<span id="cb8-760"><a href="#cb8-760" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Lower"</span></span>
<span id="cb8-761"><a href="#cb8-761" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-762"><a href="#cb8-762" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciHigh</span><span class="op">:</span> {</span>
<span id="cb8-763"><a href="#cb8-763" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> langLookup<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">ciHi</span><span class="op">,</span></span>
<span id="cb8-764"><a href="#cb8-764" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Upper"</span></span>
<span id="cb8-765"><a href="#cb8-765" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb8-766"><a href="#cb8-766" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb8-767"><a href="#cb8-767" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tip</span><span class="op">:</span> {</span>
<span id="cb8-768"><a href="#cb8-768" aria-hidden="true" tabindex="-1"></a>          <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb8-769"><a href="#cb8-769" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-770"><a href="#cb8-770" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-771"><a href="#cb8-771" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-772"><a href="#cb8-772" aria-hidden="true" tabindex="-1"></a>            <span class="dt">prac</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-773"><a href="#cb8-773" aria-hidden="true" tabindex="-1"></a>            <span class="dt">crop</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-774"><a href="#cb8-774" aria-hidden="true" tabindex="-1"></a>            <span class="dt">aez</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb8-775"><a href="#cb8-775" aria-hidden="true" tabindex="-1"></a>            <span class="dt">diff</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb8-776"><a href="#cb8-776" aria-hidden="true" tabindex="-1"></a>            <span class="dt">control</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb8-777"><a href="#cb8-777" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciLow</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb8-778"><a href="#cb8-778" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciHigh</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb8-779"><a href="#cb8-779" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nObs</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb8-780"><a href="#cb8-780" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb8-781"><a href="#cb8-781" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-782"><a href="#cb8-782" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb8-783"><a href="#cb8-783" aria-hidden="true" tabindex="-1"></a>      <span class="co">// dot highlight on hover</span></span>
<span id="cb8-784"><a href="#cb8-784" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb8-785"><a href="#cb8-785" aria-hidden="true" tabindex="-1"></a>        aezData<span class="op">,</span></span>
<span id="cb8-786"><a href="#cb8-786" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointer</span>({</span>
<span id="cb8-787"><a href="#cb8-787" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> <span class="st">"Mean_Difference"</span><span class="op">,</span></span>
<span id="cb8-788"><a href="#cb8-788" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-789"><a href="#cb8-789" aria-hidden="true" tabindex="-1"></a>          <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb8-790"><a href="#cb8-790" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb8-791"><a href="#cb8-791" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> d<span class="op">.</span><span class="at">AEZ_Class_FAO</span><span class="op">;</span></span>
<span id="cb8-792"><a href="#cb8-792" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb8-793"><a href="#cb8-793" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span></span>
<span id="cb8-794"><a href="#cb8-794" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb8-795"><a href="#cb8-795" aria-hidden="true" tabindex="-1"></a>          <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb8-796"><a href="#cb8-796" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb8-797"><a href="#cb8-797" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="st">"# Observations"</span><span class="op">,</span></span>
<span id="cb8-798"><a href="#cb8-798" aria-hidden="true" tabindex="-1"></a>              <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb8-799"><a href="#cb8-799" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb8-800"><a href="#cb8-800" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb8-801"><a href="#cb8-801" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb8-802"><a href="#cb8-802" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-803"><a href="#cb8-803" aria-hidden="true" tabindex="-1"></a>      <span class="co">// observation counts</span></span>
<span id="cb8-804"><a href="#cb8-804" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb8-805"><a href="#cb8-805" aria-hidden="true" tabindex="-1"></a>        aezData<span class="op">,</span></span>
<span id="cb8-806"><a href="#cb8-806" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb8-807"><a href="#cb8-807" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="st">" obs."</span>) }<span class="op">,</span></span>
<span id="cb8-808"><a href="#cb8-808" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb8-809"><a href="#cb8-809" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb8-810"><a href="#cb8-810" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb8-811"><a href="#cb8-811" aria-hidden="true" tabindex="-1"></a>              <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-812"><a href="#cb8-812" aria-hidden="true" tabindex="-1"></a>              <span class="dt">text</span><span class="op">:</span> <span class="st">"N_Obs"</span><span class="op">,</span></span>
<span id="cb8-813"><a href="#cb8-813" aria-hidden="true" tabindex="-1"></a>              <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb8-814"><a href="#cb8-814" aria-hidden="true" tabindex="-1"></a>              <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb8-815"><a href="#cb8-815" aria-hidden="true" tabindex="-1"></a>              <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span></span>
<span id="cb8-816"><a href="#cb8-816" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb8-817"><a href="#cb8-817" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb8-818"><a href="#cb8-818" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-819"><a href="#cb8-819" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-820"><a href="#cb8-820" aria-hidden="true" tabindex="-1"></a>      <span class="co">// digital white-out</span></span>
<span id="cb8-821"><a href="#cb8-821" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb8-822"><a href="#cb8-822" aria-hidden="true" tabindex="-1"></a>        aezData<span class="op">,</span></span>
<span id="cb8-823"><a href="#cb8-823" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>(</span>
<span id="cb8-824"><a href="#cb8-824" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb8-825"><a href="#cb8-825" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="st">" obs."</span>) }<span class="op">,</span></span>
<span id="cb8-826"><a href="#cb8-826" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb8-827"><a href="#cb8-827" aria-hidden="true" tabindex="-1"></a>              { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb8-828"><a href="#cb8-828" aria-hidden="true" tabindex="-1"></a>              {</span>
<span id="cb8-829"><a href="#cb8-829" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-830"><a href="#cb8-830" aria-hidden="true" tabindex="-1"></a>                <span class="dt">text</span><span class="op">:</span> <span class="st">"N_Obs"</span><span class="op">,</span></span>
<span id="cb8-831"><a href="#cb8-831" aria-hidden="true" tabindex="-1"></a>                <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb8-832"><a href="#cb8-832" aria-hidden="true" tabindex="-1"></a>                <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb8-833"><a href="#cb8-833" aria-hidden="true" tabindex="-1"></a>                <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb8-834"><a href="#cb8-834" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb8-835"><a href="#cb8-835" aria-hidden="true" tabindex="-1"></a>                <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb8-836"><a href="#cb8-836" aria-hidden="true" tabindex="-1"></a>                <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb8-837"><a href="#cb8-837" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb8-838"><a href="#cb8-838" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-839"><a href="#cb8-839" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb8-840"><a href="#cb8-840" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-841"><a href="#cb8-841" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb8-842"><a href="#cb8-842" aria-hidden="true" tabindex="-1"></a>      <span class="co">// observation counts bold hover</span></span>
<span id="cb8-843"><a href="#cb8-843" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb8-844"><a href="#cb8-844" aria-hidden="true" tabindex="-1"></a>        aezData<span class="op">,</span></span>
<span id="cb8-845"><a href="#cb8-845" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>(</span>
<span id="cb8-846"><a href="#cb8-846" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb8-847"><a href="#cb8-847" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="st">" obs."</span>) }<span class="op">,</span></span>
<span id="cb8-848"><a href="#cb8-848" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb8-849"><a href="#cb8-849" aria-hidden="true" tabindex="-1"></a>              { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb8-850"><a href="#cb8-850" aria-hidden="true" tabindex="-1"></a>              {</span>
<span id="cb8-851"><a href="#cb8-851" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb8-852"><a href="#cb8-852" aria-hidden="true" tabindex="-1"></a>                <span class="dt">text</span><span class="op">:</span> <span class="st">"N_Obs"</span><span class="op">,</span></span>
<span id="cb8-853"><a href="#cb8-853" aria-hidden="true" tabindex="-1"></a>                <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb8-854"><a href="#cb8-854" aria-hidden="true" tabindex="-1"></a>                <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb8-855"><a href="#cb8-855" aria-hidden="true" tabindex="-1"></a>                <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb8-856"><a href="#cb8-856" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span></span>
<span id="cb8-857"><a href="#cb8-857" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb8-858"><a href="#cb8-858" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-859"><a href="#cb8-859" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb8-860"><a href="#cb8-860" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-861"><a href="#cb8-861" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-862"><a href="#cb8-862" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-863"><a href="#cb8-863" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb8-864"><a href="#cb8-864" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-865"><a href="#cb8-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-866"><a href="#cb8-866" aria-hidden="true" tabindex="-1"></a>plotDotAEZ_new<span class="op">.</span><span class="fu">legend</span>(<span class="st">'color'</span><span class="op">,</span> {<span class="dt">columns</span><span class="op">:</span> <span class="dv">3</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-8-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-8-2" data-nodetype="expression"></div></div></div></div><section id="quickinsight-1" class="level3"><h3 data-anchor-id="quickinsight-1"><span><span id="ojs-element-id-11"></span></span></h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb9" data-startfrom="871" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 870"><span id="cb9-871"><a href="#cb9-871" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-872"><a href="#cb9-872" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langRoot <span class="op">=</span> nbText<span class="op">;</span></span>
<span id="cb9-873"><a href="#cb9-873" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBasePath <span class="op">=</span> langRoot<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">insights</span><span class="op">;</span> <span class="co">// base path for language</span></span>
<span id="cb9-874"><a href="#cb9-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-875"><a href="#cb9-875" aria-hidden="true" tabindex="-1"></a>  <span class="co">// top practice by aez</span></span>
<span id="cb9-876"><a href="#cb9-876" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedCrop <span class="op">=</span> selectCropMeanDiffAEZ<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb9-877"><a href="#cb9-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-878"><a href="#cb9-878" aria-hidden="true" tabindex="-1"></a>  <span class="co">// crop selection</span></span>
<span id="cb9-879"><a href="#cb9-879" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCropNoAEZ <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-880"><a href="#cb9-880" aria-hidden="true" tabindex="-1"></a>    data_meanDiff_aezPracticeCrop_new<span class="op">,</span></span>
<span id="cb9-881"><a href="#cb9-881" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span> <span class="op">===</span> selectedCrop)</span>
<span id="cb9-882"><a href="#cb9-882" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-883"><a href="#cb9-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-884"><a href="#cb9-884" aria-hidden="true" tabindex="-1"></a>  <span class="co">// find aez with the largest mean diff</span></span>
<span id="cb9-885"><a href="#cb9-885" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxMeanDiff <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-886"><a href="#cb9-886" aria-hidden="true" tabindex="-1"></a>    dataCropNoAEZ<span class="op">,</span></span>
<span id="cb9-887"><a href="#cb9-887" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">"Mean_Difference"</span>)</span>
<span id="cb9-888"><a href="#cb9-888" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb9-889"><a href="#cb9-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-890"><a href="#cb9-890" aria-hidden="true" tabindex="-1"></a>  <span class="co">// use aez with max value for no highlight</span></span>
<span id="cb9-891"><a href="#cb9-891" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedAEZ <span class="op">=</span></span>
<span id="cb9-892"><a href="#cb9-892" aria-hidden="true" tabindex="-1"></a>    aezSelect_new<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> maxMeanDiff<span class="op">.</span><span class="at">AEZ_Class_FAO</span> <span class="op">:</span> aezSelect_new<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb9-893"><a href="#cb9-893" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedAEZTranslated <span class="op">=</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">AEZ_Class_FAO</span><span class="op">.</span><span class="at">values</span>[selectedAEZ])<span class="op">;</span></span>
<span id="cb9-894"><a href="#cb9-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-895"><a href="#cb9-895" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCrop <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-896"><a href="#cb9-896" aria-hidden="true" tabindex="-1"></a>    dataCropNoAEZ<span class="op">,</span></span>
<span id="cb9-897"><a href="#cb9-897" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">AEZ_Class_FAO</span> <span class="op">==</span> selectedAEZ)</span>
<span id="cb9-898"><a href="#cb9-898" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-899"><a href="#cb9-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-900"><a href="#cb9-900" aria-hidden="true" tabindex="-1"></a>  <span class="co">// selected aez square</span></span>
<span id="cb9-901"><a href="#cb9-901" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezSwatchColor <span class="op">=</span></span>
<span id="cb9-902"><a href="#cb9-902" aria-hidden="true" tabindex="-1"></a>    aezColor_new<span class="op">.</span><span class="at">range</span>[aezColor_new<span class="op">.</span><span class="at">domain</span><span class="op">.</span><span class="fu">indexOf</span>(selectedAEZTranslated)]<span class="op">;</span></span>
<span id="cb9-903"><a href="#cb9-903" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> squareSize <span class="op">=</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb9-904"><a href="#cb9-904" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezSquare <span class="op">=</span> <span class="vs">`&lt;svg width="</span><span class="sc">${</span>squareSize<span class="sc">}</span><span class="vs">" height="</span><span class="sc">${</span>squareSize<span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb9-905"><a href="#cb9-905" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;rect width="</span><span class="sc">${</span>squareSize<span class="sc">}</span><span class="vs">" height="</span><span class="sc">${</span>squareSize<span class="sc">}</span><span class="vs">" fill=</span><span class="sc">${</span>aezSwatchColor<span class="sc">}</span><span class="vs">  /&gt;</span></span>
<span id="cb9-906"><a href="#cb9-906" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/svg&gt;`</span><span class="op">;</span></span>
<span id="cb9-907"><a href="#cb9-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-908"><a href="#cb9-908" aria-hidden="true" tabindex="-1"></a>  <span class="co">// crop overview</span></span>
<span id="cb9-909"><a href="#cb9-909" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cropOverview <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-910"><a href="#cb9-910" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb9-911"><a href="#cb9-911" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">summarize</span>({</span>
<span id="cb9-912"><a href="#cb9-912" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalObs</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"N_Obs"</span>)<span class="op">,</span></span>
<span id="cb9-913"><a href="#cb9-913" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalPractices</span><span class="op">:</span> T<span class="op">.</span><span class="fu">n</span>()</span>
<span id="cb9-914"><a href="#cb9-914" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb9-915"><a href="#cb9-915" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb9-916"><a href="#cb9-916" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropOverview <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb9-917"><a href="#cb9-917" aria-hidden="true" tabindex="-1"></a>    langBasePath<span class="op">.</span><span class="at">cropOverview</span><span class="op">.</span><span class="at">main</span></span>
<span id="cb9-918"><a href="#cb9-918" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-919"><a href="#cb9-919" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropOverviewItems <span class="op">=</span> [</span>
<span id="cb9-920"><a href="#cb9-920" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"selectedCrop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop_with_articles</span><span class="op">.</span><span class="at">values</span>[selectedCrop]) }<span class="op">,</span></span>
<span id="cb9-921"><a href="#cb9-921" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"selectedAEZSquare"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> aezSquare }<span class="op">,</span></span>
<span id="cb9-922"><a href="#cb9-922" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"selectedAEZ"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selectedAEZTranslated }<span class="op">,</span></span>
<span id="cb9-923"><a href="#cb9-923" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(cropOverview<span class="op">.</span><span class="at">totalObs</span>) }<span class="op">,</span></span>
<span id="cb9-924"><a href="#cb9-924" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-925"><a href="#cb9-925" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObsString"</span><span class="op">,</span></span>
<span id="cb9-926"><a href="#cb9-926" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-927"><a href="#cb9-927" aria-hidden="true" tabindex="-1"></a>        cropOverview<span class="op">.</span><span class="at">totalObs</span> <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb9-928"><a href="#cb9-928" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb9-929"><a href="#cb9-929" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb9-930"><a href="#cb9-930" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-931"><a href="#cb9-931" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalPractices"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> cropOverview<span class="op">.</span><span class="at">totalPractices</span> }<span class="op">,</span></span>
<span id="cb9-932"><a href="#cb9-932" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-933"><a href="#cb9-933" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalPracticesString"</span><span class="op">,</span></span>
<span id="cb9-934"><a href="#cb9-934" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-935"><a href="#cb9-935" aria-hidden="true" tabindex="-1"></a>        cropOverview<span class="op">.</span><span class="at">totalPractices</span> <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb9-936"><a href="#cb9-936" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb9-937"><a href="#cb9-937" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb9-938"><a href="#cb9-938" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-939"><a href="#cb9-939" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb9-940"><a href="#cb9-940" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightCropOverview <span class="op">=</span> langCropOverviewItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb9-941"><a href="#cb9-941" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb9-942"><a href="#cb9-942" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb9-943"><a href="#cb9-943" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb9-944"><a href="#cb9-944" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb9-945"><a href="#cb9-945" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langCropOverview)<span class="op">;</span></span>
<span id="cb9-946"><a href="#cb9-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-947"><a href="#cb9-947" aria-hidden="true" tabindex="-1"></a>  <span class="co">// positive yield</span></span>
<span id="cb9-948"><a href="#cb9-948" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cropPositive <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-949"><a href="#cb9-949" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb9-950"><a href="#cb9-950" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb9-951"><a href="#cb9-951" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb9-952"><a href="#cb9-952" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropPositive <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb9-953"><a href="#cb9-953" aria-hidden="true" tabindex="-1"></a>    nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">insights</span><span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">main</span></span>
<span id="cb9-954"><a href="#cb9-954" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-955"><a href="#cb9-955" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langCropSubstring <span class="op">=</span> <span class="vs">`**</span><span class="sc">${</span>cropPositive<span class="sc">}</span><span class="vs">** </span><span class="sc">${</span></span>
<span id="cb9-956"><a href="#cb9-956" aria-hidden="true" tabindex="-1"></a>    cropPositive <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb9-957"><a href="#cb9-957" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(</span>
<span id="cb9-958"><a href="#cb9-958" aria-hidden="true" tabindex="-1"></a>          nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">insights</span><span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">singular</span></span>
<span id="cb9-959"><a href="#cb9-959" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-960"><a href="#cb9-960" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(</span>
<span id="cb9-961"><a href="#cb9-961" aria-hidden="true" tabindex="-1"></a>          nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">insights</span><span class="op">.</span><span class="at">cropPositive</span><span class="op">.</span><span class="at">plural</span></span>
<span id="cb9-962"><a href="#cb9-962" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-963"><a href="#cb9-963" aria-hidden="true" tabindex="-1"></a>  <span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb9-964"><a href="#cb9-964" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightCropPositive <span class="op">=</span> langCropPositive<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb9-965"><a href="#cb9-965" aria-hidden="true" tabindex="-1"></a>    Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(<span class="st">"cropPositiveText"</span>)<span class="op">,</span></span>
<span id="cb9-966"><a href="#cb9-966" aria-hidden="true" tabindex="-1"></a>    langCropSubstring</span>
<span id="cb9-967"><a href="#cb9-967" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-968"><a href="#cb9-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-969"><a href="#cb9-969" aria-hidden="true" tabindex="-1"></a>  <span class="co">// top for selected crop</span></span>
<span id="cb9-970"><a href="#cb9-970" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> n <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// # top crops to include</span></span>
<span id="cb9-971"><a href="#cb9-971" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> topCrop <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb9-972"><a href="#cb9-972" aria-hidden="true" tabindex="-1"></a>    dataCrop<span class="op">,</span></span>
<span id="cb9-973"><a href="#cb9-973" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(n<span class="op">,</span> <span class="st">"Mean_Difference"</span>)<span class="op">,</span></span>
<span id="cb9-974"><a href="#cb9-974" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(T<span class="op">.</span><span class="fu">desc</span>(<span class="st">"Mean_Difference"</span>))</span>
<span id="cb9-975"><a href="#cb9-975" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-976"><a href="#cb9-976" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff1 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb9-977"><a href="#cb9-977" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff2 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb9-978"><a href="#cb9-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-979"><a href="#cb9-979" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffFirst</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb9-980"><a href="#cb9-980" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst_incDec <span class="op">=</span></span>
<span id="cb9-981"><a href="#cb9-981" aria-hidden="true" tabindex="-1"></a>    diff1<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb9-982"><a href="#cb9-982" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb9-983"><a href="#cb9-983" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)<span class="op">;</span></span>
<span id="cb9-984"><a href="#cb9-984" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst_observations <span class="op">=</span> diff1<span class="op">.</span><span class="at">N_Obs</span><span class="op">;</span></span>
<span id="cb9-985"><a href="#cb9-985" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirstItems <span class="op">=</span> [</span>
<span id="cb9-986"><a href="#cb9-986" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[diff1<span class="op">.</span><span class="at">Practice</span>]) }<span class="op">,</span></span>
<span id="cb9-987"><a href="#cb9-987" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-988"><a href="#cb9-988" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"incDec"</span><span class="op">,</span></span>
<span id="cb9-989"><a href="#cb9-989" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-990"><a href="#cb9-990" aria-hidden="true" tabindex="-1"></a>        diff1<span class="op">.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb9-991"><a href="#cb9-991" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb9-992"><a href="#cb9-992" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)</span>
<span id="cb9-993"><a href="#cb9-993" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-994"><a href="#cb9-994" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"meanDiff"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff1<span class="op">.</span><span class="at">Mean_Difference</span>) }<span class="op">,</span></span>
<span id="cb9-995"><a href="#cb9-995" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-996"><a href="#cb9-996" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationCount"</span><span class="op">,</span></span>
<span id="cb9-997"><a href="#cb9-997" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(langDiffFirst_observations)</span>
<span id="cb9-998"><a href="#cb9-998" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-999"><a href="#cb9-999" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-1000"><a href="#cb9-1000" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb9-1001"><a href="#cb9-1001" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-1002"><a href="#cb9-1002" aria-hidden="true" tabindex="-1"></a>        langDiffFirst_observations <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb9-1003"><a href="#cb9-1003" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb9-1004"><a href="#cb9-1004" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb9-1005"><a href="#cb9-1005" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-1006"><a href="#cb9-1006" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb9-1007"><a href="#cb9-1007" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffFirst <span class="op">=</span> langDiffFirstItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb9-1008"><a href="#cb9-1008" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb9-1009"><a href="#cb9-1009" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb9-1010"><a href="#cb9-1010" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb9-1011"><a href="#cb9-1011" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb9-1012"><a href="#cb9-1012" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langDiffFirst)<span class="op">;</span></span>
<span id="cb9-1013"><a href="#cb9-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-1014"><a href="#cb9-1014" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffSecond</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb9-1015"><a href="#cb9-1015" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond_incDec <span class="op">=</span></span>
<span id="cb9-1016"><a href="#cb9-1016" aria-hidden="true" tabindex="-1"></a>    diff2<span class="op">?.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb9-1017"><a href="#cb9-1017" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb9-1018"><a href="#cb9-1018" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)<span class="op">;</span></span>
<span id="cb9-1019"><a href="#cb9-1019" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond_observations <span class="op">=</span> diff2<span class="op">?.</span><span class="at">N_Obs</span><span class="op">;</span></span>
<span id="cb9-1020"><a href="#cb9-1020" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecondItems <span class="op">=</span> [</span>
<span id="cb9-1021"><a href="#cb9-1021" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[diff2<span class="op">?.</span><span class="at">Practice</span>]) }<span class="op">,</span></span>
<span id="cb9-1022"><a href="#cb9-1022" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-1023"><a href="#cb9-1023" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"incDec"</span><span class="op">,</span></span>
<span id="cb9-1024"><a href="#cb9-1024" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-1025"><a href="#cb9-1025" aria-hidden="true" tabindex="-1"></a>        diff2<span class="op">?.</span><span class="at">Mean_Difference</span> <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb9-1026"><a href="#cb9-1026" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">increase</span>)</span>
<span id="cb9-1027"><a href="#cb9-1027" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">decrease</span>)</span>
<span id="cb9-1028"><a href="#cb9-1028" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-1029"><a href="#cb9-1029" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"meanDiff"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff2<span class="op">?.</span><span class="at">Mean_Difference</span>) }<span class="op">,</span></span>
<span id="cb9-1030"><a href="#cb9-1030" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-1031"><a href="#cb9-1031" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationCount"</span><span class="op">,</span></span>
<span id="cb9-1032"><a href="#cb9-1032" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(langDiffSecond_observations)</span>
<span id="cb9-1033"><a href="#cb9-1033" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb9-1034"><a href="#cb9-1034" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-1035"><a href="#cb9-1035" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb9-1036"><a href="#cb9-1036" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb9-1037"><a href="#cb9-1037" aria-hidden="true" tabindex="-1"></a>        langDiffSecond_observations <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb9-1038"><a href="#cb9-1038" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb9-1039"><a href="#cb9-1039" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb9-1040"><a href="#cb9-1040" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-1041"><a href="#cb9-1041" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb9-1042"><a href="#cb9-1042" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffSecond <span class="op">=</span> diff2</span>
<span id="cb9-1043"><a href="#cb9-1043" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> langDiffSecondItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb9-1044"><a href="#cb9-1044" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb9-1045"><a href="#cb9-1045" aria-hidden="true" tabindex="-1"></a>          Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb9-1046"><a href="#cb9-1046" aria-hidden="true" tabindex="-1"></a>          item<span class="op">.</span><span class="at">value</span></span>
<span id="cb9-1047"><a href="#cb9-1047" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb9-1048"><a href="#cb9-1048" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> langDiffSecond)</span>
<span id="cb9-1049"><a href="#cb9-1049" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb9-1050"><a href="#cb9-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-1051"><a href="#cb9-1051" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>insightCropOverview<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>insightCropPositive<span class="sc">}</span></span>
<span id="cb9-1052"><a href="#cb9-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-1053"><a href="#cb9-1053" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insightDiffFirst<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>insightDiffSecond <span class="op">??</span> <span class="st">""</span><span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb9-1054"><a href="#cb9-1054" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-9" data-nodetype="expression"></div></div></div></section></section></section><section id="risks" class="level1"><h1><span><span id="ojs-element-id-12"></span></span></h1><p><span><span id="ojs-element-id-13"></span></span></p><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb10" data-startfrom="1062" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1061"><span id="cb10-1062"><a href="#cb10-1062" aria-hidden="true" tabindex="-1"></a>viewof selectPractice <span class="op">=</span> {</span>
<span id="cb10-1063"><a href="#cb10-1063" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> d3</span>
<span id="cb10-1064"><a href="#cb10-1064" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">groups</span>(</span>
<span id="cb10-1065"><a href="#cb10-1065" aria-hidden="true" tabindex="-1"></a>      data_lclRisk<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">practice</span>)<span class="op">,</span></span>
<span id="cb10-1066"><a href="#cb10-1066" aria-hidden="true" tabindex="-1"></a>      (d) <span class="kw">=&gt;</span> d</span>
<span id="cb10-1067"><a href="#cb10-1067" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-1068"><a href="#cb10-1068" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[<span class="dv">0</span>])</span>
<span id="cb10-1069"><a href="#cb10-1069" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>()<span class="op">;</span></span>
<span id="cb10-1070"><a href="#cb10-1070" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> data<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb10-1071"><a href="#cb10-1071" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> { <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[d] }<span class="op">;</span></span>
<span id="cb10-1072"><a href="#cb10-1072" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(a<span class="op">.</span><span class="at">translation</span>) <span class="op">&gt;</span> <span class="fu">_lang</span>(b<span class="op">.</span><span class="at">translation</span>))<span class="op">;</span></span>
<span id="cb10-1073"><a href="#cb10-1073" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nullValue <span class="op">=</span> {</span>
<span id="cb10-1074"><a href="#cb10-1074" aria-hidden="true" tabindex="-1"></a>    <span class="dt">field</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb10-1075"><a href="#cb10-1075" aria-hidden="true" tabindex="-1"></a>    <span class="dt">translation</span><span class="op">:</span> nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">defaults</span><span class="op">.</span><span class="at">practice</span></span>
<span id="cb10-1076"><a href="#cb10-1076" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb10-1077"><a href="#cb10-1077" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> inputData <span class="op">=</span> [nullValue<span class="op">,</span> <span class="op">...</span>options]<span class="op">;</span></span>
<span id="cb10-1078"><a href="#cb10-1078" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(inputData<span class="op">,</span> {</span>
<span id="cb10-1079"><a href="#cb10-1079" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">highlightPractice</span>)<span class="op">,</span></span>
<span id="cb10-1080"><a href="#cb10-1080" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)</span>
<span id="cb10-1081"><a href="#cb10-1081" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb10-1082"><a href="#cb10-1082" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-10" data-nodetype="declaration"></div></div></div><div class="cell"><details class="code-fold"><summary>View table code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11" data-startfrom="1089" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1088"><span id="cb11-1089"><a href="#cb11-1089" aria-hidden="true" tabindex="-1"></a>plotRiskBeeswarm <span class="op">=</span> {</span>
<span id="cb11-1090"><a href="#cb11-1090" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> data_lclRisk<span class="op">;</span></span>
<span id="cb11-1091"><a href="#cb11-1091" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langLook <span class="op">=</span> {</span>
<span id="cb11-1092"><a href="#cb11-1092" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">risks</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">caption</span>)<span class="op">,</span></span>
<span id="cb11-1093"><a href="#cb11-1093" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xLabel</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">risks</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">xLabel</span>)<span class="op">,</span></span>
<span id="cb11-1094"><a href="#cb11-1094" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb11-1095"><a href="#cb11-1095" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb11-1096"><a href="#cb11-1096" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb11-1097"><a href="#cb11-1097" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb11-1098"><a href="#cb11-1098" aria-hidden="true" tabindex="-1"></a>      <span class="dt">combo</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb11-1099"><a href="#cb11-1099" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">risks</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">inCombination</span>)</span>
<span id="cb11-1100"><a href="#cb11-1100" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb11-1101"><a href="#cb11-1101" aria-hidden="true" tabindex="-1"></a>      <span class="dt">crop</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb11-1102"><a href="#cb11-1102" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">crop</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb11-1103"><a href="#cb11-1103" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb11-1104"><a href="#cb11-1104" aria-hidden="true" tabindex="-1"></a>      <span class="dt">obs</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb11-1105"><a href="#cb11-1105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb11-1106"><a href="#cb11-1106" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-1107"><a href="#cb11-1107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1108"><a href="#cb11-1108" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb11-1109"><a href="#cb11-1109" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _practice <span class="op">=</span> selectPractice<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb11-1110"><a href="#cb11-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1111"><a href="#cb11-1111" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb11-1112"><a href="#cb11-1112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">caption</span><span class="op">,</span></span>
<span id="cb11-1113"><a href="#cb11-1113" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb11-1114"><a href="#cb11-1114" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">800</span><span class="op">,</span></span>
<span id="cb11-1115"><a href="#cb11-1115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb11-1116"><a href="#cb11-1116" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb11-1117"><a href="#cb11-1117" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb11-1118"><a href="#cb11-1118" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-1119"><a href="#cb11-1119" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb11-1120"><a href="#cb11-1120" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">xLabel</span><span class="op">,</span></span>
<span id="cb11-1121"><a href="#cb11-1121" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb11-1122"><a href="#cb11-1122" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"center"</span><span class="op">,</span></span>
<span id="cb11-1123"><a href="#cb11-1123" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelArrow</span><span class="op">:</span> <span class="st">"none"</span></span>
<span id="cb11-1124"><a href="#cb11-1124" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-1125"><a href="#cb11-1125" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb11-1126"><a href="#cb11-1126" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb11-1127"><a href="#cb11-1127" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> colorYellowGreen<span class="op">,</span></span>
<span id="cb11-1128"><a href="#cb11-1128" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb11-1129"><a href="#cb11-1129" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unknown</span><span class="op">:</span> <span class="st">"#efefef"</span></span>
<span id="cb11-1130"><a href="#cb11-1130" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-1131"><a href="#cb11-1131" aria-hidden="true" tabindex="-1"></a>    <span class="dt">r</span><span class="op">:</span> {</span>
<span id="cb11-1132"><a href="#cb11-1132" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">30</span>]</span>
<span id="cb11-1133"><a href="#cb11-1133" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-1134"><a href="#cb11-1134" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb11-1135"><a href="#cb11-1135" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb11-1136"><a href="#cb11-1136" aria-hidden="true" tabindex="-1"></a>        data<span class="op">,</span></span>
<span id="cb11-1137"><a href="#cb11-1137" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">dodgeY</span>(</span>
<span id="cb11-1138"><a href="#cb11-1138" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">anchor</span><span class="op">:</span> <span class="st">"middle"</span> }<span class="op">,</span></span>
<span id="cb11-1139"><a href="#cb11-1139" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb11-1140"><a href="#cb11-1140" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span></span>
<span id="cb11-1141"><a href="#cb11-1141" aria-hidden="true" tabindex="-1"></a>            <span class="dt">r</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb11-1142"><a href="#cb11-1142" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb11-1143"><a href="#cb11-1143" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (_practice <span class="op">===</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">.</span><span class="at">value</span><span class="op">;</span> <span class="co">// show all practices</span></span>
<span id="cb11-1144"><a href="#cb11-1144" aria-hidden="true" tabindex="-1"></a>              <span class="co">// show highlighted practice only</span></span>
<span id="cb11-1145"><a href="#cb11-1145" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span> d<span class="op">.</span><span class="at">practice</span> <span class="op">===</span> _practice <span class="op">?</span> d<span class="op">.</span><span class="at">value</span> <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb11-1146"><a href="#cb11-1146" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb11-1147"><a href="#cb11-1147" aria-hidden="true" tabindex="-1"></a>            <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb11-1148"><a href="#cb11-1148" aria-hidden="true" tabindex="-1"></a>            <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb11-1149"><a href="#cb11-1149" aria-hidden="true" tabindex="-1"></a>            <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb11-1150"><a href="#cb11-1150" aria-hidden="true" tabindex="-1"></a>              <span class="dt">practice</span><span class="op">:</span> {</span>
<span id="cb11-1151"><a href="#cb11-1151" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">practice</span><span class="op">,</span></span>
<span id="cb11-1152"><a href="#cb11-1152" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[d<span class="op">.</span><span class="at">practice</span>])</span>
<span id="cb11-1153"><a href="#cb11-1153" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb11-1154"><a href="#cb11-1154" aria-hidden="true" tabindex="-1"></a>              <span class="dt">product</span><span class="op">:</span> {</span>
<span id="cb11-1155"><a href="#cb11-1155" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">crop</span><span class="op">,</span></span>
<span id="cb11-1156"><a href="#cb11-1156" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">product</span></span>
<span id="cb11-1157"><a href="#cb11-1157" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb11-1158"><a href="#cb11-1158" aria-hidden="true" tabindex="-1"></a>              <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb11-1159"><a href="#cb11-1159" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">obs</span><span class="op">,</span></span>
<span id="cb11-1160"><a href="#cb11-1160" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">observations</span></span>
<span id="cb11-1161"><a href="#cb11-1161" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb11-1162"><a href="#cb11-1162" aria-hidden="true" tabindex="-1"></a>              <span class="dt">combo</span><span class="op">:</span> {</span>
<span id="cb11-1163"><a href="#cb11-1163" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> langLook<span class="op">.</span><span class="at">tooltip</span><span class="op">.</span><span class="at">combo</span><span class="op">,</span></span>
<span id="cb11-1164"><a href="#cb11-1164" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb11-1165"><a href="#cb11-1165" aria-hidden="true" tabindex="-1"></a>                  d<span class="op">.</span><span class="at">is_combo</span></span>
<span id="cb11-1166"><a href="#cb11-1166" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Lang<span class="op">.</span><span class="fu">toTitleCase</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">bools</span><span class="op">.</span><span class="at">yes</span>))</span>
<span id="cb11-1167"><a href="#cb11-1167" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> Lang<span class="op">.</span><span class="fu">toTitleCase</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">bools</span><span class="op">.</span><span class="at">no</span>))</span>
<span id="cb11-1168"><a href="#cb11-1168" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb11-1169"><a href="#cb11-1169" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb11-1170"><a href="#cb11-1170" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tip</span><span class="op">:</span> {</span>
<span id="cb11-1171"><a href="#cb11-1171" aria-hidden="true" tabindex="-1"></a>              <span class="dt">px</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb11-1172"><a href="#cb11-1172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (_practice <span class="op">===</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">.</span><span class="at">value</span><span class="op">;</span> <span class="co">// show all practices</span></span>
<span id="cb11-1173"><a href="#cb11-1173" aria-hidden="true" tabindex="-1"></a>                <span class="co">// show highlighted practice only</span></span>
<span id="cb11-1174"><a href="#cb11-1174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> d<span class="op">.</span><span class="at">practice</span> <span class="op">===</span> _practice <span class="op">?</span> d<span class="op">.</span><span class="at">value</span> <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb11-1175"><a href="#cb11-1175" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb11-1176"><a href="#cb11-1176" aria-hidden="true" tabindex="-1"></a>              <span class="dt">maxRadius</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb11-1177"><a href="#cb11-1177" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb11-1178"><a href="#cb11-1178" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb11-1179"><a href="#cb11-1179" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb11-1180"><a href="#cb11-1180" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fill</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb11-1181"><a href="#cb11-1181" aria-hidden="true" tabindex="-1"></a>                <span class="dt">r</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb11-1182"><a href="#cb11-1182" aria-hidden="true" tabindex="-1"></a>                <span class="dt">practice</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-1183"><a href="#cb11-1183" aria-hidden="true" tabindex="-1"></a>                <span class="dt">combo</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-1184"><a href="#cb11-1184" aria-hidden="true" tabindex="-1"></a>                <span class="dt">product</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-1185"><a href="#cb11-1185" aria-hidden="true" tabindex="-1"></a>                <span class="dt">px</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">formatNum</span>(d)<span class="op">,</span></span>
<span id="cb11-1186"><a href="#cb11-1186" aria-hidden="true" tabindex="-1"></a>                <span class="dt">nObs</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb11-1187"><a href="#cb11-1187" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb11-1188"><a href="#cb11-1188" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-1189"><a href="#cb11-1189" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb11-1190"><a href="#cb11-1190" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-1191"><a href="#cb11-1191" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-1192"><a href="#cb11-1192" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb11-1193"><a href="#cb11-1193" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1194"><a href="#cb11-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1195"><a href="#cb11-1195" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plot<span class="op">;</span></span>
<span id="cb11-1196"><a href="#cb11-1196" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></details><div class="cell-output cell-output-display"><div id="ojs-cell-11" data-nodetype="declaration"></div></div></div><section id="quickinsight-2" class="level3"><h3 data-anchor-id="quickinsight-2"><span><span id="ojs-element-id-14"></span></span></h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb12" data-startfrom="1203" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1202"><span id="cb12-1203"><a href="#cb12-1203" aria-hidden="true" tabindex="-1"></a>quickInsightsRiskBeeswarm <span class="op">=</span> {</span>
<span id="cb12-1204"><a href="#cb12-1204" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langRoot <span class="op">=</span> nbText<span class="op">;</span></span>
<span id="cb12-1205"><a href="#cb12-1205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBasePath <span class="op">=</span> langRoot<span class="op">.</span><span class="at">risks</span><span class="op">.</span><span class="at">insights</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">;</span> <span class="co">// base path for language</span></span>
<span id="cb12-1206"><a href="#cb12-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1207"><a href="#cb12-1207" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedPractice <span class="op">=</span> selectPractice<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb12-1208"><a href="#cb12-1208" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb12-1209"><a href="#cb12-1209" aria-hidden="true" tabindex="-1"></a>    data_lclRisk<span class="op">,</span></span>
<span id="cb12-1210"><a href="#cb12-1210" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb12-1211"><a href="#cb12-1211" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (selectedPractice <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb12-1212"><a href="#cb12-1212" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> d<span class="op">.</span><span class="at">practice</span> <span class="op">==</span> selectedPractice<span class="op">;</span></span>
<span id="cb12-1213"><a href="#cb12-1213" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-1214"><a href="#cb12-1214" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-1215"><a href="#cb12-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1216"><a href="#cb12-1216" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOverview <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb12-1217"><a href="#cb12-1217" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb12-1218"><a href="#cb12-1218" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">summarize</span>({</span>
<span id="cb12-1219"><a href="#cb12-1219" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalObs</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"observations"</span>)<span class="op">,</span></span>
<span id="cb12-1220"><a href="#cb12-1220" aria-hidden="true" tabindex="-1"></a>      <span class="dt">totalPractices</span><span class="op">:</span> T<span class="op">.</span><span class="fu">count</span>(<span class="st">"practice"</span>)</span>
<span id="cb12-1221"><a href="#cb12-1221" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-1222"><a href="#cb12-1222" aria-hidden="true" tabindex="-1"></a>  )<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb12-1223"><a href="#cb12-1223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> numPractices <span class="op">=</span> dataOverview<span class="op">.</span><span class="at">totalPractices</span><span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb12-1224"><a href="#cb12-1224" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDataOverview_selection <span class="op">=</span></span>
<span id="cb12-1225"><a href="#cb12-1225" aria-hidden="true" tabindex="-1"></a>    selectedPractice <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> {<span class="dt">phrase</span><span class="op">:</span> <span class="st">"inTotal"</span><span class="op">,</span> <span class="dt">template</span><span class="op">:</span> <span class="st">"total"</span>} <span class="op">:</span> </span>
<span id="cb12-1226"><a href="#cb12-1226" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">phrase</span><span class="op">:</span> <span class="st">"specificHas"</span><span class="op">,</span> <span class="dt">template</span><span class="op">:</span> <span class="st">"specific"</span>}<span class="op">;</span></span>
<span id="cb12-1227"><a href="#cb12-1227" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDataOverview <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb12-1228"><a href="#cb12-1228" aria-hidden="true" tabindex="-1"></a>    langBasePath<span class="op">.</span><span class="at">dataOverview</span>[langDataOverview_selection<span class="op">.</span><span class="at">template</span>]<span class="op">,</span></span>
<span id="cb12-1229"><a href="#cb12-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1230"><a href="#cb12-1230" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-1231"><a href="#cb12-1231" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDataOverviewItems <span class="op">=</span> [</span>
<span id="cb12-1232"><a href="#cb12-1232" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1233"><a href="#cb12-1233" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"startString"</span><span class="op">,</span></span>
<span id="cb12-1234"><a href="#cb12-1234" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">phrases</span>[langDataOverview_selection<span class="op">.</span><span class="at">phrase</span>])</span>
<span id="cb12-1235"><a href="#cb12-1235" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-1236"><a href="#cb12-1236" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(dataOverview<span class="op">.</span><span class="at">totalObs</span>) }<span class="op">,</span></span>
<span id="cb12-1237"><a href="#cb12-1237" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1238"><a href="#cb12-1238" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb12-1239"><a href="#cb12-1239" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb12-1240"><a href="#cb12-1240" aria-hidden="true" tabindex="-1"></a>        dataOverview<span class="op">.</span><span class="at">totalObs</span> <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb12-1241"><a href="#cb12-1241" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1242"><a href="#cb12-1242" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1243"><a href="#cb12-1243" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-1244"><a href="#cb12-1244" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"item"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selectedPractice }<span class="op">,</span></span>
<span id="cb12-1245"><a href="#cb12-1245" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalPractices"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> numPractices }<span class="op">,</span></span>
<span id="cb12-1246"><a href="#cb12-1246" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1247"><a href="#cb12-1247" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practicesString"</span><span class="op">,</span></span>
<span id="cb12-1248"><a href="#cb12-1248" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb12-1249"><a href="#cb12-1249" aria-hidden="true" tabindex="-1"></a>        numPractices <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb12-1250"><a href="#cb12-1250" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1251"><a href="#cb12-1251" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1252"><a href="#cb12-1252" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-1253"><a href="#cb12-1253" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb12-1254"><a href="#cb12-1254" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDataOverview <span class="op">=</span> langDataOverviewItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb12-1255"><a href="#cb12-1255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb12-1256"><a href="#cb12-1256" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb12-1257"><a href="#cb12-1257" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb12-1258"><a href="#cb12-1258" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb12-1259"><a href="#cb12-1259" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langDataOverview)<span class="op">;</span></span>
<span id="cb12-1260"><a href="#cb12-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1261"><a href="#cb12-1261" aria-hidden="true" tabindex="-1"></a>  <span class="co">// top for selected crop</span></span>
<span id="cb12-1262"><a href="#cb12-1262" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> n <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// # top crops to include</span></span>
<span id="cb12-1263"><a href="#cb12-1263" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> topCrop <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb12-1264"><a href="#cb12-1264" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb12-1265"><a href="#cb12-1265" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(n<span class="op">,</span> <span class="st">"value"</span>)<span class="op">,</span></span>
<span id="cb12-1266"><a href="#cb12-1266" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(T<span class="op">.</span><span class="fu">desc</span>(<span class="st">"value"</span>))</span>
<span id="cb12-1267"><a href="#cb12-1267" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-1268"><a href="#cb12-1268" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff1 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb12-1269"><a href="#cb12-1269" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diff2 <span class="op">=</span> topCrop<span class="op">?.</span>[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb12-1270"><a href="#cb12-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1271"><a href="#cb12-1271" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffFirst</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb12-1272"><a href="#cb12-1272" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirst_observations <span class="op">=</span> diff1<span class="op">.</span><span class="at">observations</span><span class="op">;</span></span>
<span id="cb12-1273"><a href="#cb12-1273" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffFirstItems <span class="op">=</span> [</span>
<span id="cb12-1274"><a href="#cb12-1274" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[diff1<span class="op">.</span><span class="at">practice</span>]) }<span class="op">,</span></span>
<span id="cb12-1275"><a href="#cb12-1275" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"crop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop_with_articles</span><span class="op">.</span><span class="at">values</span>[diff1<span class="op">.</span><span class="at">product</span>]) }<span class="op">,</span></span>
<span id="cb12-1276"><a href="#cb12-1276" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1277"><a href="#cb12-1277" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"comboString"</span><span class="op">,</span></span>
<span id="cb12-1278"><a href="#cb12-1278" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> diff1<span class="op">.</span><span class="at">is_combo</span></span>
<span id="cb12-1279"><a href="#cb12-1279" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffGeneral</span><span class="op">.</span><span class="at">combo</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1280"><a href="#cb12-1280" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffGeneral</span><span class="op">.</span><span class="at">combo</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1281"><a href="#cb12-1281" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-1282"><a href="#cb12-1282" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"probYield"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff1<span class="op">.</span><span class="at">value</span>) }<span class="op">,</span></span>
<span id="cb12-1283"><a href="#cb12-1283" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(langDiffFirst_observations) }<span class="op">,</span></span>
<span id="cb12-1284"><a href="#cb12-1284" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1285"><a href="#cb12-1285" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb12-1286"><a href="#cb12-1286" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb12-1287"><a href="#cb12-1287" aria-hidden="true" tabindex="-1"></a>        langDiffFirst_observations <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb12-1288"><a href="#cb12-1288" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1289"><a href="#cb12-1289" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1290"><a href="#cb12-1290" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-1291"><a href="#cb12-1291" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb12-1292"><a href="#cb12-1292" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffFirst <span class="op">=</span> langDiffFirstItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb12-1293"><a href="#cb12-1293" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb12-1294"><a href="#cb12-1294" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb12-1295"><a href="#cb12-1295" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb12-1296"><a href="#cb12-1296" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb12-1297"><a href="#cb12-1297" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langDiffFirst)<span class="op">;</span></span>
<span id="cb12-1298"><a href="#cb12-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1299"><a href="#cb12-1299" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffSecond</span><span class="op">.</span><span class="at">main</span>)<span class="op">;</span></span>
<span id="cb12-1300"><a href="#cb12-1300" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecond_observations <span class="op">=</span> diff2<span class="op">?.</span><span class="at">observations</span><span class="op">;</span></span>
<span id="cb12-1301"><a href="#cb12-1301" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langDiffSecondItems <span class="op">=</span> [</span>
<span id="cb12-1302"><a href="#cb12-1302" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Practice</span><span class="op">.</span><span class="at">values</span>[diff2<span class="op">.</span><span class="at">practice</span>]) }<span class="op">,</span></span>
<span id="cb12-1303"><a href="#cb12-1303" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"crop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">Crop_with_articles</span><span class="op">.</span><span class="at">values</span>[diff2<span class="op">.</span><span class="at">product</span>]) }<span class="op">,</span></span>
<span id="cb12-1304"><a href="#cb12-1304" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1305"><a href="#cb12-1305" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"comboString"</span><span class="op">,</span></span>
<span id="cb12-1306"><a href="#cb12-1306" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> diff2<span class="op">.</span><span class="at">is_combo</span></span>
<span id="cb12-1307"><a href="#cb12-1307" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffGeneral</span><span class="op">.</span><span class="at">combo</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1308"><a href="#cb12-1308" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">diffGeneral</span><span class="op">.</span><span class="at">combo</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1309"><a href="#cb12-1309" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-1310"><a href="#cb12-1310" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"probYield"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatNum</span>(diff2<span class="op">.</span><span class="at">value</span>) }<span class="op">,</span></span>
<span id="cb12-1311"><a href="#cb12-1311" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(langDiffSecond_observations) }<span class="op">,</span></span>
<span id="cb12-1312"><a href="#cb12-1312" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb12-1313"><a href="#cb12-1313" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"observationString"</span><span class="op">,</span></span>
<span id="cb12-1314"><a href="#cb12-1314" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span></span>
<span id="cb12-1315"><a href="#cb12-1315" aria-hidden="true" tabindex="-1"></a>        langDiffSecond_observations <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb12-1316"><a href="#cb12-1316" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb12-1317"><a href="#cb12-1317" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb12-1318"><a href="#cb12-1318" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-1319"><a href="#cb12-1319" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb12-1320"><a href="#cb12-1320" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insightDiffSecond <span class="op">=</span> diff2</span>
<span id="cb12-1321"><a href="#cb12-1321" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> langDiffSecondItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb12-1322"><a href="#cb12-1322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb12-1323"><a href="#cb12-1323" aria-hidden="true" tabindex="-1"></a>          Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb12-1324"><a href="#cb12-1324" aria-hidden="true" tabindex="-1"></a>          item<span class="op">.</span><span class="at">value</span></span>
<span id="cb12-1325"><a href="#cb12-1325" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb12-1326"><a href="#cb12-1326" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span> langDiffSecond)</span>
<span id="cb12-1327"><a href="#cb12-1327" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb12-1328"><a href="#cb12-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1329"><a href="#cb12-1329" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>insightDataOverview<span class="sc">}</span></span>
<span id="cb12-1330"><a href="#cb12-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1331"><a href="#cb12-1331" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insightDiffFirst<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>insightDiffSecond<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb12-1332"><a href="#cb12-1332" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-12" data-nodetype="declaration"></div></div></div></section></section><section id="adoptionFactors" class="level1"><h1><span><span id="ojs-element-id-15"></span></span></h1><p><span><span id="ojs-element-id-16"></span></span></p><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb13" data-startfrom="1341" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1340"><span id="cb13-1341"><a href="#cb13-1341" aria-hidden="true" tabindex="-1"></a>viewof dataAdoptionFactors_select <span class="op">=</span> {</span>
<span id="cb13-1342"><a href="#cb13-1342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> [<span class="op">...</span>dataAdoptionFactorsMap<span class="op">.</span><span class="fu">keys</span>()]</span>
<span id="cb13-1343"><a href="#cb13-1343" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb13-1344"><a href="#cb13-1344" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">practices</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d] }<span class="op">;</span></span>
<span id="cb13-1345"><a href="#cb13-1345" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb13-1346"><a href="#cb13-1346" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb13-1347"><a href="#cb13-1347" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (d<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="st">"All practices"</span>)</span>
<span id="cb13-1348"><a href="#cb13-1348" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> { <span class="op">...</span>d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">defaults</span><span class="op">.</span><span class="at">practice</span> }<span class="op">;</span></span>
<span id="cb13-1349"><a href="#cb13-1349" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="op">...</span>d }<span class="op">;</span></span>
<span id="cb13-1350"><a href="#cb13-1350" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb13-1351"><a href="#cb13-1351" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sorted <span class="op">=</span> [</span>
<span id="cb13-1352"><a href="#cb13-1352" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>options</span>
<span id="cb13-1353"><a href="#cb13-1353" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="st">"All practices"</span>)<span class="op">,</span></span>
<span id="cb13-1354"><a href="#cb13-1354" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>options</span>
<span id="cb13-1355"><a href="#cb13-1355" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">field</span> <span class="op">!==</span> <span class="st">"All practices"</span>)</span>
<span id="cb13-1356"><a href="#cb13-1356" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(a<span class="op">.</span><span class="at">translation</span>) <span class="op">&gt;</span> <span class="fu">_lang</span>(b<span class="op">.</span><span class="at">translation</span>))</span>
<span id="cb13-1357"><a href="#cb13-1357" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb13-1358"><a href="#cb13-1358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(sorted<span class="op">,</span> {</span>
<span id="cb13-1359"><a href="#cb13-1359" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)<span class="op">,</span></span>
<span id="cb13-1360"><a href="#cb13-1360" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (x) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)</span>
<span id="cb13-1361"><a href="#cb13-1361" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb13-1362"><a href="#cb13-1362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-1363"><a href="#cb13-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-1364"><a href="#cb13-1364" aria-hidden="true" tabindex="-1"></a>viewof radioSortAdoptionFactors <span class="op">=</span> {</span>
<span id="cb13-1365"><a href="#cb13-1365" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb13-1366"><a href="#cb13-1366" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb13-1367"><a href="#cb13-1367" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb13-1368"><a href="#cb13-1368" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">observations</span>)<span class="op">,</span></span>
<span id="cb13-1369"><a href="#cb13-1369" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"total"</span><span class="op">,</span></span>
<span id="cb13-1370"><a href="#cb13-1370" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb13-1371"><a href="#cb13-1371" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb13-1372"><a href="#cb13-1372" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb13-1373"><a href="#cb13-1373" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"alpha"</span><span class="op">,</span></span>
<span id="cb13-1374"><a href="#cb13-1374" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">radioSort</span><span class="op">.</span><span class="at">fields</span><span class="op">.</span><span class="at">alpha</span>)<span class="op">,</span></span>
<span id="cb13-1375"><a href="#cb13-1375" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb13-1376"><a href="#cb13-1376" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb13-1377"><a href="#cb13-1377" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb13-1378"><a href="#cb13-1378" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb13-1379"><a href="#cb13-1379" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(data<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">sortBars</span>)<span class="op">,</span> <span class="dt">format</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>(x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">'observations'</span>) })<span class="op">;</span></span>
<span id="cb13-1380"><a href="#cb13-1380" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-13-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-13-2" data-nodetype="declaration"></div></div></div></div><div class="cell"><details class="code-fold"><summary>View table code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14" data-startfrom="1386" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1385"><span id="cb14-1386"><a href="#cb14-1386" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb14-1387"><a href="#cb14-1387" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plotData <span class="op">=</span> dataAdoptionFactorsMap<span class="op">.</span><span class="fu">get</span>(dataAdoptionFactors_select<span class="op">.</span><span class="at">field</span>)<span class="op">;</span></span>
<span id="cb14-1388"><a href="#cb14-1388" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _fillLookup <span class="op">=</span> adoptionFactorsLookup<span class="op">;</span></span>
<span id="cb14-1389"><a href="#cb14-1389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _sorter <span class="op">=</span> radioSortAdoptionFactors<span class="op">;</span></span>
<span id="cb14-1390"><a href="#cb14-1390" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorOrder <span class="op">=</span> [</span>
<span id="cb14-1391"><a href="#cb14-1391" aria-hidden="true" tabindex="-1"></a>    _fillLookup[<span class="st">"Negative"</span>]<span class="op">,</span></span>
<span id="cb14-1392"><a href="#cb14-1392" aria-hidden="true" tabindex="-1"></a>    _fillLookup[<span class="st">"Not significant"</span>]<span class="op">,</span></span>
<span id="cb14-1393"><a href="#cb14-1393" aria-hidden="true" tabindex="-1"></a>    _fillLookup[<span class="st">"Positive"</span>]</span>
<span id="cb14-1394"><a href="#cb14-1394" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb14-1395"><a href="#cb14-1395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorRange <span class="op">=</span> [<span class="st">"#EC5A47"</span><span class="op">,</span> <span class="st">"#F4BB21"</span><span class="op">,</span> <span class="st">"#216729"</span>]<span class="op">;</span></span>
<span id="cb14-1396"><a href="#cb14-1396" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">adoption_factors</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb14-1397"><a href="#cb14-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-1398"><a href="#cb14-1398" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb14-1399"><a href="#cb14-1399" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb14-1400"><a href="#cb14-1400" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb14-1401"><a href="#cb14-1401" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">180</span><span class="op">,</span></span>
<span id="cb14-1402"><a href="#cb14-1402" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb14-1403"><a href="#cb14-1403" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb14-1404"><a href="#cb14-1404" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb14-1405"><a href="#cb14-1405" aria-hidden="true" tabindex="-1"></a>      <span class="co">// label: "% Total"</span></span>
<span id="cb14-1406"><a href="#cb14-1406" aria-hidden="true" tabindex="-1"></a>      <span class="co">// labelOffset: 40,</span></span>
<span id="cb14-1407"><a href="#cb14-1407" aria-hidden="true" tabindex="-1"></a>      <span class="co">// labelAnchor: "center"</span></span>
<span id="cb14-1408"><a href="#cb14-1408" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-1409"><a href="#cb14-1409" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb14-1410"><a href="#cb14-1410" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb14-1411"><a href="#cb14-1411" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb14-1412"><a href="#cb14-1412" aria-hidden="true" tabindex="-1"></a>      <span class="dt">padding</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb14-1413"><a href="#cb14-1413" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-1414"><a href="#cb14-1414" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb14-1415"><a href="#cb14-1415" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> colorOrder<span class="op">,</span></span>
<span id="cb14-1416"><a href="#cb14-1416" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> colorRange<span class="op">,</span></span>
<span id="cb14-1417"><a href="#cb14-1417" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb14-1418"><a href="#cb14-1418" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-1419"><a href="#cb14-1419" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb14-1420"><a href="#cb14-1420" aria-hidden="true" tabindex="-1"></a>      <span class="co">// main y-axis</span></span>
<span id="cb14-1421"><a href="#cb14-1421" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({</span>
<span id="cb14-1422"><a href="#cb14-1422" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb14-1423"><a href="#cb14-1423" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb14-1424"><a href="#cb14-1424" aria-hidden="true" tabindex="-1"></a>      <span class="co">// pointer white-out</span></span>
<span id="cb14-1425"><a href="#cb14-1425" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb14-1426"><a href="#cb14-1426" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb14-1427"><a href="#cb14-1427" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb14-1428"><a href="#cb14-1428" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb14-1429"><a href="#cb14-1429" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStrokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb14-1430"><a href="#cb14-1430" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb14-1431"><a href="#cb14-1431" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb14-1432"><a href="#cb14-1432" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb14-1433"><a href="#cb14-1433" aria-hidden="true" tabindex="-1"></a>      <span class="co">// bold pointer</span></span>
<span id="cb14-1434"><a href="#cb14-1434" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb14-1435"><a href="#cb14-1435" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb14-1436"><a href="#cb14-1436" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb14-1437"><a href="#cb14-1437" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb14-1438"><a href="#cb14-1438" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb14-1439"><a href="#cb14-1439" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb14-1440"><a href="#cb14-1440" aria-hidden="true" tabindex="-1"></a>      <span class="co">// bars</span></span>
<span id="cb14-1441"><a href="#cb14-1441" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barX</span>(</span>
<span id="cb14-1442"><a href="#cb14-1442" aria-hidden="true" tabindex="-1"></a>        plotData<span class="op">,</span></span>
<span id="cb14-1443"><a href="#cb14-1443" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">stackX</span>({</span>
<span id="cb14-1444"><a href="#cb14-1444" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> <span class="st">"perc"</span><span class="op">,</span></span>
<span id="cb14-1445"><a href="#cb14-1445" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">factor</span>)<span class="op">,</span></span>
<span id="cb14-1446"><a href="#cb14-1446" aria-hidden="true" tabindex="-1"></a>          <span class="dt">sort</span><span class="op">:</span> { <span class="dt">y</span><span class="op">:</span> _sorter<span class="op">.</span><span class="at">channel</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> _sorter<span class="op">.</span><span class="at">reverse</span> }<span class="op">,</span></span>
<span id="cb14-1447"><a href="#cb14-1447" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> _fillLookup[d<span class="op">.</span><span class="at">direction</span>]<span class="op">,</span></span>
<span id="cb14-1448"><a href="#cb14-1448" aria-hidden="true" tabindex="-1"></a>          <span class="dt">order</span><span class="op">:</span> colorOrder<span class="op">,</span></span>
<span id="cb14-1449"><a href="#cb14-1449" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb14-1450"><a href="#cb14-1450" aria-hidden="true" tabindex="-1"></a>          <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb14-1451"><a href="#cb14-1451" aria-hidden="true" tabindex="-1"></a>            <span class="dt">percentage</span><span class="op">:</span> {</span>
<span id="cb14-1452"><a href="#cb14-1452" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb14-1453"><a href="#cb14-1453" aria-hidden="true" tabindex="-1"></a>                <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">percentage</span><span class="op">.</span><span class="at">singular</span>)</span>
<span id="cb14-1454"><a href="#cb14-1454" aria-hidden="true" tabindex="-1"></a>              )<span class="op">,</span></span>
<span id="cb14-1455"><a href="#cb14-1455" aria-hidden="true" tabindex="-1"></a>              <span class="dt">value</span><span class="op">:</span> <span class="st">"perc"</span></span>
<span id="cb14-1456"><a href="#cb14-1456" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb14-1457"><a href="#cb14-1457" aria-hidden="true" tabindex="-1"></a>            <span class="dt">total</span><span class="op">:</span> <span class="st">"total"</span><span class="op">,</span></span>
<span id="cb14-1458"><a href="#cb14-1458" aria-hidden="true" tabindex="-1"></a>            <span class="dt">n</span><span class="op">:</span> {</span>
<span id="cb14-1459"><a href="#cb14-1459" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> Lang<span class="op">.</span><span class="fu">toSentenceCase</span>(</span>
<span id="cb14-1460"><a href="#cb14-1460" aria-hidden="true" tabindex="-1"></a>                <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">observation</span><span class="op">.</span><span class="at">plural</span>)</span>
<span id="cb14-1461"><a href="#cb14-1461" aria-hidden="true" tabindex="-1"></a>              )<span class="op">,</span></span>
<span id="cb14-1462"><a href="#cb14-1462" aria-hidden="true" tabindex="-1"></a>              <span class="dt">value</span><span class="op">:</span> <span class="st">"n"</span></span>
<span id="cb14-1463"><a href="#cb14-1463" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb14-1464"><a href="#cb14-1464" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb14-1465"><a href="#cb14-1465" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tip</span><span class="op">:</span> {</span>
<span id="cb14-1466"><a href="#cb14-1466" aria-hidden="true" tabindex="-1"></a>            <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb14-1467"><a href="#cb14-1467" aria-hidden="true" tabindex="-1"></a>              <span class="dt">x</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb14-1468"><a href="#cb14-1468" aria-hidden="true" tabindex="-1"></a>              <span class="dt">y</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb14-1469"><a href="#cb14-1469" aria-hidden="true" tabindex="-1"></a>              <span class="dt">fill</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb14-1470"><a href="#cb14-1470" aria-hidden="true" tabindex="-1"></a>              <span class="dt">total</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb14-1471"><a href="#cb14-1471" aria-hidden="true" tabindex="-1"></a>              <span class="dt">percentage</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">"d"</span>)(d)<span class="sc">}</span><span class="vs">%`</span><span class="op">,</span></span>
<span id="cb14-1472"><a href="#cb14-1472" aria-hidden="true" tabindex="-1"></a>              <span class="dt">n</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb14-1473"><a href="#cb14-1473" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb14-1474"><a href="#cb14-1474" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb14-1475"><a href="#cb14-1475" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb14-1476"><a href="#cb14-1476" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb14-1477"><a href="#cb14-1477" aria-hidden="true" tabindex="-1"></a>      <span class="fu">markBoldSidebarText</span>(plotData<span class="op">,</span> {</span>
<span id="cb14-1478"><a href="#cb14-1478" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">factor</span>)<span class="op">,</span></span>
<span id="cb14-1479"><a href="#cb14-1479" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> <span class="st">"n"</span><span class="op">,</span></span>
<span id="cb14-1480"><a href="#cb14-1480" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dx</span><span class="op">:</span> <span class="dv">7</span></span>
<span id="cb14-1481"><a href="#cb14-1481" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb14-1482"><a href="#cb14-1482" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb14-1483"><a href="#cb14-1483" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb14-1484"><a href="#cb14-1484" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></details><div class="cell-output cell-output-display"><div id="ojs-cell-14" data-nodetype="expression"></div></div></div><section id="quickinsight-3" class="level3"><h3 data-anchor-id="quickinsight-3"><span><span id="ojs-element-id-17"></span></span></h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb15" data-startfrom="1491" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1490"><span id="cb15-1491"><a href="#cb15-1491" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb15-1492"><a href="#cb15-1492" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langRoot <span class="op">=</span> nbText<span class="op">;</span></span>
<span id="cb15-1493"><a href="#cb15-1493" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBasePath <span class="op">=</span> langRoot<span class="op">.</span><span class="at">adoptionFactors</span><span class="op">.</span><span class="at">insights</span><span class="op">.</span><span class="at">percBar</span><span class="op">;</span> <span class="co">// base path for language</span></span>
<span id="cb15-1494"><a href="#cb15-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1495"><a href="#cb15-1495" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectedPractice <span class="op">=</span> dataAdoptionFactors_select<span class="op">.</span><span class="at">field</span><span class="op">;</span></span>
<span id="cb15-1496"><a href="#cb15-1496" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> dataAdoptionFactorsMap<span class="op">.</span><span class="fu">get</span>(selectedPractice)<span class="op">;</span></span>
<span id="cb15-1497"><a href="#cb15-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1498"><a href="#cb15-1498" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tl_prac <span class="op">=</span> (prac) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">practices</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[prac])<span class="op">;</span></span>
<span id="cb15-1499"><a href="#cb15-1499" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tl_fact <span class="op">=</span> (fact) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">adoption_factors_with_articles</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[fact])<span class="op">;</span></span>
<span id="cb15-1500"><a href="#cb15-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1501"><a href="#cb15-1501" aria-hidden="true" tabindex="-1"></a>  <span class="co">// total observations overview</span></span>
<span id="cb15-1502"><a href="#cb15-1502" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> total <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb15-1503"><a href="#cb15-1503" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb15-1504"><a href="#cb15-1504" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">groupBy</span>(</span>
<span id="cb15-1505"><a href="#cb15-1505" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"practice"</span>]<span class="op">,</span></span>
<span id="cb15-1506"><a href="#cb15-1506" aria-hidden="true" tabindex="-1"></a>      [</span>
<span id="cb15-1507"><a href="#cb15-1507" aria-hidden="true" tabindex="-1"></a>        T<span class="op">.</span><span class="fu">summarize</span>({</span>
<span id="cb15-1508"><a href="#cb15-1508" aria-hidden="true" tabindex="-1"></a>          <span class="dt">totalObservations</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"n"</span>)<span class="op">,</span></span>
<span id="cb15-1509"><a href="#cb15-1509" aria-hidden="true" tabindex="-1"></a>          <span class="dt">factorCount</span><span class="op">:</span> T<span class="op">.</span><span class="fu">count</span>(<span class="st">"factor"</span>)</span>
<span id="cb15-1510"><a href="#cb15-1510" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-1511"><a href="#cb15-1511" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb15-1512"><a href="#cb15-1512" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-1513"><a href="#cb15-1513" aria-hidden="true" tabindex="-1"></a>  )[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb15-1514"><a href="#cb15-1514" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const mdTotal =</span></span>
<span id="cb15-1515"><a href="#cb15-1515" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   total.practice == adoptionFactorAllLabel</span></span>
<span id="cb15-1516"><a href="#cb15-1516" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     ? `In total, there are`</span></span>
<span id="cb15-1517"><a href="#cb15-1517" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     : `**${total}** has`;</span></span>
<span id="cb15-1518"><a href="#cb15-1518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTotal_selection <span class="op">=</span></span>
<span id="cb15-1519"><a href="#cb15-1519" aria-hidden="true" tabindex="-1"></a>    total<span class="op">.</span><span class="at">practice</span> <span class="op">==</span> adoptionFactorAllLabel <span class="op">?</span> <span class="st">"inTotal"</span> <span class="op">:</span> <span class="st">"specificHas"</span><span class="op">;</span></span>
<span id="cb15-1520"><a href="#cb15-1520" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTotal <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">overview</span>)<span class="op">;</span></span>
<span id="cb15-1521"><a href="#cb15-1521" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTotalItems <span class="op">=</span> [</span>
<span id="cb15-1522"><a href="#cb15-1522" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb15-1523"><a href="#cb15-1523" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insertName</span><span class="op">:</span> <span class="st">"startString"</span><span class="op">,</span></span>
<span id="cb15-1524"><a href="#cb15-1524" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">phrases</span>[langTotal_selection])</span>
<span id="cb15-1525"><a href="#cb15-1525" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb15-1526"><a href="#cb15-1526" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalObs"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">formatComma</span>(total<span class="op">.</span><span class="at">totalObservations</span>) }<span class="op">,</span></span>
<span id="cb15-1527"><a href="#cb15-1527" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"item"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_prac</span>(total<span class="op">.</span><span class="at">practice</span>) }<span class="op">,</span></span>
<span id="cb15-1528"><a href="#cb15-1528" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"totalFactors"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> total<span class="op">.</span><span class="at">factorCount</span><span class="op">.</span><span class="at">length</span> }</span>
<span id="cb15-1529"><a href="#cb15-1529" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb15-1530"><a href="#cb15-1530" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> mdOverview <span class="op">=</span> langTotalItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb15-1531"><a href="#cb15-1531" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb15-1532"><a href="#cb15-1532" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb15-1533"><a href="#cb15-1533" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb15-1534"><a href="#cb15-1534" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb15-1535"><a href="#cb15-1535" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langTotal)<span class="op">;</span></span>
<span id="cb15-1536"><a href="#cb15-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1537"><a href="#cb15-1537" aria-hidden="true" tabindex="-1"></a>  <span class="co">// total significant sum (needle move)</span></span>
<span id="cb15-1538"><a href="#cb15-1538" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> topNeedleMove <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb15-1539"><a href="#cb15-1539" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb15-1540"><a href="#cb15-1540" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">direction</span> <span class="op">!==</span> <span class="st">"Not significant"</span>)<span class="op">,</span></span>
<span id="cb15-1541"><a href="#cb15-1541" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">groupBy</span>([<span class="st">"factor"</span>]<span class="op">,</span> [T<span class="op">.</span><span class="fu">summarize</span>({ <span class="dt">perc_sig</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"perc"</span>) })])<span class="op">,</span></span>
<span id="cb15-1542"><a href="#cb15-1542" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(T<span class="op">.</span><span class="fu">desc</span>(<span class="st">"perc_sig"</span>))<span class="op">,</span></span>
<span id="cb15-1543"><a href="#cb15-1543" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">"perc_sig"</span>)</span>
<span id="cb15-1544"><a href="#cb15-1544" aria-hidden="true" tabindex="-1"></a>  )[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb15-1545"><a href="#cb15-1545" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTopNeedle <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">mostImpactfulFactor</span>)<span class="op">;</span></span>
<span id="cb15-1546"><a href="#cb15-1546" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langTopNeedleItems <span class="op">=</span> [</span>
<span id="cb15-1547"><a href="#cb15-1547" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"factor"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_fact</span>(topNeedleMove<span class="op">.</span><span class="at">factor</span>) }<span class="op">,</span></span>
<span id="cb15-1548"><a href="#cb15-1548" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"practice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_prac</span>(selectedPractice) }<span class="op">,</span></span>
<span id="cb15-1549"><a href="#cb15-1549" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"influence"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">"d"</span>)(topNeedleMove<span class="op">.</span><span class="at">perc_sig</span>) }</span>
<span id="cb15-1550"><a href="#cb15-1550" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb15-1551"><a href="#cb15-1551" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> mdTopNeedle <span class="op">=</span> langTopNeedleItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb15-1552"><a href="#cb15-1552" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb15-1553"><a href="#cb15-1553" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb15-1554"><a href="#cb15-1554" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb15-1555"><a href="#cb15-1555" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb15-1556"><a href="#cb15-1556" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langTopNeedle)<span class="op">;</span></span>
<span id="cb15-1557"><a href="#cb15-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1558"><a href="#cb15-1558" aria-hidden="true" tabindex="-1"></a>  <span class="co">// high neg influence</span></span>
<span id="cb15-1559"><a href="#cb15-1559" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> largeNegInfluence <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb15-1560"><a href="#cb15-1560" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb15-1561"><a href="#cb15-1561" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">direction</span> <span class="op">==</span> <span class="st">"Negative"</span>)<span class="op">,</span></span>
<span id="cb15-1562"><a href="#cb15-1562" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">"perc"</span>)</span>
<span id="cb15-1563"><a href="#cb15-1563" aria-hidden="true" tabindex="-1"></a>  )[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb15-1564"><a href="#cb15-1564" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> largePosInfluence <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb15-1565"><a href="#cb15-1565" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb15-1566"><a href="#cb15-1566" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">direction</span> <span class="op">==</span> <span class="st">"Positive"</span>)<span class="op">,</span></span>
<span id="cb15-1567"><a href="#cb15-1567" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">sliceMax</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">"perc"</span>)</span>
<span id="cb15-1568"><a href="#cb15-1568" aria-hidden="true" tabindex="-1"></a>  )[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb15-1569"><a href="#cb15-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1570"><a href="#cb15-1570" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBigInfluence <span class="op">=</span> <span class="fu">_lang</span>(langBasePath<span class="op">.</span><span class="at">biggestInfluences</span>)</span>
<span id="cb15-1571"><a href="#cb15-1571" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> langBigInfluenceItems <span class="op">=</span> [</span>
<span id="cb15-1572"><a href="#cb15-1572" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"factorNeg"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_fact</span>(largeNegInfluence<span class="op">.</span><span class="at">factor</span>) }<span class="op">,</span></span>
<span id="cb15-1573"><a href="#cb15-1573" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"influenceNeg"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">"d"</span>)(largeNegInfluence<span class="op">.</span><span class="at">perc</span>) }<span class="op">,</span></span>
<span id="cb15-1574"><a href="#cb15-1574" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"factorPos"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">tl_fact</span>(largePosInfluence<span class="op">.</span><span class="at">factor</span>) }<span class="op">,</span></span>
<span id="cb15-1575"><a href="#cb15-1575" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">insertName</span><span class="op">:</span> <span class="st">"influencePos"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">"d"</span>)(largePosInfluence<span class="op">.</span><span class="at">perc</span>) }<span class="op">,</span></span>
<span id="cb15-1576"><a href="#cb15-1576" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb15-1577"><a href="#cb15-1577" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> mdBigInfluence <span class="op">=</span> langBigInfluenceItems<span class="op">.</span><span class="fu">reduce</span>((overview<span class="op">,</span> item) <span class="kw">=&gt;</span> {</span>
<span id="cb15-1578"><a href="#cb15-1578" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overview<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb15-1579"><a href="#cb15-1579" aria-hidden="true" tabindex="-1"></a>      Lang<span class="op">.</span><span class="fu">getRegexForNamedInsertion</span>(item<span class="op">.</span><span class="at">insertName</span>)<span class="op">,</span></span>
<span id="cb15-1580"><a href="#cb15-1580" aria-hidden="true" tabindex="-1"></a>      item<span class="op">.</span><span class="at">value</span></span>
<span id="cb15-1581"><a href="#cb15-1581" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb15-1582"><a href="#cb15-1582" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> langBigInfluence)<span class="op">;</span></span>
<span id="cb15-1583"><a href="#cb15-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1584"><a href="#cb15-1584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>mdOverview<span class="sc">}</span></span>
<span id="cb15-1585"><a href="#cb15-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1586"><a href="#cb15-1586" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>mdTopNeedle<span class="sc">}</span></span>
<span id="cb15-1587"><a href="#cb15-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1588"><a href="#cb15-1588" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>mdBigInfluence<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb15-1589"><a href="#cb15-1589" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-15" data-nodetype="declaration"></div></div></div></section></section><section id="summary" class="level1"><h1><span><span id="ojs-element-id-18"></span></span></h1><p><span><span id="ojs-element-id-19"></span></span></p><p><span><span id="ojs-element-id-20"></span></span></p><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb16" data-startfrom="1600" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1599"><span id="cb16-1600"><a href="#cb16-1600" aria-hidden="true" tabindex="-1"></a>viewof selectResourcePractice <span class="op">=</span> {</span>
<span id="cb16-1601"><a href="#cb16-1601" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> _<span class="op">.</span><span class="fu">uniq</span>(csaManuals<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">practice</span>))</span>
<span id="cb16-1602"><a href="#cb16-1602" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb16-1603"><a href="#cb16-1603" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="dt">field</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">translation</span><span class="op">:</span> td<span class="op">.</span><span class="at">summaryPractices</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d] }<span class="op">;</span></span>
<span id="cb16-1604"><a href="#cb16-1604" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb16-1605"><a href="#cb16-1605" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(a<span class="op">.</span><span class="at">translation</span>) <span class="op">&gt;</span> <span class="fu">_lang</span>(b<span class="op">.</span><span class="at">translation</span>))<span class="op">;</span></span>
<span id="cb16-1606"><a href="#cb16-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1607"><a href="#cb16-1607" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(data<span class="op">,</span> {</span>
<span id="cb16-1608"><a href="#cb16-1608" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">words</span><span class="op">.</span><span class="at">practice</span><span class="op">.</span><span class="at">singular</span>)<span class="op">,</span></span>
<span id="cb16-1609"><a href="#cb16-1609" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">_lang</span>(x<span class="op">.</span><span class="at">translation</span>)<span class="op">,</span></span>
<span id="cb16-1610"><a href="#cb16-1610" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>(x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">field</span> <span class="op">==</span> <span class="st">"Inorganic Fertilizer"</span>)</span>
<span id="cb16-1611"><a href="#cb16-1611" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb16-1612"><a href="#cb16-1612" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-1613"><a href="#cb16-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1614"><a href="#cb16-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span><span class="sc">${</span>csaResourceHtml<span class="sc">}</span><span class="vs">`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-16-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-16-2" data-nodetype="expression"></div></div></div></div></section><section id="methods" class="level1"><h1><span><span id="ojs-element-id-21"></span></span></h1><p><span><span id="ojs-element-id-22"></span></span></p><section id="data_sources" class="level2"><h2 data-anchor-id="data_sources"><span><span id="ojs-element-id-23"></span></span></h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb17" data-startfrom="1623" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1622"><span id="cb17-1623"><a href="#cb17-1623" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h2DataSourcesSubsection</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-17" data-nodetype="expression"></div></div></div></section><section id="methods-1" class="level2"><h2 data-anchor-id="methods-1"><span><span id="ojs-element-id-24"></span></span></h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb18" data-startfrom="1629" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1628"><span id="cb18-1629"><a href="#cb18-1629" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span></span>
<span id="cb18-1630"><a href="#cb18-1630" aria-hidden="true" tabindex="-1"></a><span class="vs">### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h3Era</span>)<span class="sc">}</span></span>
<span id="cb18-1631"><a href="#cb18-1631" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h3EraSubsection</span>)<span class="sc">}</span></span>
<span id="cb18-1632"><a href="#cb18-1632" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-18" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb19" data-startfrom="1638" data-source-offset="-61"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1637"><span id="cb19-1638"><a href="#cb19-1638" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasTOC } <span class="im">from</span> <span class="st">'/helpers/uiComponents.ojs'</span> </span>
<span id="cb19-1639"><a href="#cb19-1639" aria-hidden="true" tabindex="-1"></a>toc_bottom <span class="op">=</span> {</span>
<span id="cb19-1640"><a href="#cb19-1640" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> nbText <span class="co">// force wait/reload with nbText to load so headings have correct labels/languages</span></span>
<span id="cb19-1641"><a href="#cb19-1641" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">atlasTOC</span>({</span>
<span id="cb19-1642"><a href="#cb19-1642" aria-hidden="true" tabindex="-1"></a>      <span class="dt">heading</span><span class="op">:</span> <span class="vs">`&lt;b&gt;</span><span class="sc">${</span><span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span><span class="st">"In this notebook"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span><span class="st">"Dans ce notebook"</span>})<span class="sc">}</span><span class="vs">&lt;/b&gt;`</span><span class="op">,</span></span>
<span id="cb19-1643"><a href="#cb19-1643" aria-hidden="true" tabindex="-1"></a>      <span class="dt">skip</span><span class="op">:</span> [nbTitle<span class="op">,</span> <span class="st">"notebook-title"</span><span class="op">,</span> <span class="st">"Appendix"</span><span class="op">,</span> <span class="st">"source-code"</span>]</span>
<span id="cb19-1644"><a href="#cb19-1644" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb19-1645"><a href="#cb19-1645" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-1646"><a href="#cb19-1646" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-1647"><a href="#cb19-1647" aria-hidden="true" tabindex="-1"></a>htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb19-1648"><a href="#cb19-1648" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class='floating-toc'&gt;</span></span>
<span id="cb19-1649"><a href="#cb19-1649" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>toc_bottom<span class="sc">}</span></span>
<span id="cb19-1650"><a href="#cb19-1650" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-19-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-19-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-19-3" data-nodetype="expression"></div></div></div></div></section></section><section id="source-code" class="level1 hidden"><h1 class="hidden">Source code</h1><section id="text-translations-and-language-support" class="level2"><h2 data-anchor-id="text-translations-and-language-support">Text translations and language support</h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb20" data-startfrom="1658" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1657"><span id="cb20-1658"><a href="#cb20-1658" aria-hidden="true" tabindex="-1"></a>nbTitle <span class="op">=</span> <span class="fu">_lang</span>({ <span class="dt">en</span><span class="op">:</span> <span class="st">"Discover Solutions"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Dcouvrir des solutions"</span> })<span class="op">;</span></span>
<span id="cb20-1659"><a href="#cb20-1659" aria-hidden="true" tabindex="-1"></a><span class="co">// h1</span></span>
<span id="cb20-1660"><a href="#cb20-1660" aria-hidden="true" tabindex="-1"></a>Overview <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1661"><a href="#cb20-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1662"><a href="#cb20-1662" aria-hidden="true" tabindex="-1"></a>Interventions <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">interventions</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1663"><a href="#cb20-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1664"><a href="#cb20-1664" aria-hidden="true" tabindex="-1"></a>PracticalImpact <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiff</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1665"><a href="#cb20-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1666"><a href="#cb20-1666" aria-hidden="true" tabindex="-1"></a>Risks <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">risks</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1667"><a href="#cb20-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1668"><a href="#cb20-1668" aria-hidden="true" tabindex="-1"></a>Factors <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adoptionFactors</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1669"><a href="#cb20-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1670"><a href="#cb20-1670" aria-hidden="true" tabindex="-1"></a>Summary <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1671"><a href="#cb20-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1672"><a href="#cb20-1672" aria-hidden="true" tabindex="-1"></a>Methods <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h1</span>)<span class="op">;</span></span>
<span id="cb20-1673"><a href="#cb20-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1674"><a href="#cb20-1674" aria-hidden="true" tabindex="-1"></a><span class="co">// h2</span></span>
<span id="cb20-1675"><a href="#cb20-1675" aria-hidden="true" tabindex="-1"></a>crop_diff <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiff</span><span class="op">.</span><span class="at">h2</span><span class="op">.</span><span class="at">meanDiff</span>)<span class="op">;</span></span>
<span id="cb20-1676"><a href="#cb20-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1677"><a href="#cb20-1677" aria-hidden="true" tabindex="-1"></a>crop_diff_aez <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">h2</span>)<span class="op">;</span></span>
<span id="cb20-1678"><a href="#cb20-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1679"><a href="#cb20-1679" aria-hidden="true" tabindex="-1"></a>aez_dif <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">practicalImpact</span><span class="op">.</span><span class="at">meanCropDiffAEZ</span><span class="op">.</span><span class="at">h2</span>)<span class="op">;</span></span>
<span id="cb20-1680"><a href="#cb20-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1681"><a href="#cb20-1681" aria-hidden="true" tabindex="-1"></a>data_sources <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h2DataSources</span>)<span class="op">;</span></span>
<span id="cb20-1682"><a href="#cb20-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1683"><a href="#cb20-1683" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methodsSources</span><span class="op">.</span><span class="at">h2Methods</span>)<span class="op">;</span></span>
<span id="cb20-1684"><a href="#cb20-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1685"><a href="#cb20-1685" aria-hidden="true" tabindex="-1"></a>quickInsight <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">supportNbText</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">quickInsights</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-4" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-5" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-6" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-7" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-8" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-9" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-10" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-11" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-12" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-13" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-20-14" data-nodetype="declaration"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb21" data-startfrom="1689" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1688"><span id="cb21-1689"><a href="#cb21-1689" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {nbText} <span class="im">from</span> <span class="st">"/data/DiscoverSolutions/nbText.ojs"</span></span>
<span id="cb21-1690"><a href="#cb21-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1691"><a href="#cb21-1691" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {lang <span class="im">as</span> Lang } <span class="im">from</span> <span class="st">"/helpers/lang.js"</span></span>
<span id="cb21-1692"><a href="#cb21-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1693"><a href="#cb21-1693" aria-hidden="true" tabindex="-1"></a>_lang <span class="op">=</span> <span class="cf">await</span> Lang<span class="op">.</span><span class="fu">lg</span>(language<span class="op">.</span><span class="at">key</span>)</span>
<span id="cb21-1694"><a href="#cb21-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1695"><a href="#cb21-1695" aria-hidden="true" tabindex="-1"></a>defaultLangKey <span class="op">=</span> {</span>
<span id="cb21-1696"><a href="#cb21-1696" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> list <span class="op">=</span> languages<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span>)<span class="op">;</span></span>
<span id="cb21-1697"><a href="#cb21-1697" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> defaultKey <span class="op">=</span> <span class="st">"en"</span><span class="op">;</span></span>
<span id="cb21-1698"><a href="#cb21-1698" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> queryParam <span class="op">=</span> <span class="cf">await</span> Lang<span class="op">.</span><span class="fu">getParamFromList</span>({ <span class="dt">name</span><span class="op">:</span> <span class="st">"lang"</span><span class="op">,</span> list })<span class="op">;</span></span>
<span id="cb21-1699"><a href="#cb21-1699" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> queryParam <span class="op">??</span> defaultKey<span class="op">;</span></span>
<span id="cb21-1700"><a href="#cb21-1700" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-1701"><a href="#cb21-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1702"><a href="#cb21-1702" aria-hidden="true" tabindex="-1"></a>languages <span class="op">=</span> [</span>
<span id="cb21-1703"><a href="#cb21-1703" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"en"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"English"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">'en-US'</span> }<span class="op">,</span></span>
<span id="cb21-1704"><a href="#cb21-1704" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"fr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Franais"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">'fr-FR'</span> }</span>
<span id="cb21-1705"><a href="#cb21-1705" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb21-1706"><a href="#cb21-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1707"><a href="#cb21-1707" aria-hidden="true" tabindex="-1"></a>viewof language <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb21-1708"><a href="#cb21-1708" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Main language toggle"</span><span class="op">,</span></span>
<span id="cb21-1709"><a href="#cb21-1709" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span><span class="op">,</span></span>
<span id="cb21-1710"><a href="#cb21-1710" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> languages<span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> defaultLangKey)<span class="op">,</span></span>
<span id="cb21-1711"><a href="#cb21-1711" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-1712"><a href="#cb21-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1713"><a href="#cb21-1713" aria-hidden="true" tabindex="-1"></a><span class="co">// data translation values</span></span>
<span id="cb21-1714"><a href="#cb21-1714" aria-hidden="true" tabindex="-1"></a>td <span class="op">=</span> {</span>
<span id="cb21-1715"><a href="#cb21-1715" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/translation_v2@1.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb21-1716"><a href="#cb21-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1717"><a href="#cb21-1717" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Additions */</span></span>
<span id="cb21-1718"><a href="#cb21-1718" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="at">practices</span><span class="op">.</span><span class="at">values</span>[<span class="st">"All practices"</span>] <span class="op">=</span> {</span>
<span id="cb21-1719"><a href="#cb21-1719" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="st">"All practices"</span><span class="op">,</span></span>
<span id="cb21-1720"><a href="#cb21-1720" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="st">"Toutes les pratiques"</span></span>
<span id="cb21-1721"><a href="#cb21-1721" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-1722"><a href="#cb21-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1723"><a href="#cb21-1723" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="at">summarySystems</span> <span class="op">=</span> {</span>
<span id="cb21-1724"><a href="#cb21-1724" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="st">"system"</span><span class="op">,</span></span>
<span id="cb21-1725"><a href="#cb21-1725" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="st">"systme"</span><span class="op">,</span></span>
<span id="cb21-1726"><a href="#cb21-1726" aria-hidden="true" tabindex="-1"></a>    <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb21-1727"><a href="#cb21-1727" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Agroforesty</span><span class="op">:</span> {</span>
<span id="cb21-1728"><a href="#cb21-1728" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Agroforestry"</span><span class="op">,</span></span>
<span id="cb21-1729"><a href="#cb21-1729" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Agroforestire"</span></span>
<span id="cb21-1730"><a href="#cb21-1730" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1731"><a href="#cb21-1731" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cereal-based"</span><span class="op">:</span> {</span>
<span id="cb21-1732"><a href="#cb21-1732" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Cereal-based"</span><span class="op">,</span></span>
<span id="cb21-1733"><a href="#cb21-1733" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">" base de crales"</span></span>
<span id="cb21-1734"><a href="#cb21-1734" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1735"><a href="#cb21-1735" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cereal-based, Rice-based"</span><span class="op">:</span> {</span>
<span id="cb21-1736"><a href="#cb21-1736" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Cereal-based, Rice-based"</span><span class="op">,</span></span>
<span id="cb21-1737"><a href="#cb21-1737" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">" base de crales,  base de riz"</span></span>
<span id="cb21-1738"><a href="#cb21-1738" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1739"><a href="#cb21-1739" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Maize, Napier grass, Desmodium legume"</span><span class="op">:</span> {</span>
<span id="cb21-1740"><a href="#cb21-1740" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Maize, Napier grass, Desmodium legume"</span><span class="op">,</span></span>
<span id="cb21-1741"><a href="#cb21-1741" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mas, herbe Napier, lgumineuse Desmodium"</span></span>
<span id="cb21-1742"><a href="#cb21-1742" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1743"><a href="#cb21-1743" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Maize, Other"</span><span class="op">:</span> {</span>
<span id="cb21-1744"><a href="#cb21-1744" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Maize, Other"</span><span class="op">,</span></span>
<span id="cb21-1745"><a href="#cb21-1745" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mas, autre"</span></span>
<span id="cb21-1746"><a href="#cb21-1746" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1747"><a href="#cb21-1747" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Rice-based"</span><span class="op">:</span> {</span>
<span id="cb21-1748"><a href="#cb21-1748" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Rice-based"</span><span class="op">,</span></span>
<span id="cb21-1749"><a href="#cb21-1749" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">" base de riz"</span></span>
<span id="cb21-1750"><a href="#cb21-1750" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1751"><a href="#cb21-1751" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Unspecified</span><span class="op">:</span> {</span>
<span id="cb21-1752"><a href="#cb21-1752" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Unspecified"</span><span class="op">,</span></span>
<span id="cb21-1753"><a href="#cb21-1753" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Non spcifi"</span></span>
<span id="cb21-1754"><a href="#cb21-1754" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1755"><a href="#cb21-1755" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Vegetables, Fruits, Rice"</span><span class="op">:</span> {</span>
<span id="cb21-1756"><a href="#cb21-1756" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Vegetables, Fruits, Rice"</span><span class="op">,</span></span>
<span id="cb21-1757"><a href="#cb21-1757" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Lgumes, Fruits, Riz"</span></span>
<span id="cb21-1758"><a href="#cb21-1758" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-1759"><a href="#cb21-1759" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1760"><a href="#cb21-1760" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-1761"><a href="#cb21-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1762"><a href="#cb21-1762" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="at">summaryPractices</span> <span class="op">=</span> {</span>
<span id="cb21-1763"><a href="#cb21-1763" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="st">"Practice"</span><span class="op">,</span></span>
<span id="cb21-1764"><a href="#cb21-1764" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pratique"</span><span class="op">,</span></span>
<span id="cb21-1765"><a href="#cb21-1765" aria-hidden="true" tabindex="-1"></a>    <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb21-1766"><a href="#cb21-1766" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Agroforestry Fallow"</span><span class="op">:</span> {</span>
<span id="cb21-1767"><a href="#cb21-1767" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Agroforestry Fallow"</span><span class="op">,</span></span>
<span id="cb21-1768"><a href="#cb21-1768" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jachre agroforestire"</span></span>
<span id="cb21-1769"><a href="#cb21-1769" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1770"><a href="#cb21-1770" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Agroforestry Pruning"</span><span class="op">:</span> {</span>
<span id="cb21-1771"><a href="#cb21-1771" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Agroforestry Pruning"</span><span class="op">,</span></span>
<span id="cb21-1772"><a href="#cb21-1772" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Taille agroforestire"</span></span>
<span id="cb21-1773"><a href="#cb21-1773" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1774"><a href="#cb21-1774" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Alleycropping</span><span class="op">:</span> {</span>
<span id="cb21-1775"><a href="#cb21-1775" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Alleycropping"</span><span class="op">,</span></span>
<span id="cb21-1776"><a href="#cb21-1776" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Culture en alles"</span></span>
<span id="cb21-1777"><a href="#cb21-1777" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1778"><a href="#cb21-1778" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Biochar</span><span class="op">:</span> {</span>
<span id="cb21-1779"><a href="#cb21-1779" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Biochar"</span><span class="op">,</span></span>
<span id="cb21-1780"><a href="#cb21-1780" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Biochar"</span></span>
<span id="cb21-1781"><a href="#cb21-1781" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1782"><a href="#cb21-1782" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Boundary Planting"</span><span class="op">:</span> {</span>
<span id="cb21-1783"><a href="#cb21-1783" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Boundary Planting"</span><span class="op">,</span></span>
<span id="cb21-1784"><a href="#cb21-1784" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Plantation en bordure"</span></span>
<span id="cb21-1785"><a href="#cb21-1785" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1786"><a href="#cb21-1786" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Composting</span><span class="op">:</span> {</span>
<span id="cb21-1787"><a href="#cb21-1787" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Composting"</span><span class="op">,</span></span>
<span id="cb21-1788"><a href="#cb21-1788" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Compostage"</span></span>
<span id="cb21-1789"><a href="#cb21-1789" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1790"><a href="#cb21-1790" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Crop Residue Incorporation"</span><span class="op">:</span> {</span>
<span id="cb21-1791"><a href="#cb21-1791" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop Residue Incorporation"</span><span class="op">,</span></span>
<span id="cb21-1792"><a href="#cb21-1792" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Incorporation des rsidus de rcolte"</span></span>
<span id="cb21-1793"><a href="#cb21-1793" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1794"><a href="#cb21-1794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Crop Residue Management"</span><span class="op">:</span> {</span>
<span id="cb21-1795"><a href="#cb21-1795" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop Residue Management"</span><span class="op">,</span></span>
<span id="cb21-1796"><a href="#cb21-1796" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gestion des rsidus de rcolte"</span></span>
<span id="cb21-1797"><a href="#cb21-1797" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1798"><a href="#cb21-1798" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Crop Rotation"</span><span class="op">:</span> {</span>
<span id="cb21-1799"><a href="#cb21-1799" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop Rotation"</span><span class="op">,</span></span>
<span id="cb21-1800"><a href="#cb21-1800" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rotation des cultures"</span></span>
<span id="cb21-1801"><a href="#cb21-1801" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1802"><a href="#cb21-1802" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Deficit Irrigation"</span><span class="op">:</span> {</span>
<span id="cb21-1803"><a href="#cb21-1803" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Deficit Irrigation"</span><span class="op">,</span></span>
<span id="cb21-1804"><a href="#cb21-1804" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Irrigation dficitaire"</span></span>
<span id="cb21-1805"><a href="#cb21-1805" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1806"><a href="#cb21-1806" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Green Manure"</span><span class="op">:</span> {</span>
<span id="cb21-1807"><a href="#cb21-1807" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Green Manure"</span><span class="op">,</span></span>
<span id="cb21-1808"><a href="#cb21-1808" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Engrais vert"</span></span>
<span id="cb21-1809"><a href="#cb21-1809" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1810"><a href="#cb21-1810" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Improved Fallows"</span><span class="op">:</span> {</span>
<span id="cb21-1811"><a href="#cb21-1811" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Improved Fallows"</span><span class="op">,</span></span>
<span id="cb21-1812"><a href="#cb21-1812" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jachres amliores"</span></span>
<span id="cb21-1813"><a href="#cb21-1813" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1814"><a href="#cb21-1814" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Improved Varieties"</span><span class="op">:</span> {</span>
<span id="cb21-1815"><a href="#cb21-1815" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Improved Varieties"</span><span class="op">,</span></span>
<span id="cb21-1816"><a href="#cb21-1816" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Varits amliores"</span></span>
<span id="cb21-1817"><a href="#cb21-1817" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1818"><a href="#cb21-1818" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Inorganic Fertilizer"</span><span class="op">:</span> {</span>
<span id="cb21-1819"><a href="#cb21-1819" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Inorganic Fertilizer"</span><span class="op">,</span></span>
<span id="cb21-1820"><a href="#cb21-1820" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Engrais inorganique"</span></span>
<span id="cb21-1821"><a href="#cb21-1821" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1822"><a href="#cb21-1822" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Intercropping</span><span class="op">:</span> {</span>
<span id="cb21-1823"><a href="#cb21-1823" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Intercropping"</span><span class="op">,</span></span>
<span id="cb21-1824"><a href="#cb21-1824" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Culture intercalaire"</span></span>
<span id="cb21-1825"><a href="#cb21-1825" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1826"><a href="#cb21-1826" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mulching</span><span class="op">:</span> {</span>
<span id="cb21-1827"><a href="#cb21-1827" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mulching"</span><span class="op">,</span></span>
<span id="cb21-1828"><a href="#cb21-1828" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Paillage"</span></span>
<span id="cb21-1829"><a href="#cb21-1829" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1830"><a href="#cb21-1830" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Organic Fertilizer"</span><span class="op">:</span> {</span>
<span id="cb21-1831"><a href="#cb21-1831" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Organic Fertilizer"</span><span class="op">,</span></span>
<span id="cb21-1832"><a href="#cb21-1832" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Engrais organique"</span></span>
<span id="cb21-1833"><a href="#cb21-1833" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1834"><a href="#cb21-1834" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Other Agroforestry"</span><span class="op">:</span> {</span>
<span id="cb21-1835"><a href="#cb21-1835" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Other Agroforestry"</span><span class="op">,</span></span>
<span id="cb21-1836"><a href="#cb21-1836" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Autre agroforestire"</span></span>
<span id="cb21-1837"><a href="#cb21-1837" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1838"><a href="#cb21-1838" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Parklands</span><span class="op">:</span> {</span>
<span id="cb21-1839"><a href="#cb21-1839" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Parklands"</span><span class="op">,</span></span>
<span id="cb21-1840"><a href="#cb21-1840" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Parcs agroforestiers"</span></span>
<span id="cb21-1841"><a href="#cb21-1841" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1842"><a href="#cb21-1842" aria-hidden="true" tabindex="-1"></a>      <span class="st">"pH Control"</span><span class="op">:</span> {</span>
<span id="cb21-1843"><a href="#cb21-1843" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"pH Control"</span><span class="op">,</span></span>
<span id="cb21-1844"><a href="#cb21-1844" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Contrle du pH"</span></span>
<span id="cb21-1845"><a href="#cb21-1845" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1846"><a href="#cb21-1846" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Silvopasture</span><span class="op">:</span> {</span>
<span id="cb21-1847"><a href="#cb21-1847" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Silvopasture"</span><span class="op">,</span></span>
<span id="cb21-1848"><a href="#cb21-1848" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sylvopastoralisme"</span></span>
<span id="cb21-1849"><a href="#cb21-1849" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1850"><a href="#cb21-1850" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Supplemental Irrigation"</span><span class="op">:</span> {</span>
<span id="cb21-1851"><a href="#cb21-1851" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Supplemental Irrigation"</span><span class="op">,</span></span>
<span id="cb21-1852"><a href="#cb21-1852" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Irrigation supplmentaire"</span></span>
<span id="cb21-1853"><a href="#cb21-1853" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1854"><a href="#cb21-1854" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Tillage Management"</span><span class="op">:</span> {</span>
<span id="cb21-1855"><a href="#cb21-1855" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Tillage Management"</span><span class="op">,</span></span>
<span id="cb21-1856"><a href="#cb21-1856" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gestion du travail du sol"</span></span>
<span id="cb21-1857"><a href="#cb21-1857" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1858"><a href="#cb21-1858" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Water Harvesting"</span><span class="op">:</span> {</span>
<span id="cb21-1859"><a href="#cb21-1859" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Water Harvesting"</span><span class="op">,</span></span>
<span id="cb21-1860"><a href="#cb21-1860" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Collecte des eaux"</span></span>
<span id="cb21-1861"><a href="#cb21-1861" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-1862"><a href="#cb21-1862" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1863"><a href="#cb21-1863" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-1864"><a href="#cb21-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1865"><a href="#cb21-1865" aria-hidden="true" tabindex="-1"></a>  <span class="co">// adoption factors, with articles</span></span>
<span id="cb21-1866"><a href="#cb21-1866" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="at">adoption_factors_with_articles</span> <span class="op">=</span> {</span>
<span id="cb21-1867"><a href="#cb21-1867" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="st">"adoption_factors"</span><span class="op">,</span></span>
<span id="cb21-1868"><a href="#cb21-1868" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="st">"facteurs_dadoption"</span><span class="op">,</span></span>
<span id="cb21-1869"><a href="#cb21-1869" aria-hidden="true" tabindex="-1"></a>    <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb21-1870"><a href="#cb21-1870" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Access to credit"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Access to credit"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L'Accs au crdit"</span> }<span class="op">,</span></span>
<span id="cb21-1871"><a href="#cb21-1871" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Access to information"</span><span class="op">:</span> {</span>
<span id="cb21-1872"><a href="#cb21-1872" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Access to information"</span><span class="op">,</span></span>
<span id="cb21-1873"><a href="#cb21-1873" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"L'Accs  l'information"</span></span>
<span id="cb21-1874"><a href="#cb21-1874" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1875"><a href="#cb21-1875" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Availability of labor"</span><span class="op">:</span> {</span>
<span id="cb21-1876"><a href="#cb21-1876" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Availability of labor"</span><span class="op">,</span></span>
<span id="cb21-1877"><a href="#cb21-1877" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Disponibilit de la main-d'uvre"</span></span>
<span id="cb21-1878"><a href="#cb21-1878" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1879"><a href="#cb21-1879" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Biophyiscal factors"</span><span class="op">:</span> {</span>
<span id="cb21-1880"><a href="#cb21-1880" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Biophyiscal factors"</span><span class="op">,</span></span>
<span id="cb21-1881"><a href="#cb21-1881" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les Facteurs biophysiques"</span></span>
<span id="cb21-1882"><a href="#cb21-1882" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1883"><a href="#cb21-1883" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Changes in weather"</span><span class="op">:</span> {</span>
<span id="cb21-1884"><a href="#cb21-1884" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Changes in weather"</span><span class="op">,</span></span>
<span id="cb21-1885"><a href="#cb21-1885" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les Changements climatiques"</span></span>
<span id="cb21-1886"><a href="#cb21-1886" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1887"><a href="#cb21-1887" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Distance to market"</span><span class="op">:</span> {</span>
<span id="cb21-1888"><a href="#cb21-1888" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Distance to market"</span><span class="op">,</span></span>
<span id="cb21-1889"><a href="#cb21-1889" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Distance au march"</span></span>
<span id="cb21-1890"><a href="#cb21-1890" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1891"><a href="#cb21-1891" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Exposure to risks and shocks"</span><span class="op">:</span> {</span>
<span id="cb21-1892"><a href="#cb21-1892" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure to risks and shocks"</span><span class="op">,</span></span>
<span id="cb21-1893"><a href="#cb21-1893" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"L'Exposition aux risques et chocs"</span></span>
<span id="cb21-1894"><a href="#cb21-1894" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1895"><a href="#cb21-1895" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Other</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Other"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Autre"</span> }<span class="op">,</span></span>
<span id="cb21-1896"><a href="#cb21-1896" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Resource endowments"</span><span class="op">:</span> {</span>
<span id="cb21-1897"><a href="#cb21-1897" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Resource endowments"</span><span class="op">,</span></span>
<span id="cb21-1898"><a href="#cb21-1898" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Dotation en ressources"</span></span>
<span id="cb21-1899"><a href="#cb21-1899" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1900"><a href="#cb21-1900" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Secure tenure"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Secure tenure"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Tenure scurise"</span> }<span class="op">,</span></span>
<span id="cb21-1901"><a href="#cb21-1901" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Social capital"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Social capital"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Capital social"</span> }<span class="op">,</span></span>
<span id="cb21-1902"><a href="#cb21-1902" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Socio-demographics"</span><span class="op">:</span> {</span>
<span id="cb21-1903"><a href="#cb21-1903" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Socio-demographics"</span><span class="op">,</span></span>
<span id="cb21-1904"><a href="#cb21-1904" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Socio-dmographie"</span></span>
<span id="cb21-1905"><a href="#cb21-1905" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-1906"><a href="#cb21-1906" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1907"><a href="#cb21-1907" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-1908"><a href="#cb21-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1909"><a href="#cb21-1909" aria-hidden="true" tabindex="-1"></a>  <span class="co">// crop articles</span></span>
<span id="cb21-1910"><a href="#cb21-1910" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="at">Crop_with_articles</span> <span class="op">=</span> {</span>
<span id="cb21-1911"><a href="#cb21-1911" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="st">"crop_with_articles"</span><span class="op">,</span></span>
<span id="cb21-1912"><a href="#cb21-1912" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="st">"crop_with_articles"</span><span class="op">,</span></span>
<span id="cb21-1913"><a href="#cb21-1913" aria-hidden="true" tabindex="-1"></a>    <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb21-1914"><a href="#cb21-1914" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Maize</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"maize"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le mas"</span> }<span class="op">,</span></span>
<span id="cb21-1915"><a href="#cb21-1915" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rice</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"rice"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le riz"</span> }<span class="op">,</span></span>
<span id="cb21-1916"><a href="#cb21-1916" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pearl Millet"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"pearl millet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le millet perl"</span> }<span class="op">,</span></span>
<span id="cb21-1917"><a href="#cb21-1917" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sorghum</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"sorghum"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le sorgho"</span> }<span class="op">,</span></span>
<span id="cb21-1918"><a href="#cb21-1918" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cowpea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"cowpea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le nib"</span> }<span class="op">,</span></span>
<span id="cb21-1919"><a href="#cb21-1919" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Common Bean"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"common bean"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le haricot commun"</span> }<span class="op">,</span></span>
<span id="cb21-1920"><a href="#cb21-1920" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Soybean</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"soybean"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le soja"</span> }<span class="op">,</span></span>
<span id="cb21-1921"><a href="#cb21-1921" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cassava</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"cassava"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le manioc"</span> }<span class="op">,</span></span>
<span id="cb21-1922"><a href="#cb21-1922" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Groundnut</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"groundnut"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"l'arachide"</span> }<span class="op">,</span></span>
<span id="cb21-1923"><a href="#cb21-1923" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Wheat</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"wheat"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le bl"</span> }<span class="op">,</span></span>
<span id="cb21-1924"><a href="#cb21-1924" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Yam</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"yam"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"l'igname"</span> }<span class="op">,</span></span>
<span id="cb21-1925"><a href="#cb21-1925" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cotton</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"cotton"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"coton"</span> }<span class="op">,</span></span>
<span id="cb21-1926"><a href="#cb21-1926" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Teff</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"teff"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le teff"</span> }<span class="op">,</span></span>
<span id="cb21-1927"><a href="#cb21-1927" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Tomato</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"tomato"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"la tomate"</span> }<span class="op">,</span></span>
<span id="cb21-1928"><a href="#cb21-1928" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Potato</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"potato"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"la pomme de terre"</span> }<span class="op">,</span></span>
<span id="cb21-1929"><a href="#cb21-1929" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sugar Cane"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"sugar cane"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"la canne  sucre"</span> }<span class="op">,</span></span>
<span id="cb21-1930"><a href="#cb21-1930" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pigeon Pea"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"pigeon pea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le pois cajan"</span> }<span class="op">,</span></span>
<span id="cb21-1931"><a href="#cb21-1931" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Chickpea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"chickpea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le pois chiche"</span> }<span class="op">,</span></span>
<span id="cb21-1932"><a href="#cb21-1932" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Okra</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"okra"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le gombo"</span> }<span class="op">,</span></span>
<span id="cb21-1933"><a href="#cb21-1933" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sweet Potato"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"sweet potato"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"la patate douce"</span> }<span class="op">,</span></span>
<span id="cb21-1934"><a href="#cb21-1934" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Fodder Legume"</span><span class="op">:</span> {</span>
<span id="cb21-1935"><a href="#cb21-1935" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"fodder legume"</span><span class="op">,</span></span>
<span id="cb21-1936"><a href="#cb21-1936" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"la lgumineuse fourragre"</span></span>
<span id="cb21-1937"><a href="#cb21-1937" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1938"><a href="#cb21-1938" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Barley</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"barley"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"l'orge"</span> }<span class="op">,</span></span>
<span id="cb21-1939"><a href="#cb21-1939" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Olive</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"olive"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"l'olive"</span> }<span class="op">,</span></span>
<span id="cb21-1940"><a href="#cb21-1940" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cabbage</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"cabbage"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le chou"</span> }<span class="op">,</span></span>
<span id="cb21-1941"><a href="#cb21-1941" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Banana Sweet"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"banana sweet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"la banane douce"</span> }<span class="op">,</span></span>
<span id="cb21-1942"><a href="#cb21-1942" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rape</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"rape"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le colza"</span> }<span class="op">,</span></span>
<span id="cb21-1943"><a href="#cb21-1943" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sunflower</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"sunflower"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le tournesol"</span> }<span class="op">,</span></span>
<span id="cb21-1944"><a href="#cb21-1944" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cooking Banana"</span><span class="op">:</span> {</span>
<span id="cb21-1945"><a href="#cb21-1945" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"cooking banana"</span><span class="op">,</span></span>
<span id="cb21-1946"><a href="#cb21-1946" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"la banane de cuisine"</span></span>
<span id="cb21-1947"><a href="#cb21-1947" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-1948"><a href="#cb21-1948" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sesame</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"sesame"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"le ssame"</span> }</span>
<span id="cb21-1949"><a href="#cb21-1949" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1950"><a href="#cb21-1950" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb21-1951"><a href="#cb21-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1952"><a href="#cb21-1952" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb21-1953"><a href="#cb21-1953" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-4" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-5" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-6" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-21-7" data-nodetype="declaration"></div></div></div></div></section><section id="formatting-functions" class="level2"><h2 data-anchor-id="formatting-functions">Formatting functions</h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb22" data-startfrom="1960" data-source-offset="-32"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1959"><span id="cb22-1960"><a href="#cb22-1960" aria-hidden="true" tabindex="-1"></a>formatNumCompactLong <span class="op">=</span> <span class="kw">function</span> (number<span class="op">,</span> { locale <span class="op">=</span> <span class="st">"en-US"</span> } <span class="op">=</span> {}) {</span>
<span id="cb22-1961"><a href="#cb22-1961" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(locale<span class="op">,</span> {</span>
<span id="cb22-1962"><a href="#cb22-1962" aria-hidden="true" tabindex="-1"></a>    <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb22-1963"><a href="#cb22-1963" aria-hidden="true" tabindex="-1"></a>    <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb22-1964"><a href="#cb22-1964" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unitDisplay</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb22-1965"><a href="#cb22-1965" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">format</span>(number)<span class="op">;</span></span>
<span id="cb22-1966"><a href="#cb22-1966" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb22-1967"><a href="#cb22-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1968"><a href="#cb22-1968" aria-hidden="true" tabindex="-1"></a>formatNumStandard <span class="op">=</span> <span class="kw">function</span> (number<span class="op">,</span> { locale <span class="op">=</span> <span class="st">"en-US"</span> } <span class="op">=</span> {}) {</span>
<span id="cb22-1969"><a href="#cb22-1969" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(locale<span class="op">,</span> {})<span class="op">.</span><span class="fu">format</span>(number)<span class="op">;</span></span>
<span id="cb22-1970"><a href="#cb22-1970" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb22-1971"><a href="#cb22-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1972"><a href="#cb22-1972" aria-hidden="true" tabindex="-1"></a><span class="co">// format number, 2 decimal places</span></span>
<span id="cb22-1973"><a href="#cb22-1973" aria-hidden="true" tabindex="-1"></a>formatNum <span class="op">=</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".2f"</span>)<span class="op">;</span></span>
<span id="cb22-1974"><a href="#cb22-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1975"><a href="#cb22-1975" aria-hidden="true" tabindex="-1"></a>formatComma <span class="op">=</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">","</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-22-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-22-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-22-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-22-4" data-nodetype="declaration"></div></div></div></div></section><section id="import-data-helpers" class="level2"><h2 data-anchor-id="import-data-helpers">import data helpers</h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb23" data-startfrom="1982" data-source-offset="-50"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1981"><span id="cb23-1982"><a href="#cb23-1982" aria-hidden="true" tabindex="-1"></a>parseBool <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb23-1983"><a href="#cb23-1983" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="op">===</span> <span class="st">"TRUE"</span>) <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb23-1984"><a href="#cb23-1984" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="op">===</span> <span class="st">"FALSE"</span>) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb23-1985"><a href="#cb23-1985" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb23-1986"><a href="#cb23-1986" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb23-1987"><a href="#cb23-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1988"><a href="#cb23-1988" aria-hidden="true" tabindex="-1"></a><span class="co">// Parsing numbers, blank strings as NaN's</span></span>
<span id="cb23-1989"><a href="#cb23-1989" aria-hidden="true" tabindex="-1"></a>parseNum <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb23-1990"><a href="#cb23-1990" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="kw">typeof</span> d <span class="op">===</span> <span class="st">"number"</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="pp">isNaN</span>(d)) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb23-1991"><a href="#cb23-1991" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d<span class="op">.</span><span class="fu">trim</span>() <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">NaN</span> <span class="op">:</span> <span class="op">+</span>d<span class="op">;</span></span>
<span id="cb23-1992"><a href="#cb23-1992" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-23-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-23-2" data-nodetype="declaration"></div></div></div></div></section><section id="style-things" class="level2"><h2 data-anchor-id="style-things">Style things</h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb24" data-startfrom="1998" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1997"><span id="cb24-1998"><a href="#cb24-1998" aria-hidden="true" tabindex="-1"></a>colorYellowGreen <span class="op">=</span> [<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#216729"</span>]</span>
<span id="cb24-1999"><a href="#cb24-1999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2000"><a href="#cb24-2000" aria-hidden="true" tabindex="-1"></a><span class="co">// aez color scale</span></span>
<span id="cb24-2001"><a href="#cb24-2001" aria-hidden="true" tabindex="-1"></a>aezColor_new <span class="op">=</span> {</span>
<span id="cb24-2002"><a href="#cb24-2002" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> lookupAEZ <span class="op">=</span> (aez) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">AEZ_Class_FAO</span><span class="op">.</span><span class="at">values</span>[aez])</span>
<span id="cb24-2003"><a href="#cb24-2003" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb24-2004"><a href="#cb24-2004" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [</span>
<span id="cb24-2005"><a href="#cb24-2005" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">'Desert/Arid climate'</span>)<span class="op">,</span></span>
<span id="cb24-2006"><a href="#cb24-2006" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, highland; semi-arid"</span>)<span class="op">,</span></span>
<span id="cb24-2007"><a href="#cb24-2007" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, lowland; semi-arid"</span>)<span class="op">,</span></span>
<span id="cb24-2008"><a href="#cb24-2008" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Subtropics, moderately cool; sub-humid"</span>)<span class="op">,</span></span>
<span id="cb24-2009"><a href="#cb24-2009" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, highland; sub-humid"</span>)<span class="op">,</span></span>
<span id="cb24-2010"><a href="#cb24-2010" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, lowland; sub-humid"</span>)<span class="op">,</span></span>
<span id="cb24-2011"><a href="#cb24-2011" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, highland; humid"</span>)<span class="op">,</span></span>
<span id="cb24-2012"><a href="#cb24-2012" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Tropics, lowland; humid"</span>)<span class="op">,</span></span>
<span id="cb24-2013"><a href="#cb24-2013" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Land with ample irrigated soils"</span>)<span class="op">,</span></span>
<span id="cb24-2014"><a href="#cb24-2014" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Severe soil/terrain limitations"</span>)<span class="op">,</span></span>
<span id="cb24-2015"><a href="#cb24-2015" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lookupAEZ</span>(<span class="st">"Dominantly urban/built-up land"</span>)<span class="op">,</span></span>
<span id="cb24-2016"><a href="#cb24-2016" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb24-2017"><a href="#cb24-2017" aria-hidden="true" tabindex="-1"></a>    <span class="dt">range</span><span class="op">:</span> [</span>
<span id="cb24-2018"><a href="#cb24-2018" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#F3D6B0"</span><span class="op">,</span></span>
<span id="cb24-2019"><a href="#cb24-2019" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#FCA034"</span><span class="op">,</span></span>
<span id="cb24-2020"><a href="#cb24-2020" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#F7D732"</span><span class="op">,</span></span>
<span id="cb24-2021"><a href="#cb24-2021" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#523D4E"</span><span class="op">,</span></span>
<span id="cb24-2022"><a href="#cb24-2022" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#EF6D94"</span><span class="op">,</span></span>
<span id="cb24-2023"><a href="#cb24-2023" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#F9B1C1"</span><span class="op">,</span></span>
<span id="cb24-2024"><a href="#cb24-2024" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#2A79A8"</span><span class="op">,</span></span>
<span id="cb24-2025"><a href="#cb24-2025" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#79A1B7"</span><span class="op">,</span></span>
<span id="cb24-2026"><a href="#cb24-2026" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#74B95A"</span><span class="op">,</span></span>
<span id="cb24-2027"><a href="#cb24-2027" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#2E7637"</span><span class="op">,</span></span>
<span id="cb24-2028"><a href="#cb24-2028" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#B1B1B1"</span></span>
<span id="cb24-2029"><a href="#cb24-2029" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb24-2030"><a href="#cb24-2030" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb24-2031"><a href="#cb24-2031" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-24-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-24-2" data-nodetype="declaration"></div></div></div></div></section><section id="sections" class="level2"><h2 data-anchor-id="sections">Sections</h2><section id="shared-data" class="level3"><h3 data-anchor-id="shared-data">shared data</h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb25" data-startfrom="2040" data-source-offset="-20"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2039"><span id="cb25-2040"><a href="#cb25-2040" aria-hidden="true" tabindex="-1"></a>workbook_meanDifference <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/Mean_yield_difference.xlsx"</span>)<span class="op">.</span><span class="fu">xlsx</span>()</span>
<span id="cb25-2041"><a href="#cb25-2041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2042"><a href="#cb25-2042" aria-hidden="true" tabindex="-1"></a>data_extendedTable2 <span class="op">=</span> {</span>
<span id="cb25-2043"><a href="#cb25-2043" aria-hidden="true" tabindex="-1"></a>  <span class="co">// data from file</span></span>
<span id="cb25-2044"><a href="#cb25-2044" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/spotlight2_Extended Table 2.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()<span class="op">;</span></span>
<span id="cb25-2045"><a href="#cb25-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2046"><a href="#cb25-2046" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return data</span></span>
<span id="cb25-2047"><a href="#cb25-2047" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> file<span class="op">.</span><span class="fu">then</span>((x) <span class="kw">=&gt;</span> {</span>
<span id="cb25-2048"><a href="#cb25-2048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">.</span><span class="fu">map</span>((row) <span class="kw">=&gt;</span> ({</span>
<span id="cb25-2049"><a href="#cb25-2049" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb25-2050"><a href="#cb25-2050" aria-hidden="true" tabindex="-1"></a>      <span class="dt">outcome</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Outcome</span>)<span class="op">,</span></span>
<span id="cb25-2051"><a href="#cb25-2051" aria-hidden="true" tabindex="-1"></a>      <span class="dt">product</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Product</span>)<span class="op">,</span></span>
<span id="cb25-2052"><a href="#cb25-2052" aria-hidden="true" tabindex="-1"></a>      <span class="dt">is_combo</span><span class="op">:</span> <span class="fu">parseBool</span>(row[<span class="st">"Is.Combo"</span>])<span class="op">,</span></span>
<span id="cb25-2053"><a href="#cb25-2053" aria-hidden="true" tabindex="-1"></a>      <span class="dt">observations</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Observations</span>)<span class="op">,</span></span>
<span id="cb25-2054"><a href="#cb25-2054" aria-hidden="true" tabindex="-1"></a>      <span class="dt">studies</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Studies</span>)<span class="op">,</span></span>
<span id="cb25-2055"><a href="#cb25-2055" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Value</span>)<span class="op">,</span></span>
<span id="cb25-2056"><a href="#cb25-2056" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sig</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Sig</span>)<span class="op">,</span></span>
<span id="cb25-2057"><a href="#cb25-2057" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value_se</span><span class="op">:</span> <span class="fu">parseNum</span>(row[<span class="st">"Value.se"</span>])<span class="op">,</span></span>
<span id="cb25-2058"><a href="#cb25-2058" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ci_low</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">CIlow</span>)<span class="op">,</span></span>
<span id="cb25-2059"><a href="#cb25-2059" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ci_high</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">CIhigh</span>)<span class="op">,</span></span>
<span id="cb25-2060"><a href="#cb25-2060" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Source</span>)</span>
<span id="cb25-2061"><a href="#cb25-2061" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb25-2062"><a href="#cb25-2062" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb25-2063"><a href="#cb25-2063" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-25-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-25-2" data-nodetype="declaration"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb26" data-startfrom="2066" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2065"><span id="cb26-2066"><a href="#cb26-2066" aria-hidden="true" tabindex="-1"></a>data_extendedTable2_total <span class="op">=</span> {</span>
<span id="cb26-2067"><a href="#cb26-2067" aria-hidden="true" tabindex="-1"></a>  <span class="co">// data from file</span></span>
<span id="cb26-2068"><a href="#cb26-2068" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/spotlight2_Extended Table 2@1.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()<span class="op">;</span></span>
<span id="cb26-2069"><a href="#cb26-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2070"><a href="#cb26-2070" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return data</span></span>
<span id="cb26-2071"><a href="#cb26-2071" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> file<span class="op">.</span><span class="fu">then</span>((x) <span class="kw">=&gt;</span> {</span>
<span id="cb26-2072"><a href="#cb26-2072" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">.</span><span class="fu">map</span>((row) <span class="kw">=&gt;</span> ({</span>
<span id="cb26-2073"><a href="#cb26-2073" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Practice</span>)<span class="op">,</span></span>
<span id="cb26-2074"><a href="#cb26-2074" aria-hidden="true" tabindex="-1"></a>      <span class="dt">outcome</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Outcome</span>)<span class="op">,</span></span>
<span id="cb26-2075"><a href="#cb26-2075" aria-hidden="true" tabindex="-1"></a>      <span class="dt">product</span><span class="op">:</span> <span class="bu">String</span>(row<span class="op">.</span><span class="at">Product</span>)<span class="op">,</span></span>
<span id="cb26-2076"><a href="#cb26-2076" aria-hidden="true" tabindex="-1"></a>      <span class="co">// is_combo: parseBool(row["Is.Combo"]),</span></span>
<span id="cb26-2077"><a href="#cb26-2077" aria-hidden="true" tabindex="-1"></a>      <span class="dt">observations</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Observations</span>)<span class="op">,</span></span>
<span id="cb26-2078"><a href="#cb26-2078" aria-hidden="true" tabindex="-1"></a>      <span class="dt">studies</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Studies</span>)<span class="op">,</span></span>
<span id="cb26-2079"><a href="#cb26-2079" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Value</span>)<span class="op">,</span></span>
<span id="cb26-2080"><a href="#cb26-2080" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sig</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">Sig</span>)<span class="op">,</span></span>
<span id="cb26-2081"><a href="#cb26-2081" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value_se</span><span class="op">:</span> <span class="fu">parseNum</span>(row[<span class="st">"Value.se"</span>])<span class="op">,</span></span>
<span id="cb26-2082"><a href="#cb26-2082" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ci_low</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">CIlow</span>)<span class="op">,</span></span>
<span id="cb26-2083"><a href="#cb26-2083" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ci_high</span><span class="op">:</span> <span class="fu">parseNum</span>(row<span class="op">.</span><span class="at">CIhigh</span>)<span class="op">,</span></span>
<span id="cb26-2084"><a href="#cb26-2084" aria-hidden="true" tabindex="-1"></a>      <span class="co">// source: String(row.Source)</span></span>
<span id="cb26-2085"><a href="#cb26-2085" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb26-2086"><a href="#cb26-2086" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-2087"><a href="#cb26-2087" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-26" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb27" data-startfrom="2092" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2091"><span id="cb27-2092"><a href="#cb27-2092" aria-hidden="true" tabindex="-1"></a>csaManuals <span class="op">=</span> {</span>
<span id="cb27-2093"><a href="#cb27-2093" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/CSA-Manuals_Sheet1.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()</span>
<span id="cb27-2094"><a href="#cb27-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2095"><a href="#cb27-2095" aria-hidden="true" tabindex="-1"></a>  <span class="co">// parse columns</span></span>
<span id="cb27-2096"><a href="#cb27-2096" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> file<span class="op">.</span><span class="fu">then</span>((x) <span class="kw">=&gt;</span> {</span>
<span id="cb27-2097"><a href="#cb27-2097" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb27-2098"><a href="#cb27-2098" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'Practice'</span>])<span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb27-2099"><a href="#cb27-2099" aria-hidden="true" tabindex="-1"></a>      <span class="dt">country_region</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'Country or Region'</span>])<span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb27-2100"><a href="#cb27-2100" aria-hidden="true" tabindex="-1"></a>      <span class="dt">system</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'System'</span>])<span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb27-2101"><a href="#cb27-2101" aria-hidden="true" tabindex="-1"></a>      <span class="dt">author</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'Author'</span>])<span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb27-2102"><a href="#cb27-2102" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'Title'</span>])<span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb27-2103"><a href="#cb27-2103" aria-hidden="true" tabindex="-1"></a>      <span class="dt">link</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'Link'</span>])<span class="op">.</span><span class="fu">trim</span>()</span>
<span id="cb27-2104"><a href="#cb27-2104" aria-hidden="true" tabindex="-1"></a>    }))</span>
<span id="cb27-2105"><a href="#cb27-2105" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-2106"><a href="#cb27-2106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-2107"><a href="#cb27-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2108"><a href="#cb27-2108" aria-hidden="true" tabindex="-1"></a><span class="co">// selections</span></span>
<span id="cb27-2109"><a href="#cb27-2109" aria-hidden="true" tabindex="-1"></a>csaResourceHtml <span class="op">=</span> {</span>
<span id="cb27-2110"><a href="#cb27-2110" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb27-2111"><a href="#cb27-2111" aria-hidden="true" tabindex="-1"></a>    csaManuals<span class="op">,</span></span>
<span id="cb27-2112"><a href="#cb27-2112" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">practice</span> <span class="op">==</span> selectResourcePractice<span class="op">.</span><span class="at">field</span>)<span class="op">,</span></span>
<span id="cb27-2113"><a href="#cb27-2113" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>([<span class="st">"system"</span><span class="op">,</span> <span class="st">"title"</span>])</span>
<span id="cb27-2114"><a href="#cb27-2114" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb27-2115"><a href="#cb27-2115" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> translateSystem <span class="op">=</span> (d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(td<span class="op">.</span><span class="at">summarySystems</span><span class="op">.</span><span class="at">values</span><span class="op">?.</span>[d])<span class="op">;</span></span>
<span id="cb27-2116"><a href="#cb27-2116" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> systemWord <span class="op">=</span> Lang<span class="op">.</span><span class="fu">toTitleCase</span>(<span class="fu">_lang</span>(td<span class="op">.</span><span class="at">summarySystems</span>))</span>
<span id="cb27-2117"><a href="#cb27-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2118"><a href="#cb27-2118" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> htmlList <span class="op">=</span> data<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb27-2119"><a href="#cb27-2119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> system <span class="op">=</span> <span class="fu">translateSystem</span>(d<span class="op">.</span><span class="at">system</span>)<span class="op">;</span></span>
<span id="cb27-2120"><a href="#cb27-2120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`&lt;li style='padding: 10px 0'&gt;</span><span class="sc">${</span>system<span class="sc">}</span><span class="vs">: &lt;a href=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">link</span><span class="sc">}</span><span class="vs"> target='_blank'&gt;</span><span class="sc">${</span>d<span class="op">.</span><span class="at">title</span><span class="sc">}</span><span class="vs">&lt;/a&gt;&lt;/li&gt;`</span><span class="op">;</span></span>
<span id="cb27-2121"><a href="#cb27-2121" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb27-2122"><a href="#cb27-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2123"><a href="#cb27-2123" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="vs">`&lt;b&gt;</span><span class="sc">${</span>systemWord<span class="sc">}</span><span class="vs">&lt;/b&gt;</span></span>
<span id="cb27-2124"><a href="#cb27-2124" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;ul style='list-style-type:none; padding: 0'&gt;</span><span class="sc">${</span>htmlList<span class="op">.</span><span class="fu">join</span>(</span>
<span id="cb27-2125"><a href="#cb27-2125" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span></span>
<span id="cb27-2126"><a href="#cb27-2126" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">}</span><span class="vs">&lt;/ul&gt;`</span><span class="op">;</span></span>
<span id="cb27-2127"><a href="#cb27-2127" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-27-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-27-2" data-nodetype="declaration"></div></div></div></div></section><section id="practicecrop-dot-plot" class="level3"><h3 data-anchor-id="practicecrop-dot-plot">Practice/Crop dot plot</h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb28" data-startfrom="2133" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2132"><span id="cb28-2133"><a href="#cb28-2133" aria-hidden="true" tabindex="-1"></a>data_meanDiff_practiceCrop <span class="op">=</span> {</span>
<span id="cb28-2134"><a href="#cb28-2134" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> raw <span class="op">=</span> workbook_meanDifference<span class="op">.</span><span class="fu">sheet</span>(<span class="st">"Practice_Crop"</span><span class="op">,</span> { <span class="dt">headers</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb28-2135"><a href="#cb28-2135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> raw<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb28-2136"><a href="#cb28-2136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(d)<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb28-2137"><a href="#cb28-2137" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> meanDiffCropList<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">Crop</span>)</span>
<span id="cb28-2138"><a href="#cb28-2138" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb28-2139"><a href="#cb28-2139" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2140"><a href="#cb28-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2141"><a href="#cb28-2141" aria-hidden="true" tabindex="-1"></a>data_meanDiff_practiceCrop_new <span class="op">=</span> {</span>
<span id="cb28-2142"><a href="#cb28-2142" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> raw <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/figure_2_data@1.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb28-2143"><a href="#cb28-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2144"><a href="#cb28-2144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> raw<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb28-2145"><a href="#cb28-2145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb28-2146"><a href="#cb28-2146" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span> d[<span class="st">'Practice'</span>]<span class="op">,</span></span>
<span id="cb28-2147"><a href="#cb28-2147" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Crop</span><span class="op">:</span> d[<span class="st">'Crop'</span>]<span class="op">,</span></span>
<span id="cb28-2148"><a href="#cb28-2148" aria-hidden="true" tabindex="-1"></a>      <span class="dt">N_Obs</span><span class="op">:</span> d[<span class="st">'N_Obs'</span>]<span class="op">,</span></span>
<span id="cb28-2149"><a href="#cb28-2149" aria-hidden="true" tabindex="-1"></a>      <span class="dt">N_Pub</span><span class="op">:</span> d[<span class="st">"N_Pub"</span>]<span class="op">,</span></span>
<span id="cb28-2150"><a href="#cb28-2150" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Treatment</span><span class="op">:</span> d[<span class="st">"Mean_T"</span>]<span class="op">,</span></span>
<span id="cb28-2151"><a href="#cb28-2151" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Control</span><span class="op">:</span> d[<span class="st">"Mean_C"</span>]<span class="op">,</span></span>
<span id="cb28-2152"><a href="#cb28-2152" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> d[<span class="st">"Mean_Difference"</span>]<span class="op">,</span></span>
<span id="cb28-2153"><a href="#cb28-2153" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Se</span><span class="op">:</span> d[<span class="st">'Se'</span>]<span class="op">,</span></span>
<span id="cb28-2154"><a href="#cb28-2154" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Lower</span><span class="op">:</span> d[<span class="st">"Lower"</span>]<span class="op">,</span></span>
<span id="cb28-2155"><a href="#cb28-2155" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Upper</span><span class="op">:</span> d[<span class="st">"Upper"</span>]<span class="op">,</span></span>
<span id="cb28-2156"><a href="#cb28-2156" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-2157"><a href="#cb28-2157" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-2158"><a href="#cb28-2158" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2159"><a href="#cb28-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2160"><a href="#cb28-2160" aria-hidden="true" tabindex="-1"></a><span class="co">// shared column for mean difference dot plots</span></span>
<span id="cb28-2161"><a href="#cb28-2161" aria-hidden="true" tabindex="-1"></a>viewof selectCropMeanDiff <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(meanDiffCropList<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Crop"</span><span class="op">,</span> <span class="dt">unique</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">sort</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">'Maize'</span>})</span>
<span id="cb28-2162"><a href="#cb28-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2163"><a href="#cb28-2163" aria-hidden="true" tabindex="-1"></a><span class="co">// list of crops to show for mean difference (study cutoff)</span></span>
<span id="cb28-2164"><a href="#cb28-2164" aria-hidden="true" tabindex="-1"></a>meanDiffCropList <span class="op">=</span> [</span>
<span id="cb28-2165"><a href="#cb28-2165" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Maize'</span><span class="op">,</span></span>
<span id="cb28-2166"><a href="#cb28-2166" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cowpea'</span><span class="op">,</span></span>
<span id="cb28-2167"><a href="#cb28-2167" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sorghum'</span><span class="op">,</span></span>
<span id="cb28-2168"><a href="#cb28-2168" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Rice'</span><span class="op">,</span></span>
<span id="cb28-2169"><a href="#cb28-2169" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Pearl Millet'</span><span class="op">,</span></span>
<span id="cb28-2170"><a href="#cb28-2170" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cassava or Yuca'</span><span class="op">,</span></span>
<span id="cb28-2171"><a href="#cb28-2171" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Common Bean'</span><span class="op">,</span></span>
<span id="cb28-2172"><a href="#cb28-2172" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Groundnut'</span><span class="op">,</span></span>
<span id="cb28-2173"><a href="#cb28-2173" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Soybean'</span><span class="op">,</span></span>
<span id="cb28-2174"><a href="#cb28-2174" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Wheat'</span><span class="op">,</span></span>
<span id="cb28-2175"><a href="#cb28-2175" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Tomato'</span><span class="op">,</span></span>
<span id="cb28-2176"><a href="#cb28-2176" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Potato'</span><span class="op">,</span></span>
<span id="cb28-2177"><a href="#cb28-2177" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Yam'</span><span class="op">,</span></span>
<span id="cb28-2178"><a href="#cb28-2178" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cotton'</span><span class="op">,</span></span>
<span id="cb28-2179"><a href="#cb28-2179" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sugar Cane'</span><span class="op">,</span></span>
<span id="cb28-2180"><a href="#cb28-2180" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Okra'</span><span class="op">,</span></span>
<span id="cb28-2181"><a href="#cb28-2181" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sweet Potato'</span><span class="op">,</span></span>
<span id="cb28-2182"><a href="#cb28-2182" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Teff'</span><span class="op">,</span></span>
<span id="cb28-2183"><a href="#cb28-2183" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Pigeon Pea'</span><span class="op">,</span></span>
<span id="cb28-2184"><a href="#cb28-2184" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sesame Seed'</span><span class="op">,</span></span>
<span id="cb28-2185"><a href="#cb28-2185" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-28-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-28-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-28-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-28-4" data-nodetype="declaration"></div></div></div></div></section><section id="aez-dot-plot" class="level3"><h3 data-anchor-id="aez-dot-plot">AEZ Dot Plot</h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb29" data-startfrom="2190" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2189"><span id="cb29-2190"><a href="#cb29-2190" aria-hidden="true" tabindex="-1"></a>data_meanDiff_aezPracticeCrop_new <span class="op">=</span> {</span>
<span id="cb29-2191"><a href="#cb29-2191" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> raw <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/Mean_yield_difference@1.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb29-2192"><a href="#cb29-2192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-2193"><a href="#cb29-2193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formatted <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb29-2194"><a href="#cb29-2194" aria-hidden="true" tabindex="-1"></a>    raw<span class="op">,</span></span>
<span id="cb29-2195"><a href="#cb29-2195" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(d)<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb29-2196"><a href="#cb29-2196" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">rename</span>({</span>
<span id="cb29-2197"><a href="#cb29-2197" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_T</span><span class="op">:</span> <span class="st">'Mean_Treatment'</span><span class="op">,</span></span>
<span id="cb29-2198"><a href="#cb29-2198" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_C</span><span class="op">:</span> <span class="st">'Mean_Control'</span><span class="op">,</span></span>
<span id="cb29-2199"><a href="#cb29-2199" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb29-2200"><a href="#cb29-2200" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-2201"><a href="#cb29-2201" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> formatted</span>
<span id="cb29-2202"><a href="#cb29-2202" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-29" data-nodetype="declaration"></div></div></div></section><section id="risk" class="level3"><h3 data-anchor-id="risk">Risk</h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb30" data-startfrom="2208" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2207"><span id="cb30-2208"><a href="#cb30-2208" aria-hidden="true" tabindex="-1"></a>data_lclRisk <span class="op">=</span> data_extendedTable2<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span> <span class="op">==</span> <span class="st">"LCL Risk"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-30" data-nodetype="declaration"></div></div></div></section><section id="adoption-factors" class="level3"><h3 data-anchor-id="adoption-factors">Adoption Factors</h3><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb31" data-startfrom="2215" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2214"><span id="cb31-2215"><a href="#cb31-2215" aria-hidden="true" tabindex="-1"></a>adoptionFactorAllLabel <span class="op">=</span> <span class="st">"All practices"</span></span>
<span id="cb31-2216"><a href="#cb31-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2217"><a href="#cb31-2217" aria-hidden="true" tabindex="-1"></a>rawAdoptionFactors <span class="op">=</span> {</span>
<span id="cb31-2218"><a href="#cb31-2218" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> raw <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/DiscoverSolutions/adoption_factors_20mar24.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()</span>
<span id="cb31-2219"><a href="#cb31-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2220"><a href="#cb31-2220" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> raw<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb31-2221"><a href="#cb31-2221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb31-2222"><a href="#cb31-2222" aria-hidden="true" tabindex="-1"></a>      <span class="dt">index</span><span class="op">:</span> d[<span class="st">''</span>]<span class="op">,</span></span>
<span id="cb31-2223"><a href="#cb31-2223" aria-hidden="true" tabindex="-1"></a>      <span class="dt">practice</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'practices'</span>])<span class="op">,</span></span>
<span id="cb31-2224"><a href="#cb31-2224" aria-hidden="true" tabindex="-1"></a>      <span class="dt">factor</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'adoption_factors'</span>])<span class="op">,</span></span>
<span id="cb31-2225"><a href="#cb31-2225" aria-hidden="true" tabindex="-1"></a>      <span class="dt">direction</span><span class="op">:</span> <span class="bu">String</span>(d[<span class="st">'direction'</span>])<span class="op">,</span></span>
<span id="cb31-2226"><a href="#cb31-2226" aria-hidden="true" tabindex="-1"></a>      <span class="dt">n</span><span class="op">:</span> <span class="fu">parseNum</span>(d<span class="op">.</span><span class="at">n</span>)</span>
<span id="cb31-2227"><a href="#cb31-2227" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-2228"><a href="#cb31-2228" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb31-2229"><a href="#cb31-2229" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-2230"><a href="#cb31-2230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2231"><a href="#cb31-2231" aria-hidden="true" tabindex="-1"></a>dataAdoptionFactors <span class="op">=</span> {</span>
<span id="cb31-2232"><a href="#cb31-2232" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> allPractices <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb31-2233"><a href="#cb31-2233" aria-hidden="true" tabindex="-1"></a>    rawAdoptionFactors<span class="op">,</span></span>
<span id="cb31-2234"><a href="#cb31-2234" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">groupBy</span>(</span>
<span id="cb31-2235"><a href="#cb31-2235" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"factor"</span><span class="op">,</span> <span class="st">"direction"</span>]<span class="op">,</span></span>
<span id="cb31-2236"><a href="#cb31-2236" aria-hidden="true" tabindex="-1"></a>      [</span>
<span id="cb31-2237"><a href="#cb31-2237" aria-hidden="true" tabindex="-1"></a>        T<span class="op">.</span><span class="fu">summarize</span>({</span>
<span id="cb31-2238"><a href="#cb31-2238" aria-hidden="true" tabindex="-1"></a>          <span class="dt">n</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"n"</span>)</span>
<span id="cb31-2239"><a href="#cb31-2239" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb31-2240"><a href="#cb31-2240" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb31-2241"><a href="#cb31-2241" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb31-2242"><a href="#cb31-2242" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">groupBy</span>(</span>
<span id="cb31-2243"><a href="#cb31-2243" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"factor"</span>]<span class="op">,</span></span>
<span id="cb31-2244"><a href="#cb31-2244" aria-hidden="true" tabindex="-1"></a>      [</span>
<span id="cb31-2245"><a href="#cb31-2245" aria-hidden="true" tabindex="-1"></a>        T<span class="op">.</span><span class="fu">mutateWithSummary</span>({</span>
<span id="cb31-2246"><a href="#cb31-2246" aria-hidden="true" tabindex="-1"></a>          <span class="dt">total</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"n"</span>)</span>
<span id="cb31-2247"><a href="#cb31-2247" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb31-2248"><a href="#cb31-2248" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb31-2249"><a href="#cb31-2249" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb31-2250"><a href="#cb31-2250" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">mutate</span>({ <span class="dt">perc</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">n</span> <span class="op">/</span> d<span class="op">.</span><span class="at">total</span>) <span class="op">*</span> <span class="dv">100</span> })<span class="op">,</span></span>
<span id="cb31-2251"><a href="#cb31-2251" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">mutate</span>({ <span class="dt">practice</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> adoptionFactorAllLabel })<span class="op">,</span></span>
<span id="cb31-2252"><a href="#cb31-2252" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">select</span>([<span class="st">"practice"</span><span class="op">,</span> T<span class="op">.</span><span class="fu">everything</span>()])</span>
<span id="cb31-2253"><a href="#cb31-2253" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb31-2254"><a href="#cb31-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2255"><a href="#cb31-2255" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> wrangled <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb31-2256"><a href="#cb31-2256" aria-hidden="true" tabindex="-1"></a>    rawAdoptionFactors<span class="op">,</span></span>
<span id="cb31-2257"><a href="#cb31-2257" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">select</span>(T<span class="op">.</span><span class="fu">negate</span>(<span class="st">"index"</span>))<span class="op">,</span></span>
<span id="cb31-2258"><a href="#cb31-2258" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">groupBy</span>(</span>
<span id="cb31-2259"><a href="#cb31-2259" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"practice"</span><span class="op">,</span> <span class="st">"factor"</span>]<span class="op">,</span></span>
<span id="cb31-2260"><a href="#cb31-2260" aria-hidden="true" tabindex="-1"></a>      [T<span class="op">.</span><span class="fu">mutateWithSummary</span>({ <span class="dt">total</span><span class="op">:</span> T<span class="op">.</span><span class="fu">sum</span>(<span class="st">"n"</span>) })]</span>
<span id="cb31-2261"><a href="#cb31-2261" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb31-2262"><a href="#cb31-2262" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">mutate</span>({</span>
<span id="cb31-2263"><a href="#cb31-2263" aria-hidden="true" tabindex="-1"></a>      <span class="dt">perc</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">n</span> <span class="op">/</span> d<span class="op">.</span><span class="at">total</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-2264"><a href="#cb31-2264" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb31-2265"><a href="#cb31-2265" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb31-2266"><a href="#cb31-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2267"><a href="#cb31-2267" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb31-2268"><a href="#cb31-2268" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>wrangled<span class="op">,</span></span>
<span id="cb31-2269"><a href="#cb31-2269" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>allPractices</span>
<span id="cb31-2270"><a href="#cb31-2270" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb31-2271"><a href="#cb31-2271" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-2272"><a href="#cb31-2272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2273"><a href="#cb31-2273" aria-hidden="true" tabindex="-1"></a><span class="co">// mapped adoption data</span></span>
<span id="cb31-2274"><a href="#cb31-2274" aria-hidden="true" tabindex="-1"></a>dataAdoptionFactorsMap <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(dataAdoptionFactors<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">practice</span>)</span>
<span id="cb31-2275"><a href="#cb31-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2276"><a href="#cb31-2276" aria-hidden="true" tabindex="-1"></a>adoptionFactorsLookup <span class="op">=</span> ({</span>
<span id="cb31-2277"><a href="#cb31-2277" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Not significant"</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adoptionFactors</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">notSig</span>)<span class="op">,</span></span>
<span id="cb31-2278"><a href="#cb31-2278" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Negative"</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adoptionFactors</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">neg</span>)<span class="op">,</span></span>
<span id="cb31-2279"><a href="#cb31-2279" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Positive"</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adoptionFactors</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">pos</span>)<span class="op">,</span></span>
<span id="cb31-2280"><a href="#cb31-2280" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb31-2281"><a href="#cb31-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2282"><a href="#cb31-2282" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">markBoldSidebarText</span>(data<span class="op">,</span> {textFormat<span class="op">=</span>(d) <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="st">' obs.'</span><span class="op">,</span> <span class="op">...</span>options } <span class="op">=</span> {}) {</span>
<span id="cb31-2283"><a href="#cb31-2283" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">marks</span>(</span>
<span id="cb31-2284"><a href="#cb31-2284" aria-hidden="true" tabindex="-1"></a>    <span class="co">// observation counts</span></span>
<span id="cb31-2285"><a href="#cb31-2285" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb31-2286"><a href="#cb31-2286" aria-hidden="true" tabindex="-1"></a>      data<span class="op">,</span></span>
<span id="cb31-2287"><a href="#cb31-2287" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb31-2288"><a href="#cb31-2288" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="fu">textFormat</span>(d)) }<span class="op">,</span></span>
<span id="cb31-2289"><a href="#cb31-2289" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb31-2290"><a href="#cb31-2290" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb31-2291"><a href="#cb31-2291" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb31-2292"><a href="#cb31-2292" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb31-2293"><a href="#cb31-2293" aria-hidden="true" tabindex="-1"></a>            <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb31-2294"><a href="#cb31-2294" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb31-2295"><a href="#cb31-2295" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span>options</span>
<span id="cb31-2296"><a href="#cb31-2296" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb31-2297"><a href="#cb31-2297" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-2298"><a href="#cb31-2298" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb31-2299"><a href="#cb31-2299" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb31-2300"><a href="#cb31-2300" aria-hidden="true" tabindex="-1"></a>    <span class="co">// digital white-out</span></span>
<span id="cb31-2301"><a href="#cb31-2301" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb31-2302"><a href="#cb31-2302" aria-hidden="true" tabindex="-1"></a>      data<span class="op">,</span></span>
<span id="cb31-2303"><a href="#cb31-2303" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">pointerY</span>(</span>
<span id="cb31-2304"><a href="#cb31-2304" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb31-2305"><a href="#cb31-2305" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="fu">textFormat</span>(d)) }<span class="op">,</span></span>
<span id="cb31-2306"><a href="#cb31-2306" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb31-2307"><a href="#cb31-2307" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb31-2308"><a href="#cb31-2308" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb31-2309"><a href="#cb31-2309" aria-hidden="true" tabindex="-1"></a>              <span class="co">// y: "factor",</span></span>
<span id="cb31-2310"><a href="#cb31-2310" aria-hidden="true" tabindex="-1"></a>              <span class="co">// text: "n",</span></span>
<span id="cb31-2311"><a href="#cb31-2311" aria-hidden="true" tabindex="-1"></a>              <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb31-2312"><a href="#cb31-2312" aria-hidden="true" tabindex="-1"></a>              <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb31-2313"><a href="#cb31-2313" aria-hidden="true" tabindex="-1"></a>              <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb31-2314"><a href="#cb31-2314" aria-hidden="true" tabindex="-1"></a>              <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb31-2315"><a href="#cb31-2315" aria-hidden="true" tabindex="-1"></a>              <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb31-2316"><a href="#cb31-2316" aria-hidden="true" tabindex="-1"></a>              <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb31-2317"><a href="#cb31-2317" aria-hidden="true" tabindex="-1"></a>              <span class="op">...</span>options</span>
<span id="cb31-2318"><a href="#cb31-2318" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb31-2319"><a href="#cb31-2319" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb31-2320"><a href="#cb31-2320" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-2321"><a href="#cb31-2321" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb31-2322"><a href="#cb31-2322" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb31-2323"><a href="#cb31-2323" aria-hidden="true" tabindex="-1"></a>    <span class="co">// observation counts bold hover</span></span>
<span id="cb31-2324"><a href="#cb31-2324" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb31-2325"><a href="#cb31-2325" aria-hidden="true" tabindex="-1"></a>      data<span class="op">,</span></span>
<span id="cb31-2326"><a href="#cb31-2326" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">pointerY</span>(</span>
<span id="cb31-2327"><a href="#cb31-2327" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb31-2328"><a href="#cb31-2328" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">text</span><span class="op">:</span> (values) <span class="kw">=&gt;</span> values<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="fu">textFormat</span>(d)) }<span class="op">,</span></span>
<span id="cb31-2329"><a href="#cb31-2329" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">groupY</span>(</span>
<span id="cb31-2330"><a href="#cb31-2330" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">text</span><span class="op">:</span> <span class="st">"sum"</span> }<span class="op">,</span></span>
<span id="cb31-2331"><a href="#cb31-2331" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb31-2332"><a href="#cb31-2332" aria-hidden="true" tabindex="-1"></a>              <span class="co">// y: "factor",</span></span>
<span id="cb31-2333"><a href="#cb31-2333" aria-hidden="true" tabindex="-1"></a>              <span class="co">// text: "n",</span></span>
<span id="cb31-2334"><a href="#cb31-2334" aria-hidden="true" tabindex="-1"></a>              <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb31-2335"><a href="#cb31-2335" aria-hidden="true" tabindex="-1"></a>              <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb31-2336"><a href="#cb31-2336" aria-hidden="true" tabindex="-1"></a>              <span class="dt">dx</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb31-2337"><a href="#cb31-2337" aria-hidden="true" tabindex="-1"></a>              <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb31-2338"><a href="#cb31-2338" aria-hidden="true" tabindex="-1"></a>              <span class="op">...</span>options</span>
<span id="cb31-2339"><a href="#cb31-2339" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb31-2340"><a href="#cb31-2340" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb31-2341"><a href="#cb31-2341" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-2342"><a href="#cb31-2342" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb31-2343"><a href="#cb31-2343" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-2344"><a href="#cb31-2344" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb31-2345"><a href="#cb31-2345" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-4" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-5" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-31-6" data-nodetype="declaration"></div></div></div></div></section></section><section id="imports" class="level2"><h2 data-anchor-id="imports">Imports</h2><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb32" data-startfrom="2350" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2349"><span id="cb32-2350"><a href="#cb32-2350" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { T } <span class="im">from</span> <span class="st">"@pbeshai/tidyjs"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-32" data-nodetype="declaration"></div></div></div><div class="ojs-auto-generated hidden"><script type="ojs-module-contents">eyJjb250ZW50cyI6WyAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7bmJUaXRsZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke092ZXJ2aWV3fTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7X2xhbmcobmJUZXh0Lm92ZXJ2aWV3LmJsb2Nrcy5vcGVuZXIxKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTMifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke0ludGVydmVudGlvbnN9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC00In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtQcmFjdGljYWxJbXBhY3R9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0Lm1lYW5Dcm9wRGlmZi5ibG9ja3Mub3BlbmVyMSl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC02In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtDcm9wRGlmZn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTcifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3F1aWNrSW5zaWdodH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2Nyb3BfZGlmZl9hZXp9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC05In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0Lm1lYW5Dcm9wRGlmZkFFWi5ibG9ja3Mub3BlbmVyMSl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7cXVpY2tJbnNpZ2h0fTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke1Jpc2tzfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTIifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke19sYW5nKG5iVGV4dC5yaXNrcy5ibG9ja3Mub3BlbmVyKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEzIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtxdWlja0luc2lnaHR9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7RmFjdG9yc308L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE1In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtfbGFuZyhuYlRleHQuYWRvcHRpb25GYWN0b3JzLmJsb2Nrcy5vcGVuZXIxKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE2In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtxdWlja0luc2lnaHR9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xNyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7U3VtbWFyeX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE4In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtfbGFuZyhuYlRleHQuc3VtbWFyeS5ibG9ja3Mub3BlbmVyMSl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xOSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7X2xhbmcobmJUZXh0LnN1bW1hcnkuYmxvY2tzLm9wZW5lcjIpfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjAifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke01ldGhvZHN9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yMSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7X2xhbmcobmJUZXh0Lm1ldGhvZHNTb3VyY2VzLmludHJvKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTIyIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkYXRhX3NvdXJjZXN9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7bWV0aG9kc308L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTI0In1dfQ==</script></div></section></section></main><script type="ojs-module-contents">eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwcmV0dHlMYW5ndWFnZVZpZXcgPSB7XG4gIHJldHVybiBJbnB1dHMuYmluZChcbiAgICBJbnB1dHMucmFkaW8obGFuZ3VhZ2VzLCB7XG4gICAgICBsYWJlbDogX2xhbmcoe2VuOiBcIkxhbmd1YWdlXCIsIGZyOiBcIkxhbmd1ZVwifSksXG4gICAgICBmb3JtYXQ6IChkKSA9PiBkLmxhYmVsXG4gICAgfSksXG4gICAgdmlld29mIGxhbmd1YWdlXG4gICk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIC8vIGZpbmQgdG90YWwgb2JzZXJ2YXRpb25zXG4gIGNvbnN0IHJhdyA9IGQzLnN1bShcbiAgICBkYXRhX2V4dGVuZGVkVGFibGUyX3RvdGFsLFxuICAgIChkKSA9PiBkLm9ic2VydmF0aW9uc1xuICApO1xuICBjb25zdCBmb3JtYXR0ZWQgPSBNYXRoLnJvdW5kKHJhdyAvIDEwMDApICogMTAwMDtcbiAgY29uc3QgdG90YWxPYnMgPSBmb3JtYXROdW1TdGFuZGFyZChmb3JtYXR0ZWQsIHtcbiAgICBsb2NhbGU6IGxhbmd1YWdlLmxvY2FsZVxuICB9KTtcblxuICBjb25zdCBsYW5nU3RyaW5nID0gX2xhbmcobmJUZXh0LmludGVydmVudGlvbnMuYmxvY2tzLm9wZW5lcjEpO1xuICBjb25zdCBmb3JtYXR0ZWRTdHJpbmcgPSBsYW5nU3RyaW5nLnJlcGxhY2UoXG4gICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKFwidG90YWxPYnNcIiksXG4gICAgdG90YWxPYnNcbiAgKTtcblxuICByZXR1cm4gbWRgJHtmb3JtYXR0ZWRTdHJpbmd9YDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgY29uc3QgZGF0YSA9IGRhdGFfZXh0ZW5kZWRUYWJsZTJfdG90YWw7XG4gIGNvbnN0IGNvbG9yRmlsbCA9IFwiIzIxNjcyOVwiO1xuICBjb25zdCBsYW5nTG9vayA9IHtcbiAgICBvYnM6IExhbmcudG9TZW50ZW5jZUNhc2UoXG4gICAgICBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5wbHVyYWwpXG4gICAgKVxuICB9O1xuICBjb25zdCB5ID0gKGQpID0+IF9sYW5nKHRkLlByYWN0aWNlLnZhbHVlcz8uW2RdKTtcblxuICByZXR1cm4gUGxvdC5wbG90KHtcbiAgICB3aWR0aDogOTAwLFxuICAgIGhlaWdodDogNzAwLFxuICAgIG1hcmdpbkxlZnQ6IDE5MCxcbiAgICBtYXJnaW5SaWdodDogNTAsXG4gICAgbWFyZ2luVG9wOiA2MCxcbiAgICB4OiB7XG4gICAgICB0aWNrRm9ybWF0OiBcInNcIixcbiAgICAgIGF4aXM6IFwidG9wXCIsXG4gICAgICBsYWJlbDogbGFuZ0xvb2sub2JzLFxuICAgICAgbGFiZWxPZmZzZXQ6IDQwLFxuICAgICAgbGFiZWxBbmNob3I6IFwiY2VudGVyXCIsXG4gICAgICBsYWJlbEFycm93OiBcIm5vbmVcIixcbiAgICAgIGdyaWQ6IHRydWVcbiAgICB9LFxuICAgIHk6IHtcbiAgICAgIGxhYmVsOiBudWxsXG4gICAgfSxcbiAgICBtYXJrczogW1xuICAgICAgUGxvdC5ydWxlWChbMF0pLFxuICAgICAgUGxvdC5iYXJYKGRhdGEsIHtcbiAgICAgICAgeDogXCJvYnNlcnZhdGlvbnNcIixcbiAgICAgICAgeTogKGQpID0+IHkoZC5wcmFjdGljZSksXG4gICAgICAgIHNvcnQ6IHsgeTogXCJ4XCIsIHJldmVyc2U6IHRydWUgfSxcbiAgICAgICAgZmlsbDogY29sb3JGaWxsXG4gICAgICB9KSxcbiAgICAgIFBsb3QudGV4dFgoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFBsb3QubWFwKFxuICAgICAgICAgIHsgdGV4dDogKHYpID0+IHYubWFwKChkKSA9PiBgJHtkMy5mb3JtYXQoXCIuMnNcIikoZCl9IG9icy5gKSB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHg6IFwib2JzZXJ2YXRpb25zXCIsXG4gICAgICAgICAgICB5OiAoZCkgPT4geShkLnByYWN0aWNlKSxcbiAgICAgICAgICAgIHRleHQ6IFwib2JzZXJ2YXRpb25zXCIsXG4gICAgICAgICAgICB0ZXh0QW5jaG9yOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICBkeDogNSxcbiAgICAgICAgICAgIGZpbGw6IFwiIzMzM1wiXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICApXG4gICAgXVxuICB9KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzZWxlY3RDcm9wTWVhbkRpZmZfbmV3ID0ge1xuICBjb25zdCBkYXRhID0gWy4uLm5ldyBTZXQoZGF0YV9tZWFuRGlmZl9wcmFjdGljZUNyb3BfbmV3Lm1hcCgoZCkgPT4gZC5Dcm9wKSldXG4gICAgLm1hcCgoZCkgPT4ge1xuICAgICAgcmV0dXJuIHsgZmllbGQ6IGQsIHRyYW5zbGF0aW9uOiB0ZC5Dcm9wLnZhbHVlcz8uW2RdIH07XG4gICAgfSlcbiAgICAuc29ydCgoYSwgYikgPT4gX2xhbmcoYS50cmFuc2xhdGlvbikgPiBfbGFuZyhiLnRyYW5zbGF0aW9uKSk7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcodGQuQ3JvcCksXG4gICAgdmFsdWU6IGRhdGEuZmluZCh4ID0+IHguZmllbGQgPT0gJ01haXplJyksXG4gICAgZm9ybWF0OiAoeCkgPT4gX2xhbmcoeC50cmFuc2xhdGlvbilcbiAgfSk7XG59XG5cbnZpZXdvZiByYWRpb1NvcnREb3RQbG90Q3JvcF9uZXcgPSB7XG4gIGNvbnN0IGRhdGEgPSBbXG4gICAge1xuICAgICAga2V5OiBcIm1lYW5cIixcbiAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuaW5wdXRzLnJhZGlvU29ydC5maWVsZHMubWVhbiksXG4gICAgICBjaGFubmVsOiBcInhcIixcbiAgICAgIHJldmVyc2U6IHRydWUsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFwib2JzZXJ2YXRpb25zXCIsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmlucHV0cy5yYWRpb1NvcnQuZmllbGRzLm9ic2VydmF0aW9ucyksXG4gICAgICBjaGFubmVsOiBcIm5PYnNcIixcbiAgICAgIHJldmVyc2U6IHRydWUsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFwiYWxwaGFcIixcbiAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuaW5wdXRzLnJhZGlvU29ydC5maWVsZHMuYWxwaGEpLFxuICAgICAgY2hhbm5lbDogXCJ5XCIsXG4gICAgICByZXZlcnNlOiBmYWxzZSxcbiAgICB9LFxuICBdXG4gIHJldHVybiBJbnB1dHMucmFkaW8oZGF0YSwgeyBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLnNvcnQpLCBmb3JtYXQ6IGQgPT4gZC5sYWJlbCwgdmFsdWU6IGRhdGEuZmluZCh4ID0+IHgua2V5ID09PSAnbWVhbicpIH0pO1xufVxuXG52aWV3b2YgdG9nZ2xlQ0lzQ3JvcF9uZXcgPSB7XG4gIGNvbnN0IGRhdGEgPSBbXG4gICAgX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC5pbnB1dHMudG9nZ2xlQ29uZkludC5maWVsZHMudmlzaWJsZSlcbiAgXVxuICByZXR1cm4gSW5wdXRzLmNoZWNrYm94KGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLmNvbmZpZGVuY2VJbnRlcnZhbHMpXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBjb25zdCBwbG90RGF0YSA9IGRhdGFfbWVhbkRpZmZfcHJhY3RpY2VDcm9wX25ldy5maWx0ZXIoXG4gICAgKGQpID0+IGQuQ3JvcCA9PT0gc2VsZWN0Q3JvcE1lYW5EaWZmX25ldy5maWVsZFxuICApO1xuICBjb25zdCBtYXJnaW5Cb3R0b20gPSAwO1xuICBjb25zdCBtYXJnaW5Ub3AgPSA2MDtcbiAgY29uc3QgeUhlaWdodCA9IDI1O1xuICBjb25zdCBoZWlnaHQgPVxuICAgIG1hcmdpblRvcCArXG4gICAgbWFyZ2luQm90dG9tICtcbiAgICBkMy5ncm91cChwbG90RGF0YSwgKGQpID0+IGQuUHJhY3RpY2UpLnNpemUgKiB5SGVpZ2h0O1xuICBjb25zdCBfZm9ybWF0TnVtID0gZm9ybWF0TnVtO1xuICBjb25zdCBfdG9nZ2xlQ0lzID0gdG9nZ2xlQ0lzQ3JvcF9uZXc7XG4gIGNvbnN0IF9yYWRpb1NvcnQgPSByYWRpb1NvcnREb3RQbG90Q3JvcF9uZXc7XG4gIGNvbnN0IGxhbmdMb29rdXAgPSB7XG4gICAgeExhYmVsOiBfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0LmxhYmVscy54TWVhbkRpZmYpLFxuICAgIHRvb2x0aXA6IHtcbiAgICAgIGFlejogX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC50b29sdGlwcy5hZXopLFxuICAgICAgbWVhbkRpZmY6IF9sYW5nKG5iVGV4dC5wcmFjdGljYWxJbXBhY3QudG9vbHRpcHMubWVhbkRpZmYpLFxuICAgICAgbWVhbkNvbnRyb2w6IF9sYW5nKG5iVGV4dC5wcmFjdGljYWxJbXBhY3QudG9vbHRpcHMubWVhbkNvbnRyb2wpLFxuICAgICAgY3JvcDogTGFuZy50b1NlbnRlbmNlQ2FzZShfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5jcm9wLnNpbmd1bGFyKSksXG4gICAgICBjaUxvOiBfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0LnRvb2x0aXBzLmNpTG93ZXIpLFxuICAgICAgY2lIaTogX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC50b29sdGlwcy5jaVVwcGVyKSxcbiAgICAgIG9iczogTGFuZy50b1NlbnRlbmNlQ2FzZShfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5wbHVyYWwpKSxcbiAgICAgIHByYWN0aWNlOiBMYW5nLnRvU2VudGVuY2VDYXNlKF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLnByYWN0aWNlLnNpbmd1bGFyKSlcbiAgICB9XG4gIH1cbiAgY29uc3QgeSA9IChkKSA9PiBfbGFuZyh0ZC5QcmFjdGljZS52YWx1ZXM/LltkXSk7XG5cbiAgcmV0dXJuIFBsb3QucGxvdCh7XG4gICAgaGVpZ2h0LFxuICAgIG1hcmdpbkJvdHRvbSxcbiAgICBtYXJnaW5Ub3AsXG4gICAgbWFyZ2luTGVmdDogMjAwLFxuICAgIG1hcmdpblJpZ2h0OiA3MCxcbiAgICB3aWR0aDogOTAwLFxuICAgIHg6IHtcbiAgICAgIGF4aXM6IFwidG9wXCIsXG4gICAgICBuaWNlOiB0cnVlLFxuICAgICAgZ3JpZDogdHJ1ZSxcbiAgICAgIGxhYmVsOiBsYW5nTG9va3VwLnhMYWJlbCxcbiAgICAgIGxhYmVsQW5jaG9yOiBcImNlbnRlclwiLFxuICAgICAgbGFiZWxPZmZzZXQ6IDQwLFxuICAgICAgbGFiZWxBcnJvdzogXCJub25lXCJcbiAgICB9LFxuICAgIHk6IHtcbiAgICAgIHRpY2tTaXplOiAwLFxuICAgICAgbGFiZWw6IG51bGxcbiAgICB9LFxuICAgIGNvbG9yOiB7XG4gICAgICByYW5nZTogY29sb3JZZWxsb3dHcmVlblxuICAgIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIC8vIG1haW4geS1heGlzXG4gICAgICBQbG90LmF4aXNZKHtcbiAgICAgICAgdGlja1NpemU6IDBcbiAgICAgIH0pLFxuICAgICAgLy8gcG9pbnRlciB3aGl0ZS1vdXRcbiAgICAgIFBsb3QuYXhpc1koXG4gICAgICAgIFBsb3QucG9pbnRlclkoe1xuICAgICAgICAgIGZpbGw6IFwid2hpdGVcIixcbiAgICAgICAgICB0ZXh0U3Ryb2tlOiBcIndoaXRlXCIsXG4gICAgICAgICAgdGV4dFN0cm9rZVdpZHRoOiAyLFxuICAgICAgICAgIHRpY2tTaXplOiAwXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgLy8gYm9sZCBwb2ludGVyXG4gICAgICBQbG90LmF4aXNZKFxuICAgICAgICBQbG90LnBvaW50ZXJZKHtcbiAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIixcbiAgICAgICAgICB0aWNrU2l6ZTogMFxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIC8vIHplcm8gcG9pbnRcbiAgICAgIFBsb3QucnVsZVgoWzBdLCB7IHN0cm9rZTogXCIjMzMzXCIsIHN0cm9rZURhc2hhcnJheTogWzRdIH0pLFxuICAgICAgLy8gc3BhbiBsaW5lczogQ0lcbiAgICAgIFBsb3QucnVsZVkoX3RvZ2dsZUNJcy5sZW5ndGggPiAwID8gcGxvdERhdGEgOiBbXSwge1xuICAgICAgICB5OiAoZCkgPT4geShkLlByYWN0aWNlKSxcbiAgICAgICAgeDE6IChkKSA9PiBkLkxvd2VyLFxuICAgICAgICB4MjogKGQpID0+IGQuVXBwZXIsXG4gICAgICAgIHN0cm9rZTogXCIjMzMzXCJcbiAgICAgIH0pLFxuICAgICAgLy8gbWVhbiBkaWZmIGRvdHNcbiAgICAgIFBsb3QuZG90KHBsb3REYXRhLCB7XG4gICAgICAgIHg6IFwiTWVhbl9EaWZmZXJlbmNlXCIsXG4gICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICBzb3J0OiB7IHk6IF9yYWRpb1NvcnQuY2hhbm5lbCwgcmV2ZXJzZTogX3JhZGlvU29ydC5yZXZlcnNlIH0sXG4gICAgICAgIGZpbGw6IChkKSA9PiBkLk1lYW5fRGlmZmVyZW5jZSxcbiAgICAgICAgcjogOCxcbiAgICAgICAgc3Ryb2tlOiBcIiNmZmZcIixcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDAuNyxcbiAgICAgICAgY2hhbm5lbHM6IHtcbiAgICAgICAgICBuT2JzOiB7XG4gICAgICAgICAgICB2YWx1ZTogXCJOX09ic1wiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwcmFjOiB7XG4gICAgICAgICAgICB2YWx1ZTogKGQpID0+IHkoZC5QcmFjdGljZSksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjcm9wOiB7XG4gICAgICAgICAgICB2YWx1ZTogXCJDcm9wXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRpZmY6IHtcbiAgICAgICAgICAgIGxhYmVsOiBsYW5nTG9va3VwLnRvb2x0aXAubWVhbkRpZmYsXG4gICAgICAgICAgICB2YWx1ZTogXCJNZWFuX0RpZmZlcmVuY2VcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY29udHJvbDoge1xuICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rdXAudG9vbHRpcC5tZWFuQ29udHJvbCxcbiAgICAgICAgICAgIHZhbHVlOiAnTWVhbl9Db250cm9sJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNpTG93OiB7XG4gICAgICAgICAgICBsYWJlbDogbGFuZ0xvb2t1cC50b29sdGlwLmNpTG8sXG4gICAgICAgICAgICB2YWx1ZTogXCJMb3dlclwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaUhpZ2g6IHtcbiAgICAgICAgICAgIGxhYmVsOiBsYW5nTG9va3VwLnRvb2x0aXAuY2lIaSxcbiAgICAgICAgICAgIHZhbHVlOiBcIlVwcGVyXCJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRpcDoge1xuICAgICAgICAgIGZvcm1hdDoge1xuICAgICAgICAgICAgeDogZmFsc2UsXG4gICAgICAgICAgICB5OiBmYWxzZSxcbiAgICAgICAgICAgIGZpbGw6IGZhbHNlLFxuICAgICAgICAgICAgcHJhYzogZmFsc2UsXG4gICAgICAgICAgICBjcm9wOiBmYWxzZSxcbiAgICAgICAgICAgIG5PYnM6IGZhbHNlLFxuICAgICAgICAgICAgZGlmZjogKGQpID0+IF9mb3JtYXROdW0oZCksXG4gICAgICAgICAgICBjb250cm9sOiAoZCkgPT4gX2Zvcm1hdE51bShkKSxcbiAgICAgICAgICAgIGNpTG93OiAoZCkgPT4gX2Zvcm1hdE51bShkKSxcbiAgICAgICAgICAgIGNpSGlnaDogKGQpID0+IF9mb3JtYXROdW0oZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgLy8gZG90IGhpZ2hsaWdodCBvbiBob3ZlclxuICAgICAgUGxvdC5kb3QocGxvdERhdGEsIFBsb3QucG9pbnRlcih7XG4gICAgICAgIHg6IFwiTWVhbl9EaWZmZXJlbmNlXCIsXG4gICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICByOiA4LFxuICAgICAgICBzdHJva2U6IFwiIzMzM1wiLFxuICAgICAgICBzdHJva2VXaWR0aDogMC43LFxuICAgICAgICBjaGFubmVsczoge1xuICAgICAgICAgIG5PYnM6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIiMgT2JzZXJ2YXRpb25zXCIsXG4gICAgICAgICAgICB2YWx1ZTogXCJOX09ic1wiXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSkpLFxuICAgICAgLy8gb2JzZXJ2YXRpb24gY291bnRzXG4gICAgICBQbG90LnRleHRZKHBsb3REYXRhLCB7XG4gICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICB0ZXh0OiAoZCkgPT4gZC5OX09icyArIFwiIG9icy5cIixcbiAgICAgICAgZnJhbWVBbmNob3I6IFwicmlnaHRcIixcbiAgICAgICAgdGV4dEFuY2hvcjogXCJzdGFydFwiLFxuICAgICAgICBkeDogMTZcbiAgICAgIH0pLFxuICAgICAgLy8gY291bnRzIHdoaXRlLW91dFxuICAgICAgUGxvdC50ZXh0WShcbiAgICAgICAgcGxvdERhdGEsXG4gICAgICAgIFBsb3QucG9pbnRlclkoe1xuICAgICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICAgIHRleHQ6IChkKSA9PiBkLk5fT2JzICsgXCIgb2JzLlwiLFxuICAgICAgICAgIGZpbGw6IFwid2hpdGVcIixcbiAgICAgICAgICBzdHJva2U6IFwid2hpdGVcIixcbiAgICAgICAgICBzdHJva2VXaWR0aDogMixcbiAgICAgICAgICBmcmFtZUFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgICAgIHRleHRBbmNob3I6IFwic3RhcnRcIixcbiAgICAgICAgICBkeDogMTZcbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICAvLyBjb3VudHMgYm9sZCBob3ZlclxuICAgICAgUGxvdC50ZXh0WShcbiAgICAgICAgcGxvdERhdGEsXG4gICAgICAgIFBsb3QucG9pbnRlclkoe1xuICAgICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICAgIHRleHQ6IChkKSA9PiBkLk5fT2JzICsgXCIgb2JzLlwiLFxuICAgICAgICAgIGZvbnRXZWlnaHQ6IFwiYm9sZFwiLFxuICAgICAgICAgIGZyYW1lQW5jaG9yOiBcInJpZ2h0XCIsXG4gICAgICAgICAgdGV4dEFuY2hvcjogXCJzdGFydFwiLFxuICAgICAgICAgIGR4OiAxNlxuICAgICAgICB9KVxuICAgICAgKVxuICAgIF1cbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBpbnNpZ2h0c1xue1xuICBjb25zdCBsYW5nUm9vdCA9IG5iVGV4dDtcbiAgY29uc3QgbGFuZ0Jhc2VQYXRoID0gbGFuZ1Jvb3QucHJhY3RpY2FsSW1wYWN0Lm1lYW5Dcm9wRGlmZi5pbnNpZ2h0czsgLy8gYmFzZSBwYXRoIGZvciBsYW5ndWFnZVxuXG4gIGNvbnN0IGRhdGEgPSBkYXRhX21lYW5EaWZmX3ByYWN0aWNlQ3JvcF9uZXc7XG4gIGNvbnN0IHNlbGVjdGlvbiA9IHNlbGVjdENyb3BNZWFuRGlmZl9uZXcuZmllbGQ7XG5cbiAgY29uc3QgdGxfY3JvcCA9IChjcm9wKSA9PiBfbGFuZyh0ZC5Dcm9wLnZhbHVlcz8uW2Nyb3BdKTtcbiAgY29uc3QgdGxfY3JvcF9hcnRpY2xlID0gKGNyb3ApID0+IF9sYW5nKHRkLkNyb3Bfd2l0aF9hcnRpY2xlcy52YWx1ZXM/Lltjcm9wXSk7XG4gIGNvbnN0IHRsX3ByYWMgPSAocHJhYykgPT4gX2xhbmcodGQuUHJhY3RpY2UudmFsdWVzPy5bcHJhY10pO1xuXG4gIC8vIHRvcCA1IGNyb3BzIGJ5IHVuaXF1ZSBwcmFjdGljZXNcbiAgY29uc3QgdG9wNUNyb3BzQnlQcmFjdGljZXMgPSBULnRpZHkoXG4gICAgZGF0YSxcbiAgICBULmNvdW50KFtcIkNyb3BcIl0pLFxuICAgIFQuYXJyYW5nZShULmRlc2MoXCJuXCIpKSxcbiAgICBULnNsaWNlSGVhZCg1KVxuICApO1xuICBjb25zdCB0b3A1Q3JvcHNCeVByYWN0aWNlc1N0cmluZyA9IHRvcDVDcm9wc0J5UHJhY3RpY2VzXG4gICAgLm1hcCgoZCwgaSkgPT4ge1xuICAgICAgaWYgKGkgPT0gdG9wNUNyb3BzQnlQcmFjdGljZXMubGVuZ3RoIC0gMSkgcmV0dXJuIGBhbmQgKioke3RsX2Nyb3AoZC5Dcm9wKX0qKmA7XG4gICAgICByZXR1cm4gYCoqJHt0bF9jcm9wKGQuQ3JvcCl9KipgO1xuICAgIH0pXG4gICAgLmpvaW4oXCIsIFwiKTtcbiAgY29uc3QgbGFuZ1RvcDUgPSBfbGFuZyhsYW5nQmFzZVBhdGgudG9wNSk7XG4gIGNvbnN0IGxhbmdUb3A1Rm9ybWF0ID0gbGFuZ1RvcDUucmVwbGFjZShcbiAgICBMYW5nLmdldFJlZ2V4Rm9yTmFtZWRJbnNlcnRpb24oXCJ0b3A1Q3JvcHNCeVByYWN0aWNlc1N0cmluZ1wiKSxcbiAgICB0b3A1Q3JvcHNCeVByYWN0aWNlc1N0cmluZ1xuICApO1xuICBjb25zdCBpbnNpZ2h0VG9wNSA9IG1kYCR7bGFuZ1RvcDVGb3JtYXR9YDtcblxuICAvLyBjcm9wIHNlbGVjdGlvblxuICBjb25zdCBzZWxlY3RlZENyb3AgPSBzZWxlY3Rpb247XG4gIGNvbnN0IGRhdGFDcm9wID0gVC50aWR5KFxuICAgIGRhdGEsXG4gICAgVC5maWx0ZXIoKGQpID0+IGQuQ3JvcCA9PSBzZWxlY3RlZENyb3ApXG4gICk7XG5cbiAgLy8gY3JvcCBvdmVydmlld1xuICBjb25zdCBjcm9wT3ZlcnZpZXcgPSBULnRpZHkoXG4gICAgZGF0YUNyb3AsXG4gICAgVC5zdW1tYXJpemUoe1xuICAgICAgdG90YWxPYnM6IFQuc3VtKFwiTl9PYnNcIiksXG4gICAgICB0b3RhbFByYWN0aWNlczogVC5uKClcbiAgICB9KVxuICApPy5bMF07XG4gIGNvbnN0IGxhbmdDcm9wT3ZlcnZpZXcgPSBfbGFuZyhsYW5nQmFzZVBhdGguY3JvcE92ZXJ2aWV3KTtcbiAgY29uc3QgbGFuZ0Nyb3BPdmVydmlld0l0ZW1zID0gW1xuICAgIHsgaW5zZXJ0TmFtZTogXCJzZWxlY3RlZENyb3BcIiwgdmFsdWU6IExhbmcudG9TZW50ZW5jZUNhc2UodGxfY3JvcF9hcnRpY2xlKHNlbGVjdGVkQ3JvcCkpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcInRvdGFsT2JzXCIsIHZhbHVlOiBmb3JtYXRDb21tYShjcm9wT3ZlcnZpZXcudG90YWxPYnMpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcInRvdGFsUHJhY3RpY2VzXCIsIHZhbHVlOiBjcm9wT3ZlcnZpZXcudG90YWxQcmFjdGljZXMgfVxuICBdO1xuICBjb25zdCBpbnNpZ2h0Q3JvcE92ZXJ2aWV3ID0gbGFuZ0Nyb3BPdmVydmlld0l0ZW1zLnJlZHVjZSgob3ZlcnZpZXcsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gb3ZlcnZpZXcucmVwbGFjZShcbiAgICAgIExhbmcuZ2V0UmVnZXhGb3JOYW1lZEluc2VydGlvbihpdGVtLmluc2VydE5hbWUpLFxuICAgICAgaXRlbS52YWx1ZVxuICAgICk7XG4gIH0sIGxhbmdDcm9wT3ZlcnZpZXcpO1xuXG4gIC8vIHBvc2l0aXZlIHlpZWxkXG4gIGNvbnN0IGNyb3BQb3NpdGl2ZSA9IFQudGlkeShcbiAgICBkYXRhQ3JvcCxcbiAgICBULmZpbHRlcigoZCkgPT4gZC5NZWFuX0RpZmZlcmVuY2UgPiAwKVxuICApPy5sZW5ndGg7XG4gIGNvbnN0IGxhbmdDcm9wUG9zaXRpdmUgPSBfbGFuZyhsYW5nQmFzZVBhdGguY3JvcFBvc2l0aXZlLm1haW4pO1xuICBjb25zdCBsYW5nQ3JvcFN1YnN0cmluZyA9IGAqKiR7Y3JvcFBvc2l0aXZlfSoqICR7XG4gICAgY3JvcFBvc2l0aXZlID09IDFcbiAgICAgID8gX2xhbmcobGFuZ0Jhc2VQYXRoLmNyb3BQb3NpdGl2ZS5zaW5ndWxhcilcbiAgICAgIDogX2xhbmcobGFuZ0Jhc2VQYXRoLmNyb3BQb3NpdGl2ZS5wbHVyYWwpXG4gIH1gO1xuICBjb25zdCBpbnNpZ2h0Q3JvcFBvc2l0aXZlID0gbGFuZ0Nyb3BQb3NpdGl2ZS5yZXBsYWNlKFxuICAgIExhbmcuZ2V0UmVnZXhGb3JOYW1lZEluc2VydGlvbihcImNyb3BQb3NpdGl2ZVRleHRcIiksXG4gICAgbGFuZ0Nyb3BTdWJzdHJpbmdcbiAgKTtcblxuICAvLyB0b3AgZm9yIHNlbGVjdGVkIGNyb3BcbiAgY29uc3QgbiA9IDI7IC8vICMgdG9wIGNyb3BzIHRvIGluY2x1ZGVcbiAgY29uc3QgdG9wQ3JvcCA9IFQudGlkeShcbiAgICBkYXRhQ3JvcCxcbiAgICBULnNsaWNlTWF4KG4sIFwiTWVhbl9EaWZmZXJlbmNlXCIpLFxuICAgIFQuYXJyYW5nZShULmRlc2MoXCJNZWFuX0RpZmZlcmVuY2VcIikpXG4gICk7XG4gIGNvbnN0IGRpZmYxID0gdG9wQ3JvcD8uWzBdO1xuICBjb25zdCBkaWZmMiA9IHRvcENyb3A/LlsxXTtcblxuICBjb25zdCBsYW5nRGlmZkZpcnN0ID0gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZGaXJzdC5tYWluKTtcbiAgY29uc3QgbGFuZ0RpZmZGaXJzdF9pbmNEZWMgPVxuICAgIGRpZmYxLk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmluY3JlYXNlKVxuICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5kZWNyZWFzZSk7XG4gIGNvbnN0IGxhbmdEaWZmRmlyc3Rfb2JzZXJ2YXRpb25zID0gZGlmZjEuTl9PYnM7XG4gIGNvbnN0IGxhbmdEaWZmRmlyc3RJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IHRsX3ByYWMoZGlmZjEuUHJhY3RpY2UpIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJpbmNEZWNcIixcbiAgICAgIHZhbHVlOlxuICAgICAgICBkaWZmMS5NZWFuX0RpZmZlcmVuY2UgPj0gMFxuICAgICAgICAgID8gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMuaW5jcmVhc2UpXG4gICAgICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5kZWNyZWFzZSlcbiAgICB9LFxuICAgIHsgaW5zZXJ0TmFtZTogXCJtZWFuRGlmZlwiLCB2YWx1ZTogZm9ybWF0TnVtKGRpZmYxLk1lYW5fRGlmZmVyZW5jZSkgfSxcbiAgICB7IGluc2VydE5hbWU6IFwib2JzZXJ2YXRpb25Db3VudFwiLCB2YWx1ZTogZm9ybWF0Q29tbWEoZGlmZjEuTl9PYnMpIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJvYnNlcnZhdGlvblN0cmluZ1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGRpZmYxLk5fT2JzID4gMVxuICAgICAgICAgID8gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24ucGx1cmFsKVxuICAgICAgICAgIDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24uc2luZ3VsYXIpXG4gICAgfVxuICBdO1xuICBjb25zdCBpbnNpZ2h0RGlmZkZpcnN0ID0gbGFuZ0RpZmZGaXJzdEl0ZW1zLnJlZHVjZSgob3ZlcnZpZXcsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gb3ZlcnZpZXcucmVwbGFjZShcbiAgICAgIExhbmcuZ2V0UmVnZXhGb3JOYW1lZEluc2VydGlvbihpdGVtLmluc2VydE5hbWUpLFxuICAgICAgaXRlbS52YWx1ZVxuICAgICk7XG4gIH0sIGxhbmdEaWZmRmlyc3QpO1xuXG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kID0gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZTZWNvbmQubWFpbik7XG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kX2luY0RlYyA9XG4gICAgZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmluY3JlYXNlKVxuICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5kZWNyZWFzZSk7XG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kX29ic2VydmF0aW9ucyA9IGRpZmYyPy5OX09icztcbiAgY29uc3QgbGFuZ0RpZmZTZWNvbmRJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IHRsX3ByYWMoZGlmZjI/LlByYWN0aWNlKSB9LFxuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwiaW5jRGVjXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5pbmNyZWFzZSlcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmRlY3JlYXNlKVxuICAgIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcIm1lYW5EaWZmXCIsIHZhbHVlOiBmb3JtYXROdW0oZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSkgfSxcbiAgICB7IGluc2VydE5hbWU6IFwib2JzZXJ2YXRpb25Db3VudFwiLCB2YWx1ZTogZm9ybWF0Q29tbWEoZGlmZjI/Lk5fT2JzKSB9LFxuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwib2JzZXJ2YXRpb25TdHJpbmdcIixcbiAgICAgIHZhbHVlOlxuICAgICAgICBkaWZmMj8uTl9PYnMgPiAxXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5wbHVyYWwpXG4gICAgICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5zaW5ndWxhcilcbiAgICB9XG4gIF07XG4gIGNvbnN0IGluc2lnaHREaWZmU2Vjb25kID0gZGlmZjJcbiAgICA/IGxhbmdEaWZmU2Vjb25kSXRlbXMucmVkdWNlKChvdmVydmlldywgaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gb3ZlcnZpZXcucmVwbGFjZShcbiAgICAgICAgICBMYW5nLmdldFJlZ2V4Rm9yTmFtZWRJbnNlcnRpb24oaXRlbS5pbnNlcnROYW1lKSxcbiAgICAgICAgICBpdGVtLnZhbHVlXG4gICAgICAgICk7XG4gICAgICB9LCBsYW5nRGlmZlNlY29uZClcbiAgICA6IFwiXCI7XG5cbiAgcmV0dXJuIG1kYCR7aW5zaWdodFRvcDV9XG5cbiR7aW5zaWdodENyb3BPdmVydmlld30gJHtpbnNpZ2h0Q3JvcFBvc2l0aXZlfVxuXG4ke2luc2lnaHREaWZmRmlyc3R9ICR7aW5zaWdodERpZmZTZWNvbmR9YDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzZWxlY3RDcm9wTWVhbkRpZmZBRVogPSB7XG4gIGNvbnN0IGRhdGEgPSBbXG4gICAgLi4ubmV3IFNldChkYXRhX21lYW5EaWZmX2FlelByYWN0aWNlQ3JvcF9uZXcubWFwKChkKSA9PiBkLkNyb3ApKVxuICBdXG4gICAgLm1hcCgoZCkgPT4ge1xuICAgICAgcmV0dXJuIHsgZmllbGQ6IGQsIHRyYW5zbGF0aW9uOiB0ZC5Dcm9wLnZhbHVlcz8uW2RdIH07XG4gICAgfSlcbiAgICAuc29ydCgoYSwgYikgPT4gX2xhbmcoYS50cmFuc2xhdGlvbikgPiBfbGFuZyhiLnRyYW5zbGF0aW9uKSk7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcodGQuQ3JvcCksXG4gICAgdmFsdWU6IGRhdGEuZmluZCgoeCkgPT4geC5maWVsZCA9PSBcIk1haXplXCIpLFxuICAgIGZvcm1hdDogKHgpID0+IF9sYW5nKHgudHJhbnNsYXRpb24pXG4gIH0pO1xufVxuXG52aWV3b2YgcmFkaW9Tb3J0RG90UGxvdENyb3BBRVpfbmV3ID0ge1xuICBjb25zdCBkYXRhID0gW1xuICAgIHtcbiAgICAgIGtleTogXCJtZWFuXCIsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmlucHV0cy5yYWRpb1NvcnQuZmllbGRzLm1lYW4pLFxuICAgICAgY2hhbm5lbDogXCJ4XCIsXG4gICAgICByZXZlcnNlOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFwib2JzZXJ2YXRpb25zXCIsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmlucHV0cy5yYWRpb1NvcnQuZmllbGRzLm9ic2VydmF0aW9ucyksXG4gICAgICBjaGFubmVsOiBcIm5PYnNcIixcbiAgICAgIHJldmVyc2U6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgIGtleTogXCJhbHBoYVwiLFxuICAgICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5pbnB1dHMucmFkaW9Tb3J0LmZpZWxkcy5hbHBoYSksXG4gICAgICBjaGFubmVsOiBcInlcIixcbiAgICAgIHJldmVyc2U6IGZhbHNlXG4gICAgfVxuICBdO1xuICByZXR1cm4gSW5wdXRzLnJhZGlvKGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLnNvcnQpLFxuICAgIGZvcm1hdDogKGQpID0+IGQubGFiZWwsXG4gICAgdmFsdWU6IGRhdGEuZmluZCgoeCkgPT4geC5rZXkgPT09IFwibWVhblwiKVxuICB9KTtcbn1cblxudmlld29mIGFlelNlbGVjdF9uZXcgPSB7XG4gIGNvbnN0IGRhdGEgPSBkYXRhX21lYW5EaWZmX2FlelByYWN0aWNlQ3JvcF9uZXcuZmlsdGVyKFxuICAgIChkKSA9PiBkLkNyb3AgPT09IHNlbGVjdENyb3BNZWFuRGlmZkFFWi5maWVsZFxuICApO1xuICBjb25zdCBhZXpOYW1lcyA9IGQzXG4gICAgLmdyb3VwcyhkYXRhLCAoZCkgPT4gZC5BRVpfQ2xhc3NfRkFPKVxuICAgIC5tYXAoKGQpID0+IGRbMF0pXG4gICAgLnNvcnQoKTtcbiAgY29uc3Qgb3B0aW9ucyA9IGFlek5hbWVzLm1hcCgoZCkgPT4gKHtcbiAgICBmaWVsZDogZCxcbiAgICB0cmFuc2xhdGlvbjogdGQuQUVaX0NsYXNzX0ZBTy52YWx1ZXM/LltkXVxuICB9KSk7XG4gIGNvbnN0IG51bGxWYWx1ZSA9IHtcbiAgICBmaWVsZDogbnVsbCxcbiAgICB0cmFuc2xhdGlvbjogbmJUZXh0LmlucHV0cy5kZWZhdWx0cy5hZXpcbiAgfTtcbiAgY29uc3QgaW5wdXROYW1lcyA9IFtudWxsVmFsdWUsIC4uLm9wdGlvbnNdO1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChpbnB1dE5hbWVzLCB7XG4gICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LmxhYmVscy5oaWdobGlnaHRBZXopLFxuICAgIHZhbHVlOiBhZXpOYW1lcyxcbiAgICBmb3JtYXQ6IHggPT4gX2xhbmcoeC50cmFuc2xhdGlvbilcbiAgfSk7XG59XG5cbnZpZXdvZiB0b2dnbGVDSXNDcm9wQUVaX25ldyA9IHtcbiAgY29uc3QgZGF0YSA9IFtcbiAgICBfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0LmlucHV0cy50b2dnbGVDb25mSW50LmZpZWxkcy52aXNpYmxlKVxuICBdO1xuICByZXR1cm4gSW5wdXRzLmNoZWNrYm94KGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLmNvbmZpZGVuY2VJbnRlcnZhbHMpXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5wbG90RG90QUVaX25ldyA9IHtcbiAgY29uc3QgYmFzZURhdGEgPSBkYXRhX21lYW5EaWZmX2FlelByYWN0aWNlQ3JvcF9uZXc7XG4gIGNvbnN0IHBsb3REYXRhID0gYmFzZURhdGEuZmlsdGVyKFxuICAgIChkKSA9PiBkLkNyb3AgPT09IHNlbGVjdENyb3BNZWFuRGlmZkFFWi5maWVsZFxuICApO1xuICBjb25zdCBhZXpEYXRhID0gVC50aWR5KFxuICAgIHBsb3REYXRhLFxuICAgIFQuZmlsdGVyKChkKSA9PiB7XG4gICAgICBpZiAoYWV6U2VsZWN0X25ldy5maWVsZCA9PSBudWxsKSByZXR1cm4gZDtcbiAgICAgIHJldHVybiBkLkFFWl9DbGFzc19GQU8gPT0gYWV6U2VsZWN0X25ldy5maWVsZDtcbiAgICB9KSxcbiAgICBULmFycmFuZ2UoXCJNZWFuX0RpZmZlcmVuY2VcIilcbiAgKTtcbiAgY29uc3QgY29sb3JEb21haW4gPSBhZXpDb2xvcl9uZXcuZG9tYWluO1xuICBjb25zdCBjb2xvclJhbmdlID0gYWV6Q29sb3JfbmV3LnJhbmdlO1xuICBjb25zdCBtYXJnaW5Cb3R0b20gPSAwO1xuICBjb25zdCBtYXJnaW5Ub3AgPSA4MDtcbiAgY29uc3QgeUhlaWdodCA9IDI1O1xuICBjb25zdCBoZWlnaHQgPVxuICAgIG1hcmdpblRvcCArXG4gICAgbWFyZ2luQm90dG9tICtcbiAgICBkMy5ncm91cChwbG90RGF0YSwgKGQpID0+IGQuUHJhY3RpY2UpLnNpemUgKiB5SGVpZ2h0O1xuICBjb25zdCBfZm9ybWF0TnVtID0gZm9ybWF0TnVtO1xuICBjb25zdCBfdG9nZ2xlQ0lzID0gdG9nZ2xlQ0lzQ3JvcEFFWl9uZXc7XG4gIGNvbnN0IF9yYWRpb1NvcnQgPSByYWRpb1NvcnREb3RQbG90Q3JvcEFFWl9uZXc7XG4gIGNvbnN0IGxhbmdMb29rdXAgPSB7XG4gICAgeExhYmVsOiBfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0LmxhYmVscy54TWVhbkRpZmYpLFxuICAgIHRvb2x0aXA6IHtcbiAgICAgIGFlejogX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC50b29sdGlwcy5hZXopLFxuICAgICAgbWVhbkRpZmY6IF9sYW5nKG5iVGV4dC5wcmFjdGljYWxJbXBhY3QudG9vbHRpcHMubWVhbkRpZmYpLFxuICAgICAgbWVhbkNvbnRyb2w6IF9sYW5nKG5iVGV4dC5wcmFjdGljYWxJbXBhY3QudG9vbHRpcHMubWVhbkNvbnRyb2wpLFxuICAgICAgY3JvcDogTGFuZy50b1NlbnRlbmNlQ2FzZShcbiAgICAgICAgX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMuY3JvcC5zaW5ndWxhcilcbiAgICAgICksXG4gICAgICBjaUxvOiBfbGFuZyhuYlRleHQucHJhY3RpY2FsSW1wYWN0LnRvb2x0aXBzLmNpTG93ZXIpLFxuICAgICAgY2lIaTogX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC50b29sdGlwcy5jaVVwcGVyKSxcbiAgICAgIG9iczogTGFuZy50b1NlbnRlbmNlQ2FzZShcbiAgICAgICAgX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24ucGx1cmFsKVxuICAgICAgKSxcbiAgICAgIHByYWN0aWNlOiBMYW5nLnRvU2VudGVuY2VDYXNlKFxuICAgICAgICBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5wcmFjdGljZS5zaW5ndWxhcilcbiAgICAgIClcbiAgICB9XG4gIH07XG4gIGNvbnN0IHkgPSAoZCkgPT4gX2xhbmcodGQuUHJhY3RpY2UudmFsdWVzPy5bZF0pO1xuICBjb25zdCBjb2xvciA9IChkKSA9PiBfbGFuZyh0ZC5BRVpfQ2xhc3NfRkFPLnZhbHVlcz8uW2RdKTtcblxuICByZXR1cm4gUGxvdC5wbG90KHtcbiAgICBoZWlnaHQsXG4gICAgbWFyZ2luQm90dG9tLFxuICAgIG1hcmdpblRvcCxcbiAgICBtYXJnaW5MZWZ0OiAyMDAsXG4gICAgbWFyZ2luUmlnaHQ6IDcwLFxuICAgIHdpZHRoOiA5MDAsXG4gICAgeDoge1xuICAgICAgYXhpczogXCJ0b3BcIixcbiAgICAgIG5pY2U6IHRydWUsXG4gICAgICBncmlkOiB0cnVlLFxuICAgICAgbGFiZWw6IGxhbmdMb29rdXAueExhYmVsLFxuICAgICAgbGFiZWxBbmNob3I6IFwiY2VudGVyXCIsXG4gICAgICBsYWJlbE9mZnNldDogNDAsXG4gICAgICBsYWJlbEFycm93OiBcIm5vbmVcIlxuICAgIH0sXG4gICAgeToge1xuICAgICAgdGlja1NpemU6IDAsXG4gICAgICBsYWJlbDogbnVsbFxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIGRvbWFpbjogY29sb3JEb21haW4sXG4gICAgICByYW5nZTogY29sb3JSYW5nZVxuICAgIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIC8vIG1haW4geS1heGlzXG4gICAgICBQbG90LmF4aXNZKHtcbiAgICAgICAgdGlja1NpemU6IDBcbiAgICAgIH0pLFxuICAgICAgLy8gcG9pbnRlciB3aGl0ZS1vdXRcbiAgICAgIFBsb3QuYXhpc1koXG4gICAgICAgIFBsb3QucG9pbnRlclkoe1xuICAgICAgICAgIGZpbGw6IFwid2hpdGVcIixcbiAgICAgICAgICB0ZXh0U3Ryb2tlOiBcIndoaXRlXCIsXG4gICAgICAgICAgdGV4dFN0cm9rZVdpZHRoOiAyLFxuICAgICAgICAgIHRpY2tTaXplOiAwXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgLy8gYm9sZCBwb2ludGVyXG4gICAgICBQbG90LmF4aXNZKFxuICAgICAgICBQbG90LnBvaW50ZXJZKHtcbiAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIixcbiAgICAgICAgICB0aWNrU2l6ZTogMFxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIC8vIHplcm8gcG9pbnRcbiAgICAgIFBsb3QucnVsZVgoWzBdLCB7IHN0cm9rZTogXCIjMzMzXCIsIHN0cm9rZURhc2hhcnJheTogWzRdIH0pLFxuICAgICAgLy8gYmFzZSBkb3RzXG4gICAgICBQbG90LmRvdChwbG90RGF0YSwge1xuICAgICAgICB4OiBcIk1lYW5fRGlmZmVyZW5jZVwiLFxuICAgICAgICB5OiAoZCkgPT4geShkLlByYWN0aWNlKSxcbiAgICAgICAgc29ydDogeyB5OiBfcmFkaW9Tb3J0LmNoYW5uZWwsIHJldmVyc2U6IF9yYWRpb1NvcnQucmV2ZXJzZSB9LFxuICAgICAgICByOiA4LFxuICAgICAgICBzdHJva2U6IFwiI2ZmZlwiLFxuICAgICAgICBzdHJva2VXaWR0aDogMC43LFxuICAgICAgICBmaWxsOiBcIiNlZmVmZWZcIixcbiAgICAgICAgY2hhbm5lbHM6IHtcbiAgICAgICAgICBuT2JzOiB7XG4gICAgICAgICAgICBsYWJlbDogXCIjIE9ic2VydmF0aW9uc1wiLFxuICAgICAgICAgICAgdmFsdWU6IFwiTl9PYnNcIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSksXG4gICAgICAvLyBzZWxlY3Rpb246IHNwYW4gbGluZXM6IENJXG4gICAgICBQbG90LnJ1bGVZKF90b2dnbGVDSXMubGVuZ3RoID4gMCA/IGFlekRhdGEgOiBbXSwge1xuICAgICAgICB5OiAoZCkgPT4geShkLlByYWN0aWNlKSxcbiAgICAgICAgeDE6IChkKSA9PiAoZC5Mb3dlciA9PSBcIk5BXCIgPyBudWxsIDogZC5Mb3dlciksXG4gICAgICAgIHgyOiAoZCkgPT4gKGQuVXBwZXIgPT0gXCJOQVwiID8gbnVsbCA6IGQuVXBwZXIpLFxuICAgICAgICBzdHJva2U6IFwiIzMzM1wiXG4gICAgICB9KSxcbiAgICAgIC8vIHNlbGVjdGlvbjogbWVhbiBkaWZmIGRvdHNcbiAgICAgIFBsb3QuZG90KGFlekRhdGEsIHtcbiAgICAgICAgeDogXCJNZWFuX0RpZmZlcmVuY2VcIixcbiAgICAgICAgeTogKGQpID0+IHkoZC5QcmFjdGljZSksXG4gICAgICAgIGZpbGw6IChkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGNvbG9yKGQuQUVaX0NsYXNzX0ZBTyk7XG4gICAgICAgIH0sXG4gICAgICAgIHI6IDgsXG4gICAgICAgIHN0cm9rZTogXCIjZmZmXCIsXG4gICAgICAgIHN0cm9rZVdpZHRoOiAwLjcsXG4gICAgICAgIGNoYW5uZWxzOiB7XG4gICAgICAgICAgYWV6OiB7XG4gICAgICAgICAgICBsYWJlbDogbGFuZ0xvb2t1cC50b29sdGlwLmFleixcbiAgICAgICAgICAgIHZhbHVlOiAoZCkgPT4gY29sb3IoZC5BRVpfQ2xhc3NfRkFPKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgbk9iczoge1xuICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rdXAudG9vbHRpcC5vYnMsXG4gICAgICAgICAgICB2YWx1ZTogXCJOX09ic1wiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkaWZmOiB7XG4gICAgICAgICAgICBsYWJlbDogbGFuZ0xvb2t1cC50b29sdGlwLm1lYW5EaWZmLFxuICAgICAgICAgICAgdmFsdWU6IFwiTWVhbl9EaWZmZXJlbmNlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbnRyb2w6IHtcbiAgICAgICAgICAgIGxhYmVsOiBsYW5nTG9va3VwLnRvb2x0aXAubWVhbkNvbnRyb2wsXG4gICAgICAgICAgICB2YWx1ZTogXCJNZWFuX0NvbnRyb2xcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgcHJhYzoge1xuICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rdXAudG9vbHRpcC5wcmFjdGljZSxcbiAgICAgICAgICAgIHZhbHVlOiAoZCkgPT4geShkLlByYWN0aWNlKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JvcDoge1xuICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rdXAudG9vbHRpcC5jcm9wLFxuICAgICAgICAgICAgdmFsdWU6IFwiQ3JvcFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaUxvdzoge1xuICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rdXAudG9vbHRpcC5jaUxvLFxuICAgICAgICAgICAgdmFsdWU6IFwiTG93ZXJcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY2lIaWdoOiB7XG4gICAgICAgICAgICBsYWJlbDogbGFuZ0xvb2t1cC50b29sdGlwLmNpSGksXG4gICAgICAgICAgICB2YWx1ZTogXCJVcHBlclwiXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0aXA6IHtcbiAgICAgICAgICBmb3JtYXQ6IHtcbiAgICAgICAgICAgIHg6IGZhbHNlLFxuICAgICAgICAgICAgeTogZmFsc2UsXG4gICAgICAgICAgICBmaWxsOiBmYWxzZSxcbiAgICAgICAgICAgIHByYWM6IGZhbHNlLFxuICAgICAgICAgICAgY3JvcDogZmFsc2UsXG4gICAgICAgICAgICBhZXo6IHRydWUsXG4gICAgICAgICAgICBkaWZmOiAoZCkgPT4gX2Zvcm1hdE51bShkKSxcbiAgICAgICAgICAgIGNvbnRyb2w6IChkKSA9PiBfZm9ybWF0TnVtKGQpLFxuICAgICAgICAgICAgY2lMb3c6IChkKSA9PiBfZm9ybWF0TnVtKGQpLFxuICAgICAgICAgICAgY2lIaWdoOiAoZCkgPT4gX2Zvcm1hdE51bShkKSxcbiAgICAgICAgICAgIG5PYnM6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgLy8gZG90IGhpZ2hsaWdodCBvbiBob3ZlclxuICAgICAgUGxvdC5kb3QoXG4gICAgICAgIGFlekRhdGEsXG4gICAgICAgIFBsb3QucG9pbnRlcih7XG4gICAgICAgICAgeDogXCJNZWFuX0RpZmZlcmVuY2VcIixcbiAgICAgICAgICB5OiAoZCkgPT4geShkLlByYWN0aWNlKSxcbiAgICAgICAgICByOiA4LFxuICAgICAgICAgIGZpbGw6IChkKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZC5BRVpfQ2xhc3NfRkFPO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc3Ryb2tlOiBcIiMzMzNcIixcbiAgICAgICAgICBzdHJva2VXaWR0aDogMC43LFxuICAgICAgICAgIGNoYW5uZWxzOiB7XG4gICAgICAgICAgICBuT2JzOiB7XG4gICAgICAgICAgICAgIGxhYmVsOiBcIiMgT2JzZXJ2YXRpb25zXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBcIk5fT2JzXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgLy8gb2JzZXJ2YXRpb24gY291bnRzXG4gICAgICBQbG90LnRleHRZKFxuICAgICAgICBhZXpEYXRhLFxuICAgICAgICBQbG90Lm1hcChcbiAgICAgICAgICB7IHRleHQ6ICh2YWx1ZXMpID0+IHZhbHVlcy5tYXAoKGQpID0+IGQgKyBcIiBvYnMuXCIpIH0sXG4gICAgICAgICAgUGxvdC5ncm91cFkoXG4gICAgICAgICAgICB7IHRleHQ6IFwic3VtXCIgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgeTogKGQpID0+IHkoZC5QcmFjdGljZSksXG4gICAgICAgICAgICAgIHRleHQ6IFwiTl9PYnNcIixcbiAgICAgICAgICAgICAgZnJhbWVBbmNob3I6IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgdGV4dEFuY2hvcjogXCJzdGFydFwiLFxuICAgICAgICAgICAgICBkeDogMTZcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICksXG4gICAgICAvLyBkaWdpdGFsIHdoaXRlLW91dFxuICAgICAgUGxvdC50ZXh0WShcbiAgICAgICAgYWV6RGF0YSxcbiAgICAgICAgUGxvdC5wb2ludGVyWShcbiAgICAgICAgICBQbG90Lm1hcChcbiAgICAgICAgICAgIHsgdGV4dDogKHZhbHVlcykgPT4gdmFsdWVzLm1hcCgoZCkgPT4gZCArIFwiIG9icy5cIikgfSxcbiAgICAgICAgICAgIFBsb3QuZ3JvdXBZKFxuICAgICAgICAgICAgICB7IHRleHQ6IFwic3VtXCIgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICAgICAgICAgIHRleHQ6IFwiTl9PYnNcIixcbiAgICAgICAgICAgICAgICBmcmFtZUFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgICBkeDogMTYsXG4gICAgICAgICAgICAgICAgZmlsbDogXCJ3aGl0ZVwiLFxuICAgICAgICAgICAgICAgIHN0cm9rZTogXCJ3aGl0ZVwiLFxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAyXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICksXG4gICAgICAvLyBvYnNlcnZhdGlvbiBjb3VudHMgYm9sZCBob3ZlclxuICAgICAgUGxvdC50ZXh0WShcbiAgICAgICAgYWV6RGF0YSxcbiAgICAgICAgUGxvdC5wb2ludGVyWShcbiAgICAgICAgICBQbG90Lm1hcChcbiAgICAgICAgICAgIHsgdGV4dDogKHZhbHVlcykgPT4gdmFsdWVzLm1hcCgoZCkgPT4gZCArIFwiIG9icy5cIikgfSxcbiAgICAgICAgICAgIFBsb3QuZ3JvdXBZKFxuICAgICAgICAgICAgICB7IHRleHQ6IFwic3VtXCIgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHk6IChkKSA9PiB5KGQuUHJhY3RpY2UpLFxuICAgICAgICAgICAgICAgIHRleHQ6IFwiTl9PYnNcIixcbiAgICAgICAgICAgICAgICBmcmFtZUFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgICBkeDogMTYsXG4gICAgICAgICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIF1cbiAgfSk7XG59XG5cbnBsb3REb3RBRVpfbmV3LmxlZ2VuZCgnY29sb3InLCB7Y29sdW1uczogM30pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGNvbnN0IGxhbmdSb290ID0gbmJUZXh0O1xuICBjb25zdCBsYW5nQmFzZVBhdGggPSBsYW5nUm9vdC5wcmFjdGljYWxJbXBhY3QubWVhbkNyb3BEaWZmQUVaLmluc2lnaHRzOyAvLyBiYXNlIHBhdGggZm9yIGxhbmd1YWdlXG5cbiAgLy8gdG9wIHByYWN0aWNlIGJ5IGFlelxuICBjb25zdCBzZWxlY3RlZENyb3AgPSBzZWxlY3RDcm9wTWVhbkRpZmZBRVouZmllbGQ7XG5cbiAgLy8gY3JvcCBzZWxlY3Rpb25cbiAgY29uc3QgZGF0YUNyb3BOb0FFWiA9IFQudGlkeShcbiAgICBkYXRhX21lYW5EaWZmX2FlelByYWN0aWNlQ3JvcF9uZXcsXG4gICAgVC5maWx0ZXIoKGQpID0+IGQuQ3JvcCA9PT0gc2VsZWN0ZWRDcm9wKVxuICApO1xuXG4gIC8vIGZpbmQgYWV6IHdpdGggdGhlIGxhcmdlc3QgbWVhbiBkaWZmXG4gIGNvbnN0IG1heE1lYW5EaWZmID0gVC50aWR5KFxuICAgIGRhdGFDcm9wTm9BRVosXG4gICAgVC5zbGljZU1heCgxLCBcIk1lYW5fRGlmZmVyZW5jZVwiKVxuICApPy5bMF07XG5cbiAgLy8gdXNlIGFleiB3aXRoIG1heCB2YWx1ZSBmb3Igbm8gaGlnaGxpZ2h0XG4gIGNvbnN0IHNlbGVjdGVkQUVaID1cbiAgICBhZXpTZWxlY3RfbmV3LmZpZWxkID09IG51bGwgPyBtYXhNZWFuRGlmZi5BRVpfQ2xhc3NfRkFPIDogYWV6U2VsZWN0X25ldy5maWVsZDtcbiAgY29uc3Qgc2VsZWN0ZWRBRVpUcmFuc2xhdGVkID0gX2xhbmcodGQuQUVaX0NsYXNzX0ZBTy52YWx1ZXNbc2VsZWN0ZWRBRVpdKTtcblxuICBjb25zdCBkYXRhQ3JvcCA9IFQudGlkeShcbiAgICBkYXRhQ3JvcE5vQUVaLFxuICAgIFQuZmlsdGVyKChkKSA9PiBkLkFFWl9DbGFzc19GQU8gPT0gc2VsZWN0ZWRBRVopXG4gICk7XG5cbiAgLy8gc2VsZWN0ZWQgYWV6IHNxdWFyZVxuICBjb25zdCBhZXpTd2F0Y2hDb2xvciA9XG4gICAgYWV6Q29sb3JfbmV3LnJhbmdlW2FlekNvbG9yX25ldy5kb21haW4uaW5kZXhPZihzZWxlY3RlZEFFWlRyYW5zbGF0ZWQpXTtcbiAgY29uc3Qgc3F1YXJlU2l6ZSA9IDEzO1xuICBjb25zdCBhZXpTcXVhcmUgPSBgPHN2ZyB3aWR0aD1cIiR7c3F1YXJlU2l6ZX1cIiBoZWlnaHQ9XCIke3NxdWFyZVNpemV9XCI+XG4gICAgPHJlY3Qgd2lkdGg9XCIke3NxdWFyZVNpemV9XCIgaGVpZ2h0PVwiJHtzcXVhcmVTaXplfVwiIGZpbGw9JHthZXpTd2F0Y2hDb2xvcn0gIC8+XG4gIDwvc3ZnPmA7XG5cbiAgLy8gY3JvcCBvdmVydmlld1xuICBjb25zdCBjcm9wT3ZlcnZpZXcgPSBULnRpZHkoXG4gICAgZGF0YUNyb3AsXG4gICAgVC5zdW1tYXJpemUoe1xuICAgICAgdG90YWxPYnM6IFQuc3VtKFwiTl9PYnNcIiksXG4gICAgICB0b3RhbFByYWN0aWNlczogVC5uKClcbiAgICB9KVxuICApPy5bMF07XG4gIGNvbnN0IGxhbmdDcm9wT3ZlcnZpZXcgPSBfbGFuZyhcbiAgICBsYW5nQmFzZVBhdGguY3JvcE92ZXJ2aWV3Lm1haW5cbiAgKTtcbiAgY29uc3QgbGFuZ0Nyb3BPdmVydmlld0l0ZW1zID0gW1xuICAgIHsgaW5zZXJ0TmFtZTogXCJzZWxlY3RlZENyb3BcIiwgdmFsdWU6IF9sYW5nKHRkLkNyb3Bfd2l0aF9hcnRpY2xlcy52YWx1ZXNbc2VsZWN0ZWRDcm9wXSkgfSxcbiAgICB7IGluc2VydE5hbWU6IFwic2VsZWN0ZWRBRVpTcXVhcmVcIiwgdmFsdWU6IGFlelNxdWFyZSB9LFxuICAgIHsgaW5zZXJ0TmFtZTogXCJzZWxlY3RlZEFFWlwiLCB2YWx1ZTogc2VsZWN0ZWRBRVpUcmFuc2xhdGVkIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcInRvdGFsT2JzXCIsIHZhbHVlOiBmb3JtYXRDb21tYShjcm9wT3ZlcnZpZXcudG90YWxPYnMpIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJ0b3RhbE9ic1N0cmluZ1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGNyb3BPdmVydmlldy50b3RhbE9icyA9PSAxXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5zaW5ndWxhcilcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLm9ic2VydmF0aW9uLnBsdXJhbClcbiAgICB9LFxuICAgIHsgaW5zZXJ0TmFtZTogXCJ0b3RhbFByYWN0aWNlc1wiLCB2YWx1ZTogY3JvcE92ZXJ2aWV3LnRvdGFsUHJhY3RpY2VzIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJ0b3RhbFByYWN0aWNlc1N0cmluZ1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGNyb3BPdmVydmlldy50b3RhbFByYWN0aWNlcyA9PSAxXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5wcmFjdGljZS5zaW5ndWxhcilcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLnByYWN0aWNlLnBsdXJhbClcbiAgICB9XG4gIF07XG4gIGNvbnN0IGluc2lnaHRDcm9wT3ZlcnZpZXcgPSBsYW5nQ3JvcE92ZXJ2aWV3SXRlbXMucmVkdWNlKChvdmVydmlldywgaXRlbSkgPT4ge1xuICAgIHJldHVybiBvdmVydmlldy5yZXBsYWNlKFxuICAgICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKGl0ZW0uaW5zZXJ0TmFtZSksXG4gICAgICBpdGVtLnZhbHVlXG4gICAgKTtcbiAgfSwgbGFuZ0Nyb3BPdmVydmlldyk7XG5cbiAgLy8gcG9zaXRpdmUgeWllbGRcbiAgY29uc3QgY3JvcFBvc2l0aXZlID0gVC50aWR5KFxuICAgIGRhdGFDcm9wLFxuICAgIFQuZmlsdGVyKChkKSA9PiBkLk1lYW5fRGlmZmVyZW5jZSA+IDApXG4gICk/Lmxlbmd0aDtcbiAgY29uc3QgbGFuZ0Nyb3BQb3NpdGl2ZSA9IF9sYW5nKFxuICAgIG5iVGV4dC5wcmFjdGljYWxJbXBhY3QubWVhbkNyb3BEaWZmQUVaLmluc2lnaHRzLmNyb3BQb3NpdGl2ZS5tYWluXG4gICk7XG4gIGNvbnN0IGxhbmdDcm9wU3Vic3RyaW5nID0gYCoqJHtjcm9wUG9zaXRpdmV9KiogJHtcbiAgICBjcm9wUG9zaXRpdmUgPT0gMVxuICAgICAgPyBfbGFuZyhcbiAgICAgICAgICBuYlRleHQucHJhY3RpY2FsSW1wYWN0Lm1lYW5Dcm9wRGlmZkFFWi5pbnNpZ2h0cy5jcm9wUG9zaXRpdmUuc2luZ3VsYXJcbiAgICAgICAgKVxuICAgICAgOiBfbGFuZyhcbiAgICAgICAgICBuYlRleHQucHJhY3RpY2FsSW1wYWN0Lm1lYW5Dcm9wRGlmZkFFWi5pbnNpZ2h0cy5jcm9wUG9zaXRpdmUucGx1cmFsXG4gICAgICAgIClcbiAgfWA7XG4gIGNvbnN0IGluc2lnaHRDcm9wUG9zaXRpdmUgPSBsYW5nQ3JvcFBvc2l0aXZlLnJlcGxhY2UoXG4gICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKFwiY3JvcFBvc2l0aXZlVGV4dFwiKSxcbiAgICBsYW5nQ3JvcFN1YnN0cmluZ1xuICApO1xuXG4gIC8vIHRvcCBmb3Igc2VsZWN0ZWQgY3JvcFxuICBjb25zdCBuID0gMjsgLy8gIyB0b3AgY3JvcHMgdG8gaW5jbHVkZVxuICBjb25zdCB0b3BDcm9wID0gVC50aWR5KFxuICAgIGRhdGFDcm9wLFxuICAgIFQuc2xpY2VNYXgobiwgXCJNZWFuX0RpZmZlcmVuY2VcIiksXG4gICAgVC5hcnJhbmdlKFQuZGVzYyhcIk1lYW5fRGlmZmVyZW5jZVwiKSlcbiAgKTtcbiAgY29uc3QgZGlmZjEgPSB0b3BDcm9wPy5bMF07XG4gIGNvbnN0IGRpZmYyID0gdG9wQ3JvcD8uWzFdO1xuXG4gIGNvbnN0IGxhbmdEaWZmRmlyc3QgPSBfbGFuZyhsYW5nQmFzZVBhdGguZGlmZkZpcnN0Lm1haW4pO1xuICBjb25zdCBsYW5nRGlmZkZpcnN0X2luY0RlYyA9XG4gICAgZGlmZjEuTWVhbl9EaWZmZXJlbmNlID49IDBcbiAgICAgID8gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMuaW5jcmVhc2UpXG4gICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmRlY3JlYXNlKTtcbiAgY29uc3QgbGFuZ0RpZmZGaXJzdF9vYnNlcnZhdGlvbnMgPSBkaWZmMS5OX09icztcbiAgY29uc3QgbGFuZ0RpZmZGaXJzdEl0ZW1zID0gW1xuICAgIHsgaW5zZXJ0TmFtZTogXCJwcmFjdGljZVwiLCB2YWx1ZTogX2xhbmcodGQuUHJhY3RpY2UudmFsdWVzW2RpZmYxLlByYWN0aWNlXSkgfSxcbiAgICB7XG4gICAgICBpbnNlcnROYW1lOiBcImluY0RlY1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGRpZmYxLk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5pbmNyZWFzZSlcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmRlY3JlYXNlKVxuICAgIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcIm1lYW5EaWZmXCIsIHZhbHVlOiBmb3JtYXROdW0oZGlmZjEuTWVhbl9EaWZmZXJlbmNlKSB9LFxuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwib2JzZXJ2YXRpb25Db3VudFwiLFxuICAgICAgdmFsdWU6IGZvcm1hdENvbW1hKGxhbmdEaWZmRmlyc3Rfb2JzZXJ2YXRpb25zKVxuICAgIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJvYnNlcnZhdGlvblN0cmluZ1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGxhbmdEaWZmRmlyc3Rfb2JzZXJ2YXRpb25zID4gMVxuICAgICAgICAgID8gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24ucGx1cmFsKVxuICAgICAgICAgIDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24uc2luZ3VsYXIpXG4gICAgfVxuICBdO1xuICBjb25zdCBpbnNpZ2h0RGlmZkZpcnN0ID0gbGFuZ0RpZmZGaXJzdEl0ZW1zLnJlZHVjZSgob3ZlcnZpZXcsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gb3ZlcnZpZXcucmVwbGFjZShcbiAgICAgIExhbmcuZ2V0UmVnZXhGb3JOYW1lZEluc2VydGlvbihpdGVtLmluc2VydE5hbWUpLFxuICAgICAgaXRlbS52YWx1ZVxuICAgICk7XG4gIH0sIGxhbmdEaWZmRmlyc3QpO1xuXG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kID0gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZTZWNvbmQubWFpbik7XG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kX2luY0RlYyA9XG4gICAgZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmluY3JlYXNlKVxuICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5kZWNyZWFzZSk7XG4gIGNvbnN0IGxhbmdEaWZmU2Vjb25kX29ic2VydmF0aW9ucyA9IGRpZmYyPy5OX09icztcbiAgY29uc3QgbGFuZ0RpZmZTZWNvbmRJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IF9sYW5nKHRkLlByYWN0aWNlLnZhbHVlc1tkaWZmMj8uUHJhY3RpY2VdKSB9LFxuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwiaW5jRGVjXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSA+PSAwXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5pbmNyZWFzZSlcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLmRlY3JlYXNlKVxuICAgIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcIm1lYW5EaWZmXCIsIHZhbHVlOiBmb3JtYXROdW0oZGlmZjI/Lk1lYW5fRGlmZmVyZW5jZSkgfSxcbiAgICB7XG4gICAgICBpbnNlcnROYW1lOiBcIm9ic2VydmF0aW9uQ291bnRcIixcbiAgICAgIHZhbHVlOiBmb3JtYXRDb21tYShsYW5nRGlmZlNlY29uZF9vYnNlcnZhdGlvbnMpXG4gICAgfSxcbiAgICB7XG4gICAgICBpbnNlcnROYW1lOiBcIm9ic2VydmF0aW9uU3RyaW5nXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgbGFuZ0RpZmZTZWNvbmRfb2JzZXJ2YXRpb25zID4gMVxuICAgICAgICAgID8gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24ucGx1cmFsKVxuICAgICAgICAgIDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24uc2luZ3VsYXIpXG4gICAgfVxuICBdO1xuICBjb25zdCBpbnNpZ2h0RGlmZlNlY29uZCA9IGRpZmYyXG4gICAgPyBsYW5nRGlmZlNlY29uZEl0ZW1zLnJlZHVjZSgob3ZlcnZpZXcsIGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIG92ZXJ2aWV3LnJlcGxhY2UoXG4gICAgICAgICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKGl0ZW0uaW5zZXJ0TmFtZSksXG4gICAgICAgICAgaXRlbS52YWx1ZVxuICAgICAgICApO1xuICAgICAgfSwgbGFuZ0RpZmZTZWNvbmQpXG4gICAgOiBcIlwiO1xuXG4gIHJldHVybiBtZGAke2luc2lnaHRDcm9wT3ZlcnZpZXd9ICR7aW5zaWdodENyb3BQb3NpdGl2ZX1cblxuJHtpbnNpZ2h0RGlmZkZpcnN0fSAke2luc2lnaHREaWZmU2Vjb25kID8/IFwiXCJ9YDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2VsZWN0UHJhY3RpY2UgPSB7XG4gIGNvbnN0IGRhdGEgPSBkM1xuICAgIC5ncm91cHMoXG4gICAgICBkYXRhX2xjbFJpc2subWFwKChkKSA9PiBkLnByYWN0aWNlKSxcbiAgICAgIChkKSA9PiBkXG4gICAgKVxuICAgIC5tYXAoKGQpID0+IGRbMF0pXG4gICAgLnNvcnQoKTtcbiAgY29uc3Qgb3B0aW9ucyA9IGRhdGEubWFwKChkKSA9PiB7XG4gICAgcmV0dXJuIHsgZmllbGQ6IGQsIHRyYW5zbGF0aW9uOiB0ZC5QcmFjdGljZS52YWx1ZXNbZF0gfTtcbiAgfSkuc29ydCgoYSxiKSA9PiBfbGFuZyhhLnRyYW5zbGF0aW9uKSA+IF9sYW5nKGIudHJhbnNsYXRpb24pKTtcbiAgY29uc3QgbnVsbFZhbHVlID0ge1xuICAgIGZpZWxkOiBudWxsLFxuICAgIHRyYW5zbGF0aW9uOiBuYlRleHQuaW5wdXRzLmRlZmF1bHRzLnByYWN0aWNlXG4gIH07XG4gIGNvbnN0IGlucHV0RGF0YSA9IFtudWxsVmFsdWUsIC4uLm9wdGlvbnNdO1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChpbnB1dERhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLmhpZ2hsaWdodFByYWN0aWNlKSxcbiAgICBmb3JtYXQ6IHggPT4gX2xhbmcoeC50cmFuc2xhdGlvbilcbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5wbG90Umlza0JlZXN3YXJtID0ge1xuICBjb25zdCBkYXRhID0gZGF0YV9sY2xSaXNrO1xuICBjb25zdCBsYW5nTG9vayA9IHtcbiAgICBjYXB0aW9uOiBfbGFuZyhuYlRleHQucmlza3MucGxvdC5jYXB0aW9uKSxcbiAgICB4TGFiZWw6IF9sYW5nKG5iVGV4dC5yaXNrcy5wbG90LnhMYWJlbCksXG4gICAgdG9vbHRpcDoge1xuICAgICAgcHJhY3RpY2U6IExhbmcudG9TZW50ZW5jZUNhc2UoXG4gICAgICAgIF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLnByYWN0aWNlLnNpbmd1bGFyKVxuICAgICAgKSxcbiAgICAgIGNvbWJvOiBMYW5nLnRvU2VudGVuY2VDYXNlKFxuICAgICAgICBfbGFuZyhuYlRleHQucmlza3MucGxvdC50b29sdGlwLmluQ29tYmluYXRpb24pXG4gICAgICApLFxuICAgICAgY3JvcDogTGFuZy50b1NlbnRlbmNlQ2FzZShcbiAgICAgICAgX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMuY3JvcC5zaW5ndWxhcilcbiAgICAgICksXG4gICAgICBvYnM6IExhbmcudG9TZW50ZW5jZUNhc2UoXG4gICAgICAgIF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLm9ic2VydmF0aW9uLnBsdXJhbClcbiAgICAgIClcbiAgICB9XG4gIH07XG4gIGNvbnN0IF9wcmFjdGljZSA9IHNlbGVjdFByYWN0aWNlLmZpZWxkO1xuXG4gIGNvbnN0IHBsb3QgPSBQbG90LnBsb3Qoe1xuICAgIGNhcHRpb246IGxhbmdMb29rLmNhcHRpb24sXG4gICAgaGVpZ2h0OiA0MDAsXG4gICAgd2lkdGg6IDgwMCxcbiAgICBtYXJnaW5Ub3A6IDYwLFxuICAgIHg6IHtcbiAgICAgIGF4aXM6IFwidG9wXCIsXG4gICAgICBncmlkOiB0cnVlLFxuICAgICAgZG9tYWluOiBbMCwgMV0sXG4gICAgICBsYWJlbDogbGFuZ0xvb2sueExhYmVsLFxuICAgICAgbGFiZWxPZmZzZXQ6IDQwLFxuICAgICAgbGFiZWxBbmNob3I6IFwiY2VudGVyXCIsXG4gICAgICBsYWJlbEFycm93OiBcIm5vbmVcIlxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIGRvbWFpbjogWzAsIDFdLFxuICAgICAgcmFuZ2U6IGNvbG9yWWVsbG93R3JlZW4sXG4gICAgICBsZWdlbmQ6IGZhbHNlLFxuICAgICAgdW5rbm93bjogXCIjZWZlZmVmXCJcbiAgICB9LFxuICAgIHI6IHtcbiAgICAgIHJhbmdlOiBbMiwgMzBdXG4gICAgfSxcbiAgICBtYXJrczogW1xuICAgICAgUGxvdC5kb3QoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFBsb3QuZG9kZ2VZKFxuICAgICAgICAgIHsgYW5jaG9yOiBcIm1pZGRsZVwiIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgeDogXCJ2YWx1ZVwiLFxuICAgICAgICAgICAgcjogXCJvYnNlcnZhdGlvbnNcIixcbiAgICAgICAgICAgIGZpbGw6IChkKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChfcHJhY3RpY2UgPT09IG51bGwpIHJldHVybiBkLnZhbHVlOyAvLyBzaG93IGFsbCBwcmFjdGljZXNcbiAgICAgICAgICAgICAgLy8gc2hvdyBoaWdobGlnaHRlZCBwcmFjdGljZSBvbmx5XG4gICAgICAgICAgICAgIHJldHVybiBkLnByYWN0aWNlID09PSBfcHJhY3RpY2UgPyBkLnZhbHVlIDogbnVsbDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJva2U6IFwiI2ZmZlwiLFxuICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDEsXG4gICAgICAgICAgICBjaGFubmVsczoge1xuICAgICAgICAgICAgICBwcmFjdGljZToge1xuICAgICAgICAgICAgICAgIGxhYmVsOiBsYW5nTG9vay50b29sdGlwLnByYWN0aWNlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAoZCkgPT4gX2xhbmcodGQuUHJhY3RpY2UudmFsdWVzW2QucHJhY3RpY2VdKVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9kdWN0OiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rLnRvb2x0aXAuY3JvcCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogKGQpID0+IGQucHJvZHVjdFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBuT2JzOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IGxhbmdMb29rLnRvb2x0aXAub2JzLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAoZCkgPT4gZC5vYnNlcnZhdGlvbnNcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgY29tYm86IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogbGFuZ0xvb2sudG9vbHRpcC5jb21ibyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogKGQpID0+XG4gICAgICAgICAgICAgICAgICBkLmlzX2NvbWJvXG4gICAgICAgICAgICAgICAgICAgID8gTGFuZy50b1RpdGxlQ2FzZShfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC5ib29scy55ZXMpKVxuICAgICAgICAgICAgICAgICAgICA6IExhbmcudG9UaXRsZUNhc2UoX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQuYm9vbHMubm8pKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGlwOiB7XG4gICAgICAgICAgICAgIHB4OiAoZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChfcHJhY3RpY2UgPT09IG51bGwpIHJldHVybiBkLnZhbHVlOyAvLyBzaG93IGFsbCBwcmFjdGljZXNcbiAgICAgICAgICAgICAgICAvLyBzaG93IGhpZ2hsaWdodGVkIHByYWN0aWNlIG9ubHlcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcmFjdGljZSA9PT0gX3ByYWN0aWNlID8gZC52YWx1ZSA6IG51bGw7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG1heFJhZGl1czogNixcbiAgICAgICAgICAgICAgZm9ybWF0OiB7XG4gICAgICAgICAgICAgICAgeDogZmFsc2UsXG4gICAgICAgICAgICAgICAgeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZmlsbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJhY3RpY2U6IHRydWUsXG4gICAgICAgICAgICAgICAgY29tYm86IHRydWUsXG4gICAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBweDogKGQpID0+IGZvcm1hdE51bShkKSxcbiAgICAgICAgICAgICAgICBuT2JzOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIClcbiAgICBdXG4gIH0pO1xuXG4gIHJldHVybiBwbG90O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InF1aWNrSW5zaWdodHNSaXNrQmVlc3dhcm0gPSB7XG4gIGNvbnN0IGxhbmdSb290ID0gbmJUZXh0O1xuICBjb25zdCBsYW5nQmFzZVBhdGggPSBsYW5nUm9vdC5yaXNrcy5pbnNpZ2h0cy5iZWVzd2FybTsgLy8gYmFzZSBwYXRoIGZvciBsYW5ndWFnZVxuXG4gIGNvbnN0IHNlbGVjdGVkUHJhY3RpY2UgPSBzZWxlY3RQcmFjdGljZS5maWVsZDtcbiAgY29uc3QgZGF0YSA9IFQudGlkeShcbiAgICBkYXRhX2xjbFJpc2ssXG4gICAgVC5maWx0ZXIoKGQpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZFByYWN0aWNlID09IG51bGwpIHJldHVybiBkO1xuICAgICAgcmV0dXJuIGQucHJhY3RpY2UgPT0gc2VsZWN0ZWRQcmFjdGljZTtcbiAgICB9KVxuICApO1xuXG4gIGNvbnN0IGRhdGFPdmVydmlldyA9IFQudGlkeShcbiAgICBkYXRhLFxuICAgIFQuc3VtbWFyaXplKHtcbiAgICAgIHRvdGFsT2JzOiBULnN1bShcIm9ic2VydmF0aW9uc1wiKSxcbiAgICAgIHRvdGFsUHJhY3RpY2VzOiBULmNvdW50KFwicHJhY3RpY2VcIilcbiAgICB9KVxuICApPy5bMF07XG4gIGNvbnN0IG51bVByYWN0aWNlcyA9IGRhdGFPdmVydmlldy50b3RhbFByYWN0aWNlcy5sZW5ndGg7XG4gIGNvbnN0IGxhbmdEYXRhT3ZlcnZpZXdfc2VsZWN0aW9uID1cbiAgICBzZWxlY3RlZFByYWN0aWNlID09IG51bGwgPyB7cGhyYXNlOiBcImluVG90YWxcIiwgdGVtcGxhdGU6IFwidG90YWxcIn0gOiBcbiAgICB7cGhyYXNlOiBcInNwZWNpZmljSGFzXCIsIHRlbXBsYXRlOiBcInNwZWNpZmljXCJ9O1xuICBjb25zdCBsYW5nRGF0YU92ZXJ2aWV3ID0gX2xhbmcoXG4gICAgbGFuZ0Jhc2VQYXRoLmRhdGFPdmVydmlld1tsYW5nRGF0YU92ZXJ2aWV3X3NlbGVjdGlvbi50ZW1wbGF0ZV0sXG5cbiAgKTtcbiAgY29uc3QgbGFuZ0RhdGFPdmVydmlld0l0ZW1zID0gW1xuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwic3RhcnRTdHJpbmdcIixcbiAgICAgIHZhbHVlOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC5waHJhc2VzW2xhbmdEYXRhT3ZlcnZpZXdfc2VsZWN0aW9uLnBocmFzZV0pXG4gICAgfSxcbiAgICB7IGluc2VydE5hbWU6IFwidG90YWxPYnNcIiwgdmFsdWU6IGZvcm1hdENvbW1hKGRhdGFPdmVydmlldy50b3RhbE9icykgfSxcbiAgICB7XG4gICAgICBpbnNlcnROYW1lOiBcIm9ic2VydmF0aW9uU3RyaW5nXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgZGF0YU92ZXJ2aWV3LnRvdGFsT2JzID09IDFcbiAgICAgICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLm9ic2VydmF0aW9uLnNpbmd1bGFyKVxuICAgICAgICAgIDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMub2JzZXJ2YXRpb24ucGx1cmFsKVxuICAgIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcIml0ZW1cIiwgdmFsdWU6IHNlbGVjdGVkUHJhY3RpY2UgfSxcbiAgICB7IGluc2VydE5hbWU6IFwidG90YWxQcmFjdGljZXNcIiwgdmFsdWU6IG51bVByYWN0aWNlcyB9LFxuICAgIHtcbiAgICAgIGluc2VydE5hbWU6IFwicHJhY3RpY2VzU3RyaW5nXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgbnVtUHJhY3RpY2VzID09IDFcbiAgICAgICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLnByYWN0aWNlLnNpbmd1bGFyKVxuICAgICAgICAgIDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMucHJhY3RpY2UucGx1cmFsKVxuICAgIH1cbiAgXTtcbiAgY29uc3QgaW5zaWdodERhdGFPdmVydmlldyA9IGxhbmdEYXRhT3ZlcnZpZXdJdGVtcy5yZWR1Y2UoKG92ZXJ2aWV3LCBpdGVtKSA9PiB7XG4gICAgcmV0dXJuIG92ZXJ2aWV3LnJlcGxhY2UoXG4gICAgICBMYW5nLmdldFJlZ2V4Rm9yTmFtZWRJbnNlcnRpb24oaXRlbS5pbnNlcnROYW1lKSxcbiAgICAgIGl0ZW0udmFsdWVcbiAgICApO1xuICB9LCBsYW5nRGF0YU92ZXJ2aWV3KTtcblxuICAvLyB0b3AgZm9yIHNlbGVjdGVkIGNyb3BcbiAgY29uc3QgbiA9IDI7IC8vICMgdG9wIGNyb3BzIHRvIGluY2x1ZGVcbiAgY29uc3QgdG9wQ3JvcCA9IFQudGlkeShcbiAgICBkYXRhLFxuICAgIFQuc2xpY2VNYXgobiwgXCJ2YWx1ZVwiKSxcbiAgICBULmFycmFuZ2UoVC5kZXNjKFwidmFsdWVcIikpXG4gICk7XG4gIGNvbnN0IGRpZmYxID0gdG9wQ3JvcD8uWzBdO1xuICBjb25zdCBkaWZmMiA9IHRvcENyb3A/LlsxXTtcblxuICBjb25zdCBsYW5nRGlmZkZpcnN0ID0gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZGaXJzdC5tYWluKTtcbiAgY29uc3QgbGFuZ0RpZmZGaXJzdF9vYnNlcnZhdGlvbnMgPSBkaWZmMS5vYnNlcnZhdGlvbnM7XG4gIGNvbnN0IGxhbmdEaWZmRmlyc3RJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IF9sYW5nKHRkLlByYWN0aWNlLnZhbHVlc1tkaWZmMS5wcmFjdGljZV0pIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcImNyb3BcIiwgdmFsdWU6IF9sYW5nKHRkLkNyb3Bfd2l0aF9hcnRpY2xlcy52YWx1ZXNbZGlmZjEucHJvZHVjdF0pIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJjb21ib1N0cmluZ1wiLFxuICAgICAgdmFsdWU6IGRpZmYxLmlzX2NvbWJvXG4gICAgICAgID8gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZHZW5lcmFsLmNvbWJvLnBsdXJhbClcbiAgICAgICAgOiBfbGFuZyhsYW5nQmFzZVBhdGguZGlmZkdlbmVyYWwuY29tYm8uc2luZ3VsYXIpXG4gICAgfSxcbiAgICB7IGluc2VydE5hbWU6IFwicHJvYllpZWxkXCIsIHZhbHVlOiBmb3JtYXROdW0oZGlmZjEudmFsdWUpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcInRvdGFsT2JzXCIsIHZhbHVlOiBmb3JtYXRDb21tYShsYW5nRGlmZkZpcnN0X29ic2VydmF0aW9ucykgfSxcbiAgICB7XG4gICAgICBpbnNlcnROYW1lOiBcIm9ic2VydmF0aW9uU3RyaW5nXCIsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgbGFuZ0RpZmZGaXJzdF9vYnNlcnZhdGlvbnMgPiAxXG4gICAgICAgICAgPyBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5wbHVyYWwpXG4gICAgICAgICAgOiBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5zaW5ndWxhcilcbiAgICB9XG4gIF07XG4gIGNvbnN0IGluc2lnaHREaWZmRmlyc3QgPSBsYW5nRGlmZkZpcnN0SXRlbXMucmVkdWNlKChvdmVydmlldywgaXRlbSkgPT4ge1xuICAgIHJldHVybiBvdmVydmlldy5yZXBsYWNlKFxuICAgICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKGl0ZW0uaW5zZXJ0TmFtZSksXG4gICAgICBpdGVtLnZhbHVlXG4gICAgKTtcbiAgfSwgbGFuZ0RpZmZGaXJzdCk7XG5cbiAgY29uc3QgbGFuZ0RpZmZTZWNvbmQgPSBfbGFuZyhsYW5nQmFzZVBhdGguZGlmZlNlY29uZC5tYWluKTtcbiAgY29uc3QgbGFuZ0RpZmZTZWNvbmRfb2JzZXJ2YXRpb25zID0gZGlmZjI/Lm9ic2VydmF0aW9ucztcbiAgY29uc3QgbGFuZ0RpZmZTZWNvbmRJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IF9sYW5nKHRkLlByYWN0aWNlLnZhbHVlc1tkaWZmMi5wcmFjdGljZV0pIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcImNyb3BcIiwgdmFsdWU6IF9sYW5nKHRkLkNyb3Bfd2l0aF9hcnRpY2xlcy52YWx1ZXNbZGlmZjIucHJvZHVjdF0pIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJjb21ib1N0cmluZ1wiLFxuICAgICAgdmFsdWU6IGRpZmYyLmlzX2NvbWJvXG4gICAgICAgID8gX2xhbmcobGFuZ0Jhc2VQYXRoLmRpZmZHZW5lcmFsLmNvbWJvLnBsdXJhbClcbiAgICAgICAgOiBfbGFuZyhsYW5nQmFzZVBhdGguZGlmZkdlbmVyYWwuY29tYm8uc2luZ3VsYXIpXG4gICAgfSxcbiAgICB7IGluc2VydE5hbWU6IFwicHJvYllpZWxkXCIsIHZhbHVlOiBmb3JtYXROdW0oZGlmZjIudmFsdWUpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcInRvdGFsT2JzXCIsIHZhbHVlOiBmb3JtYXRDb21tYShsYW5nRGlmZlNlY29uZF9vYnNlcnZhdGlvbnMpIH0sXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJvYnNlcnZhdGlvblN0cmluZ1wiLFxuICAgICAgdmFsdWU6XG4gICAgICAgIGxhbmdEaWZmU2Vjb25kX29ic2VydmF0aW9ucyA+IDFcbiAgICAgICAgICA/IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLm9ic2VydmF0aW9uLnBsdXJhbClcbiAgICAgICAgICA6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLm9ic2VydmF0aW9uLnNpbmd1bGFyKVxuICAgIH1cbiAgXTtcbiAgY29uc3QgaW5zaWdodERpZmZTZWNvbmQgPSBkaWZmMlxuICAgID8gbGFuZ0RpZmZTZWNvbmRJdGVtcy5yZWR1Y2UoKG92ZXJ2aWV3LCBpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBvdmVydmlldy5yZXBsYWNlKFxuICAgICAgICAgIExhbmcuZ2V0UmVnZXhGb3JOYW1lZEluc2VydGlvbihpdGVtLmluc2VydE5hbWUpLFxuICAgICAgICAgIGl0ZW0udmFsdWVcbiAgICAgICAgKTtcbiAgICAgIH0sIGxhbmdEaWZmU2Vjb25kKVxuICAgIDogXCJcIjtcblxuICByZXR1cm4gbWRgJHtpbnNpZ2h0RGF0YU92ZXJ2aWV3fVxuXG4ke2luc2lnaHREaWZmRmlyc3R9ICR7aW5zaWdodERpZmZTZWNvbmR9YDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgZGF0YUFkb3B0aW9uRmFjdG9yc19zZWxlY3QgPSB7XG4gIGNvbnN0IG9wdGlvbnMgPSBbLi4uZGF0YUFkb3B0aW9uRmFjdG9yc01hcC5rZXlzKCldXG4gICAgLm1hcCgoZCkgPT4ge1xuICAgICAgcmV0dXJuIHsgZmllbGQ6IGQsIHRyYW5zbGF0aW9uOiB0ZC5wcmFjdGljZXMudmFsdWVzPy5bZF0gfTtcbiAgICB9KVxuICAgIC5tYXAoKGQpID0+IHtcbiAgICAgIGlmIChkLmZpZWxkID09IFwiQWxsIHByYWN0aWNlc1wiKVxuICAgICAgICByZXR1cm4geyAuLi5kLCB0cmFuc2xhdGlvbjogbmJUZXh0LmlucHV0cy5kZWZhdWx0cy5wcmFjdGljZSB9O1xuICAgICAgcmV0dXJuIHsgLi4uZCB9O1xuICAgIH0pO1xuICBjb25zdCBzb3J0ZWQgPSBbXG4gICAgLi4ub3B0aW9uc1xuICAgICAgLmZpbHRlcigoZCkgPT4gZC5maWVsZCA9PSBcIkFsbCBwcmFjdGljZXNcIiksXG4gICAgLi4ub3B0aW9uc1xuICAgICAgLmZpbHRlcigoZCkgPT4gZC5maWVsZCAhPT0gXCJBbGwgcHJhY3RpY2VzXCIpXG4gICAgICAuc29ydCgoYSwgYikgPT4gX2xhbmcoYS50cmFuc2xhdGlvbikgPiBfbGFuZyhiLnRyYW5zbGF0aW9uKSlcbiAgXTtcbiAgcmV0dXJuIElucHV0cy5zZWxlY3Qoc29ydGVkLCB7XG4gICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LndvcmRzLnByYWN0aWNlLnNpbmd1bGFyKSxcbiAgICBmb3JtYXQ6ICh4KSA9PiBfbGFuZyh4LnRyYW5zbGF0aW9uKVxuICB9KTtcbn1cblxudmlld29mIHJhZGlvU29ydEFkb3B0aW9uRmFjdG9ycyA9IHtcbiAgY29uc3QgZGF0YSA9IFtcbiAgICB7XG4gICAgICBrZXk6IFwib2JzZXJ2YXRpb25zXCIsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmlucHV0cy5yYWRpb1NvcnQuZmllbGRzLm9ic2VydmF0aW9ucyksXG4gICAgICBjaGFubmVsOiBcInRvdGFsXCIsXG4gICAgICByZXZlcnNlOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBcImFscGhhXCIsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmlucHV0cy5yYWRpb1NvcnQuZmllbGRzLmFscGhhKSxcbiAgICAgIGNoYW5uZWw6IFwieVwiLFxuICAgICAgcmV2ZXJzZTogZmFsc2UsXG4gICAgfSxcbiAgXVxuICByZXR1cm4gSW5wdXRzLnJhZGlvKGRhdGEsIHsgbGFiZWw6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LmxhYmVscy5zb3J0QmFycyksIGZvcm1hdDogZCA9PiBkLmxhYmVsLCB2YWx1ZTogZGF0YS5maW5kKHggPT4geC5rZXkgPT09ICdvYnNlcnZhdGlvbnMnKSB9KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbntcbiAgY29uc3QgcGxvdERhdGEgPSBkYXRhQWRvcHRpb25GYWN0b3JzTWFwLmdldChkYXRhQWRvcHRpb25GYWN0b3JzX3NlbGVjdC5maWVsZCk7XG4gIGNvbnN0IF9maWxsTG9va3VwID0gYWRvcHRpb25GYWN0b3JzTG9va3VwO1xuICBjb25zdCBfc29ydGVyID0gcmFkaW9Tb3J0QWRvcHRpb25GYWN0b3JzO1xuICBjb25zdCBjb2xvck9yZGVyID0gW1xuICAgIF9maWxsTG9va3VwW1wiTmVnYXRpdmVcIl0sXG4gICAgX2ZpbGxMb29rdXBbXCJOb3Qgc2lnbmlmaWNhbnRcIl0sXG4gICAgX2ZpbGxMb29rdXBbXCJQb3NpdGl2ZVwiXVxuICBdO1xuICBjb25zdCBjb2xvclJhbmdlID0gW1wiI0VDNUE0N1wiLCBcIiNGNEJCMjFcIiwgXCIjMjE2NzI5XCJdO1xuICBjb25zdCB5ID0gKGQpID0+IF9sYW5nKHRkLmFkb3B0aW9uX2ZhY3RvcnMudmFsdWVzPy5bZF0pO1xuXG4gIHJldHVybiBQbG90LnBsb3Qoe1xuICAgIHdpZHRoOiAxMDAwLFxuICAgIGhlaWdodDogNDAwLFxuICAgIG1hcmdpbkxlZnQ6IDE4MCxcbiAgICBtYXJnaW5SaWdodDogNTAsXG4gICAgeDoge1xuICAgICAgYXhpczogbnVsbFxuICAgICAgLy8gbGFiZWw6IFwiJSBUb3RhbFwiXG4gICAgICAvLyBsYWJlbE9mZnNldDogNDAsXG4gICAgICAvLyBsYWJlbEFuY2hvcjogXCJjZW50ZXJcIlxuICAgIH0sXG4gICAgeToge1xuICAgICAgbGFiZWw6IG51bGwsXG4gICAgICB0aWNrU2l6ZTogMCxcbiAgICAgIHBhZGRpbmc6IDBcbiAgICB9LFxuICAgIGNvbG9yOiB7XG4gICAgICBkb21haW46IGNvbG9yT3JkZXIsXG4gICAgICByYW5nZTogY29sb3JSYW5nZSxcbiAgICAgIGxlZ2VuZDogdHJ1ZVxuICAgIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIC8vIG1haW4geS1heGlzXG4gICAgICBQbG90LmF4aXNZKHtcbiAgICAgICAgdGlja1NpemU6IDBcbiAgICAgIH0pLFxuICAgICAgLy8gcG9pbnRlciB3aGl0ZS1vdXRcbiAgICAgIFBsb3QuYXhpc1koXG4gICAgICAgIFBsb3QucG9pbnRlclkoe1xuICAgICAgICAgIGZpbGw6IFwid2hpdGVcIixcbiAgICAgICAgICB0ZXh0U3Ryb2tlOiBcIndoaXRlXCIsXG4gICAgICAgICAgdGV4dFN0cm9rZVdpZHRoOiAyLFxuICAgICAgICAgIHRpY2tTaXplOiAwXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgLy8gYm9sZCBwb2ludGVyXG4gICAgICBQbG90LmF4aXNZKFxuICAgICAgICBQbG90LnBvaW50ZXJZKHtcbiAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIixcbiAgICAgICAgICB0aWNrU2l6ZTogMFxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIC8vIGJhcnNcbiAgICAgIFBsb3QuYmFyWChcbiAgICAgICAgcGxvdERhdGEsXG4gICAgICAgIFBsb3Quc3RhY2tYKHtcbiAgICAgICAgICB4OiBcInBlcmNcIixcbiAgICAgICAgICB5OiAoZCkgPT4geShkLmZhY3RvciksXG4gICAgICAgICAgc29ydDogeyB5OiBfc29ydGVyLmNoYW5uZWwsIHJldmVyc2U6IF9zb3J0ZXIucmV2ZXJzZSB9LFxuICAgICAgICAgIGZpbGw6IChkKSA9PiBfZmlsbExvb2t1cFtkLmRpcmVjdGlvbl0sXG4gICAgICAgICAgb3JkZXI6IGNvbG9yT3JkZXIsXG4gICAgICAgICAgc3Ryb2tlOiBcIiNmZmZcIixcbiAgICAgICAgICBjaGFubmVsczoge1xuICAgICAgICAgICAgcGVyY2VudGFnZToge1xuICAgICAgICAgICAgICBsYWJlbDogTGFuZy50b1NlbnRlbmNlQ2FzZShcbiAgICAgICAgICAgICAgICBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5wZXJjZW50YWdlLnNpbmd1bGFyKVxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICB2YWx1ZTogXCJwZXJjXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b3RhbDogXCJ0b3RhbFwiLFxuICAgICAgICAgICAgbjoge1xuICAgICAgICAgICAgICBsYWJlbDogTGFuZy50b1NlbnRlbmNlQ2FzZShcbiAgICAgICAgICAgICAgICBfbGFuZyhuYlRleHQuc3VwcG9ydE5iVGV4dC53b3Jkcy5vYnNlcnZhdGlvbi5wbHVyYWwpXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIHZhbHVlOiBcIm5cIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGlwOiB7XG4gICAgICAgICAgICBmb3JtYXQ6IHtcbiAgICAgICAgICAgICAgeDogZmFsc2UsXG4gICAgICAgICAgICAgIHk6IGZhbHNlLFxuICAgICAgICAgICAgICBmaWxsOiBmYWxzZSxcbiAgICAgICAgICAgICAgdG90YWw6IGZhbHNlLFxuICAgICAgICAgICAgICBwZXJjZW50YWdlOiAoZCkgPT4gYCR7ZDMuZm9ybWF0KFwiZFwiKShkKX0lYCxcbiAgICAgICAgICAgICAgbjogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICBtYXJrQm9sZFNpZGViYXJUZXh0KHBsb3REYXRhLCB7XG4gICAgICAgIHk6IChkKSA9PiB5KGQuZmFjdG9yKSxcbiAgICAgICAgdGV4dDogXCJuXCIsXG4gICAgICAgIGR4OiA3XG4gICAgICB9KVxuICAgIF1cbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YSA9IHtcbiAgY29uc3QgbGFuZ1Jvb3QgPSBuYlRleHQ7XG4gIGNvbnN0IGxhbmdCYXNlUGF0aCA9IGxhbmdSb290LmFkb3B0aW9uRmFjdG9ycy5pbnNpZ2h0cy5wZXJjQmFyOyAvLyBiYXNlIHBhdGggZm9yIGxhbmd1YWdlXG5cbiAgY29uc3Qgc2VsZWN0ZWRQcmFjdGljZSA9IGRhdGFBZG9wdGlvbkZhY3RvcnNfc2VsZWN0LmZpZWxkO1xuICBjb25zdCBkYXRhID0gZGF0YUFkb3B0aW9uRmFjdG9yc01hcC5nZXQoc2VsZWN0ZWRQcmFjdGljZSk7XG5cbiAgY29uc3QgdGxfcHJhYyA9IChwcmFjKSA9PiBfbGFuZyh0ZC5wcmFjdGljZXMudmFsdWVzPy5bcHJhY10pO1xuICBjb25zdCB0bF9mYWN0ID0gKGZhY3QpID0+IF9sYW5nKHRkLmFkb3B0aW9uX2ZhY3RvcnNfd2l0aF9hcnRpY2xlcy52YWx1ZXM/LltmYWN0XSk7XG5cbiAgLy8gdG90YWwgb2JzZXJ2YXRpb25zIG92ZXJ2aWV3XG4gIGNvbnN0IHRvdGFsID0gVC50aWR5KFxuICAgIGRhdGEsXG4gICAgVC5ncm91cEJ5KFxuICAgICAgW1wicHJhY3RpY2VcIl0sXG4gICAgICBbXG4gICAgICAgIFQuc3VtbWFyaXplKHtcbiAgICAgICAgICB0b3RhbE9ic2VydmF0aW9uczogVC5zdW0oXCJuXCIpLFxuICAgICAgICAgIGZhY3RvckNvdW50OiBULmNvdW50KFwiZmFjdG9yXCIpXG4gICAgICAgIH0pXG4gICAgICBdXG4gICAgKVxuICApWzBdO1xuICAvLyBjb25zdCBtZFRvdGFsID1cbiAgLy8gICB0b3RhbC5wcmFjdGljZSA9PSBhZG9wdGlvbkZhY3RvckFsbExhYmVsXG4gIC8vICAgICA/IGBJbiB0b3RhbCwgdGhlcmUgYXJlYFxuICAvLyAgICAgOiBgKioke3RvdGFsfSoqIGhhc2A7XG4gIGNvbnN0IGxhbmdUb3RhbF9zZWxlY3Rpb24gPVxuICAgIHRvdGFsLnByYWN0aWNlID09IGFkb3B0aW9uRmFjdG9yQWxsTGFiZWwgPyBcImluVG90YWxcIiA6IFwic3BlY2lmaWNIYXNcIjtcbiAgY29uc3QgbGFuZ1RvdGFsID0gX2xhbmcobGFuZ0Jhc2VQYXRoLm92ZXJ2aWV3KTtcbiAgY29uc3QgbGFuZ1RvdGFsSXRlbXMgPSBbXG4gICAge1xuICAgICAgaW5zZXJ0TmFtZTogXCJzdGFydFN0cmluZ1wiLFxuICAgICAgdmFsdWU6IF9sYW5nKG5iVGV4dC5zdXBwb3J0TmJUZXh0LnBocmFzZXNbbGFuZ1RvdGFsX3NlbGVjdGlvbl0pXG4gICAgfSxcbiAgICB7IGluc2VydE5hbWU6IFwidG90YWxPYnNcIiwgdmFsdWU6IGZvcm1hdENvbW1hKHRvdGFsLnRvdGFsT2JzZXJ2YXRpb25zKSB9LFxuICAgIHsgaW5zZXJ0TmFtZTogXCJpdGVtXCIsIHZhbHVlOiB0bF9wcmFjKHRvdGFsLnByYWN0aWNlKSB9LFxuICAgIHsgaW5zZXJ0TmFtZTogXCJ0b3RhbEZhY3RvcnNcIiwgdmFsdWU6IHRvdGFsLmZhY3RvckNvdW50Lmxlbmd0aCB9XG4gIF07XG4gIGNvbnN0IG1kT3ZlcnZpZXcgPSBsYW5nVG90YWxJdGVtcy5yZWR1Y2UoKG92ZXJ2aWV3LCBpdGVtKSA9PiB7XG4gICAgcmV0dXJuIG92ZXJ2aWV3LnJlcGxhY2UoXG4gICAgICBMYW5nLmdldFJlZ2V4Rm9yTmFtZWRJbnNlcnRpb24oaXRlbS5pbnNlcnROYW1lKSxcbiAgICAgIGl0ZW0udmFsdWVcbiAgICApO1xuICB9LCBsYW5nVG90YWwpO1xuXG4gIC8vIHRvdGFsIHNpZ25pZmljYW50IHN1bSAobmVlZGxlIG1vdmUpXG4gIGNvbnN0IHRvcE5lZWRsZU1vdmUgPSBULnRpZHkoXG4gICAgZGF0YSxcbiAgICBULmZpbHRlcigoZCkgPT4gZC5kaXJlY3Rpb24gIT09IFwiTm90IHNpZ25pZmljYW50XCIpLFxuICAgIFQuZ3JvdXBCeShbXCJmYWN0b3JcIl0sIFtULnN1bW1hcml6ZSh7IHBlcmNfc2lnOiBULnN1bShcInBlcmNcIikgfSldKSxcbiAgICBULmFycmFuZ2UoVC5kZXNjKFwicGVyY19zaWdcIikpLFxuICAgIFQuc2xpY2VNYXgoMSwgXCJwZXJjX3NpZ1wiKVxuICApWzBdO1xuICBjb25zdCBsYW5nVG9wTmVlZGxlID0gX2xhbmcobGFuZ0Jhc2VQYXRoLm1vc3RJbXBhY3RmdWxGYWN0b3IpO1xuICBjb25zdCBsYW5nVG9wTmVlZGxlSXRlbXMgPSBbXG4gICAgeyBpbnNlcnROYW1lOiBcImZhY3RvclwiLCB2YWx1ZTogdGxfZmFjdCh0b3BOZWVkbGVNb3ZlLmZhY3RvcikgfSxcbiAgICB7IGluc2VydE5hbWU6IFwicHJhY3RpY2VcIiwgdmFsdWU6IHRsX3ByYWMoc2VsZWN0ZWRQcmFjdGljZSkgfSxcbiAgICB7IGluc2VydE5hbWU6IFwiaW5mbHVlbmNlXCIsIHZhbHVlOiBkMy5mb3JtYXQoXCJkXCIpKHRvcE5lZWRsZU1vdmUucGVyY19zaWcpIH1cbiAgXTtcbiAgY29uc3QgbWRUb3BOZWVkbGUgPSBsYW5nVG9wTmVlZGxlSXRlbXMucmVkdWNlKChvdmVydmlldywgaXRlbSkgPT4ge1xuICAgIHJldHVybiBvdmVydmlldy5yZXBsYWNlKFxuICAgICAgTGFuZy5nZXRSZWdleEZvck5hbWVkSW5zZXJ0aW9uKGl0ZW0uaW5zZXJ0TmFtZSksXG4gICAgICBpdGVtLnZhbHVlXG4gICAgKTtcbiAgfSwgbGFuZ1RvcE5lZWRsZSk7XG5cbiAgLy8gaGlnaCBuZWcgaW5mbHVlbmNlXG4gIGNvbnN0IGxhcmdlTmVnSW5mbHVlbmNlID0gVC50aWR5KFxuICAgIGRhdGEsXG4gICAgVC5maWx0ZXIoKGQpID0+IGQuZGlyZWN0aW9uID09IFwiTmVnYXRpdmVcIiksXG4gICAgVC5zbGljZU1heCgxLCBcInBlcmNcIilcbiAgKVswXTtcbiAgY29uc3QgbGFyZ2VQb3NJbmZsdWVuY2UgPSBULnRpZHkoXG4gICAgZGF0YSxcbiAgICBULmZpbHRlcigoZCkgPT4gZC5kaXJlY3Rpb24gPT0gXCJQb3NpdGl2ZVwiKSxcbiAgICBULnNsaWNlTWF4KDEsIFwicGVyY1wiKVxuICApWzBdO1xuXG4gIGNvbnN0IGxhbmdCaWdJbmZsdWVuY2UgPSBfbGFuZyhsYW5nQmFzZVBhdGguYmlnZ2VzdEluZmx1ZW5jZXMpXG4gIGNvbnN0IGxhbmdCaWdJbmZsdWVuY2VJdGVtcyA9IFtcbiAgICB7IGluc2VydE5hbWU6IFwiZmFjdG9yTmVnXCIsIHZhbHVlOiB0bF9mYWN0KGxhcmdlTmVnSW5mbHVlbmNlLmZhY3RvcikgfSxcbiAgICB7IGluc2VydE5hbWU6IFwiaW5mbHVlbmNlTmVnXCIsIHZhbHVlOiBkMy5mb3JtYXQoXCJkXCIpKGxhcmdlTmVnSW5mbHVlbmNlLnBlcmMpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcImZhY3RvclBvc1wiLCB2YWx1ZTogdGxfZmFjdChsYXJnZVBvc0luZmx1ZW5jZS5mYWN0b3IpIH0sXG4gICAgeyBpbnNlcnROYW1lOiBcImluZmx1ZW5jZVBvc1wiLCB2YWx1ZTogZDMuZm9ybWF0KFwiZFwiKShsYXJnZVBvc0luZmx1ZW5jZS5wZXJjKSB9LFxuICBdO1xuICBjb25zdCBtZEJpZ0luZmx1ZW5jZSA9IGxhbmdCaWdJbmZsdWVuY2VJdGVtcy5yZWR1Y2UoKG92ZXJ2aWV3LCBpdGVtKSA9PiB7XG4gICAgcmV0dXJuIG92ZXJ2aWV3LnJlcGxhY2UoXG4gICAgICBMYW5nLmdldFJlZ2V4Rm9yTmFtZWRJbnNlcnRpb24oaXRlbS5pbnNlcnROYW1lKSxcbiAgICAgIGl0ZW0udmFsdWVcbiAgICApO1xuICB9LCBsYW5nQmlnSW5mbHVlbmNlKTtcblxuICByZXR1cm4gbWRgJHttZE92ZXJ2aWV3fVxuXG4ke21kVG9wTmVlZGxlfVxuXG4ke21kQmlnSW5mbHVlbmNlfWA7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNlbGVjdFJlc291cmNlUHJhY3RpY2UgPSB7XG4gIGNvbnN0IGRhdGEgPSBfLnVuaXEoY3NhTWFudWFscy5tYXAoKGQpID0+IGQucHJhY3RpY2UpKVxuICAgIC5tYXAoKGQpID0+IHtcbiAgICAgIHJldHVybiB7IGZpZWxkOiBkLCB0cmFuc2xhdGlvbjogdGQuc3VtbWFyeVByYWN0aWNlcy52YWx1ZXM/LltkXSB9O1xuICAgIH0pXG4gICAgLnNvcnQoKGEsIGIpID0+IF9sYW5nKGEudHJhbnNsYXRpb24pID4gX2xhbmcoYi50cmFuc2xhdGlvbikpO1xuXG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KGRhdGEsIHtcbiAgICBsYWJlbDogX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQud29yZHMucHJhY3RpY2Uuc2luZ3VsYXIpLFxuICAgIGZvcm1hdDogeCA9PiBfbGFuZyh4LnRyYW5zbGF0aW9uKSxcbiAgICB2YWx1ZTogZGF0YS5maW5kKHggPT4geC5maWVsZCA9PSBcIklub3JnYW5pYyBGZXJ0aWxpemVyXCIpXG4gIH0pO1xufVxuXG5odG1sYCR7Y3NhUmVzb3VyY2VIdG1sfWBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAke19sYW5nKG5iVGV4dC5tZXRob2RzU291cmNlcy5oMkRhdGFTb3VyY2VzU3Vic2VjdGlvbil9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGBcbiMjIyAke19sYW5nKG5iVGV4dC5tZXRob2RzU291cmNlcy5oM0VyYSl9XG4ke19sYW5nKG5iVGV4dC5tZXRob2RzU291cmNlcy5oM0VyYVN1YnNlY3Rpb24pfVxuYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBUaGlzIHNlY3Rpb24gbmVlZHMgdG8gYmUgYWJvdmUgdGhlIC5oaWRkZW4gZm9yIGl0IHRvIHdvcmtcbmltcG9ydCB7IGF0bGFzVE9DIH0gZnJvbSAnL2hlbHBlcnMvdWlDb21wb25lbnRzLm9qcycgXG50b2NfYm90dG9tID0ge1xuICBhd2FpdCBuYlRleHQgLy8gZm9yY2Ugd2FpdC9yZWxvYWQgd2l0aCBuYlRleHQgdG8gbG9hZCBzbyBoZWFkaW5ncyBoYXZlIGNvcnJlY3QgbGFiZWxzL2xhbmd1YWdlc1xuICByZXR1cm4gYXRsYXNUT0Moe1xuICAgICAgaGVhZGluZzogYDxiPiR7X2xhbmcoe2VuOlwiSW4gdGhpcyBub3RlYm9va1wiLCBmcjpcIkRhbnMgY2Ugbm90ZWJvb2tcIn0pfTwvYj5gLFxuICAgICAgc2tpcDogW25iVGl0bGUsIFwibm90ZWJvb2stdGl0bGVcIiwgXCJBcHBlbmRpeFwiLCBcInNvdXJjZS1jb2RlXCJdXG4gICAgICB9KVxufVxuICBcbmh0bC5odG1sYFxuICA8ZGl2IGNsYXNzPSdmbG9hdGluZy10b2MnPlxuICAgICR7dG9jX2JvdHRvbX1cbiAgPC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im5iVGl0bGUgPSBfbGFuZyh7IGVuOiBcIkRpc2NvdmVyIFNvbHV0aW9uc1wiLCBmcjogXCJEw6ljb3V2cmlyIGRlcyBzb2x1dGlvbnNcIiB9KTtcbi8vIGgxXG5PdmVydmlldyA9IF9sYW5nKG5iVGV4dC5vdmVydmlldy5oMSk7XG5cbkludGVydmVudGlvbnMgPSBfbGFuZyhuYlRleHQuaW50ZXJ2ZW50aW9ucy5oMSk7XG5cblByYWN0aWNhbEltcGFjdCA9IF9sYW5nKG5iVGV4dC5wcmFjdGljYWxJbXBhY3QubWVhbkNyb3BEaWZmLmgxKTtcblxuUmlza3MgPSBfbGFuZyhuYlRleHQucmlza3MuaDEpO1xuXG5GYWN0b3JzID0gX2xhbmcobmJUZXh0LmFkb3B0aW9uRmFjdG9ycy5oMSk7XG5cblN1bW1hcnkgPSBfbGFuZyhuYlRleHQuc3VtbWFyeS5oMSk7XG5cbk1ldGhvZHMgPSBfbGFuZyhuYlRleHQubWV0aG9kc1NvdXJjZXMuaDEpO1xuXG4vLyBoMlxuY3JvcF9kaWZmID0gX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC5tZWFuQ3JvcERpZmYuaDIubWVhbkRpZmYpO1xuXG5jcm9wX2RpZmZfYWV6ID0gX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC5tZWFuQ3JvcERpZmZBRVouaDIpO1xuXG5hZXpfZGlmID0gX2xhbmcobmJUZXh0LnByYWN0aWNhbEltcGFjdC5tZWFuQ3JvcERpZmZBRVouaDIpO1xuXG5kYXRhX3NvdXJjZXMgPSBfbGFuZyhuYlRleHQubWV0aG9kc1NvdXJjZXMuaDJEYXRhU291cmNlcyk7XG5cbm1ldGhvZHMgPSBfbGFuZyhuYlRleHQubWV0aG9kc1NvdXJjZXMuaDJNZXRob2RzKTtcblxucXVpY2tJbnNpZ2h0ID0gX2xhbmcobmJUZXh0LnN1cHBvcnROYlRleHQubGFiZWxzLnF1aWNrSW5zaWdodHMpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7bmJUZXh0fSBmcm9tIFwiL2RhdGEvRGlzY292ZXJTb2x1dGlvbnMvbmJUZXh0Lm9qc1wiXG5cbmltcG9ydCB7bGFuZyBhcyBMYW5nIH0gZnJvbSBcIi9oZWxwZXJzL2xhbmcuanNcIlxuXG5fbGFuZyA9IGF3YWl0IExhbmcubGcobGFuZ3VhZ2Uua2V5KVxuXG5kZWZhdWx0TGFuZ0tleSA9IHtcbiAgY29uc3QgbGlzdCA9IGxhbmd1YWdlcy5tYXAoKGQpID0+IGQua2V5KTtcbiAgY29uc3QgZGVmYXVsdEtleSA9IFwiZW5cIjtcbiAgY29uc3QgcXVlcnlQYXJhbSA9IGF3YWl0IExhbmcuZ2V0UGFyYW1Gcm9tTGlzdCh7IG5hbWU6IFwibGFuZ1wiLCBsaXN0IH0pO1xuICByZXR1cm4gcXVlcnlQYXJhbSA/PyBkZWZhdWx0S2V5O1xufVxuXG5sYW5ndWFnZXMgPSBbXG4gIHsga2V5OiBcImVuXCIsIGxhYmVsOiBcIkVuZ2xpc2hcIiwgbG9jYWxlOiAnZW4tVVMnIH0sXG4gIHsga2V5OiBcImZyXCIsIGxhYmVsOiBcIkZyYW7Dp2Fpc1wiLCBsb2NhbGU6ICdmci1GUicgfVxuXVxuXG52aWV3b2YgbGFuZ3VhZ2UgPSBJbnB1dHMucmFkaW8obGFuZ3VhZ2VzLCB7XG4gIGxhYmVsOiBcIk1haW4gbGFuZ3VhZ2UgdG9nZ2xlXCIsXG4gIGZvcm1hdDogKGQpID0+IGQua2V5LFxuICB2YWx1ZTogbGFuZ3VhZ2VzLmZpbmQoKHgpID0+IHgua2V5ID09PSBkZWZhdWx0TGFuZ0tleSksXG59KVxuXG4vLyBkYXRhIHRyYW5zbGF0aW9uIHZhbHVlc1xudGQgPSB7XG4gIGxldCBkYXRhID0gYXdhaXQgRmlsZUF0dGFjaG1lbnQoXCIvZGF0YS9EaXNjb3ZlclNvbHV0aW9ucy90cmFuc2xhdGlvbl92MkAxLmpzb25cIikuanNvbigpO1xuXG4gIC8qIEFkZGl0aW9ucyAqL1xuICBkYXRhLnByYWN0aWNlcy52YWx1ZXNbXCJBbGwgcHJhY3RpY2VzXCJdID0ge1xuICAgIGVuOiBcIkFsbCBwcmFjdGljZXNcIixcbiAgICBmcjogXCJUb3V0ZXMgbGVzIHByYXRpcXVlc1wiXG4gIH07XG5cbiAgZGF0YS5zdW1tYXJ5U3lzdGVtcyA9IHtcbiAgICBlbjogXCJzeXN0ZW1cIixcbiAgICBmcjogXCJzeXN0w6htZVwiLFxuICAgIHZhbHVlczoge1xuICAgICAgQWdyb2ZvcmVzdHk6IHtcbiAgICAgICAgZW46IFwiQWdyb2ZvcmVzdHJ5XCIsXG4gICAgICAgIGZyOiBcIkFncm9mb3Jlc3Rpw6hyZVwiXG4gICAgICB9LFxuICAgICAgXCJDZXJlYWwtYmFzZWRcIjoge1xuICAgICAgICBlbjogXCJDZXJlYWwtYmFzZWRcIixcbiAgICAgICAgZnI6IFwiw4AgYmFzZSBkZSBjw6lyw6lhbGVzXCJcbiAgICAgIH0sXG4gICAgICBcIkNlcmVhbC1iYXNlZCwgUmljZS1iYXNlZFwiOiB7XG4gICAgICAgIGVuOiBcIkNlcmVhbC1iYXNlZCwgUmljZS1iYXNlZFwiLFxuICAgICAgICBmcjogXCLDgCBiYXNlIGRlIGPDqXLDqWFsZXMsIMOAIGJhc2UgZGUgcml6XCJcbiAgICAgIH0sXG4gICAgICBcIk1haXplLCBOYXBpZXIgZ3Jhc3MsIERlc21vZGl1bSBsZWd1bWVcIjoge1xuICAgICAgICBlbjogXCJNYWl6ZSwgTmFwaWVyIGdyYXNzLCBEZXNtb2RpdW0gbGVndW1lXCIsXG4gICAgICAgIGZyOiBcIk1hw69zLCBoZXJiZSBOYXBpZXIsIGzDqWd1bWluZXVzZSBEZXNtb2RpdW1cIlxuICAgICAgfSxcbiAgICAgIFwiTWFpemUsIE90aGVyXCI6IHtcbiAgICAgICAgZW46IFwiTWFpemUsIE90aGVyXCIsXG4gICAgICAgIGZyOiBcIk1hw69zLCBhdXRyZVwiXG4gICAgICB9LFxuICAgICAgXCJSaWNlLWJhc2VkXCI6IHtcbiAgICAgICAgZW46IFwiUmljZS1iYXNlZFwiLFxuICAgICAgICBmcjogXCLDgCBiYXNlIGRlIHJpelwiXG4gICAgICB9LFxuICAgICAgVW5zcGVjaWZpZWQ6IHtcbiAgICAgICAgZW46IFwiVW5zcGVjaWZpZWRcIixcbiAgICAgICAgZnI6IFwiTm9uIHNww6ljaWZpw6lcIlxuICAgICAgfSxcbiAgICAgIFwiVmVnZXRhYmxlcywgRnJ1aXRzLCBSaWNlXCI6IHtcbiAgICAgICAgZW46IFwiVmVnZXRhYmxlcywgRnJ1aXRzLCBSaWNlXCIsXG4gICAgICAgIGZyOiBcIkzDqWd1bWVzLCBGcnVpdHMsIFJpelwiXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGRhdGEuc3VtbWFyeVByYWN0aWNlcyA9IHtcbiAgICBlbjogXCJQcmFjdGljZVwiLFxuICAgIGZyOiBcIlByYXRpcXVlXCIsXG4gICAgdmFsdWVzOiB7XG4gICAgICBcIkFncm9mb3Jlc3RyeSBGYWxsb3dcIjoge1xuICAgICAgICBlbjogXCJBZ3JvZm9yZXN0cnkgRmFsbG93XCIsXG4gICAgICAgIGZyOiBcIkphY2jDqHJlIGFncm9mb3Jlc3Rpw6hyZVwiXG4gICAgICB9LFxuICAgICAgXCJBZ3JvZm9yZXN0cnkgUHJ1bmluZ1wiOiB7XG4gICAgICAgIGVuOiBcIkFncm9mb3Jlc3RyeSBQcnVuaW5nXCIsXG4gICAgICAgIGZyOiBcIlRhaWxsZSBhZ3JvZm9yZXN0acOocmVcIlxuICAgICAgfSxcbiAgICAgIEFsbGV5Y3JvcHBpbmc6IHtcbiAgICAgICAgZW46IFwiQWxsZXljcm9wcGluZ1wiLFxuICAgICAgICBmcjogXCJDdWx0dXJlIGVuIGFsbMOpZXNcIlxuICAgICAgfSxcbiAgICAgIEJpb2NoYXI6IHtcbiAgICAgICAgZW46IFwiQmlvY2hhclwiLFxuICAgICAgICBmcjogXCJCaW9jaGFyXCJcbiAgICAgIH0sXG4gICAgICBcIkJvdW5kYXJ5IFBsYW50aW5nXCI6IHtcbiAgICAgICAgZW46IFwiQm91bmRhcnkgUGxhbnRpbmdcIixcbiAgICAgICAgZnI6IFwiUGxhbnRhdGlvbiBlbiBib3JkdXJlXCJcbiAgICAgIH0sXG4gICAgICBDb21wb3N0aW5nOiB7XG4gICAgICAgIGVuOiBcIkNvbXBvc3RpbmdcIixcbiAgICAgICAgZnI6IFwiQ29tcG9zdGFnZVwiXG4gICAgICB9LFxuICAgICAgXCJDcm9wIFJlc2lkdWUgSW5jb3Jwb3JhdGlvblwiOiB7XG4gICAgICAgIGVuOiBcIkNyb3AgUmVzaWR1ZSBJbmNvcnBvcmF0aW9uXCIsXG4gICAgICAgIGZyOiBcIkluY29ycG9yYXRpb24gZGVzIHLDqXNpZHVzIGRlIHLDqWNvbHRlXCJcbiAgICAgIH0sXG4gICAgICBcIkNyb3AgUmVzaWR1ZSBNYW5hZ2VtZW50XCI6IHtcbiAgICAgICAgZW46IFwiQ3JvcCBSZXNpZHVlIE1hbmFnZW1lbnRcIixcbiAgICAgICAgZnI6IFwiR2VzdGlvbiBkZXMgcsOpc2lkdXMgZGUgcsOpY29sdGVcIlxuICAgICAgfSxcbiAgICAgIFwiQ3JvcCBSb3RhdGlvblwiOiB7XG4gICAgICAgIGVuOiBcIkNyb3AgUm90YXRpb25cIixcbiAgICAgICAgZnI6IFwiUm90YXRpb24gZGVzIGN1bHR1cmVzXCJcbiAgICAgIH0sXG4gICAgICBcIkRlZmljaXQgSXJyaWdhdGlvblwiOiB7XG4gICAgICAgIGVuOiBcIkRlZmljaXQgSXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJJcnJpZ2F0aW9uIGTDqWZpY2l0YWlyZVwiXG4gICAgICB9LFxuICAgICAgXCJHcmVlbiBNYW51cmVcIjoge1xuICAgICAgICBlbjogXCJHcmVlbiBNYW51cmVcIixcbiAgICAgICAgZnI6IFwiRW5ncmFpcyB2ZXJ0XCJcbiAgICAgIH0sXG4gICAgICBcIkltcHJvdmVkIEZhbGxvd3NcIjoge1xuICAgICAgICBlbjogXCJJbXByb3ZlZCBGYWxsb3dzXCIsXG4gICAgICAgIGZyOiBcIkphY2jDqHJlcyBhbcOpbGlvcsOpZXNcIlxuICAgICAgfSxcbiAgICAgIFwiSW1wcm92ZWQgVmFyaWV0aWVzXCI6IHtcbiAgICAgICAgZW46IFwiSW1wcm92ZWQgVmFyaWV0aWVzXCIsXG4gICAgICAgIGZyOiBcIlZhcmnDqXTDqXMgYW3DqWxpb3LDqWVzXCJcbiAgICAgIH0sXG4gICAgICBcIklub3JnYW5pYyBGZXJ0aWxpemVyXCI6IHtcbiAgICAgICAgZW46IFwiSW5vcmdhbmljIEZlcnRpbGl6ZXJcIixcbiAgICAgICAgZnI6IFwiRW5ncmFpcyBpbm9yZ2FuaXF1ZVwiXG4gICAgICB9LFxuICAgICAgSW50ZXJjcm9wcGluZzoge1xuICAgICAgICBlbjogXCJJbnRlcmNyb3BwaW5nXCIsXG4gICAgICAgIGZyOiBcIkN1bHR1cmUgaW50ZXJjYWxhaXJlXCJcbiAgICAgIH0sXG4gICAgICBNdWxjaGluZzoge1xuICAgICAgICBlbjogXCJNdWxjaGluZ1wiLFxuICAgICAgICBmcjogXCJQYWlsbGFnZVwiXG4gICAgICB9LFxuICAgICAgXCJPcmdhbmljIEZlcnRpbGl6ZXJcIjoge1xuICAgICAgICBlbjogXCJPcmdhbmljIEZlcnRpbGl6ZXJcIixcbiAgICAgICAgZnI6IFwiRW5ncmFpcyBvcmdhbmlxdWVcIlxuICAgICAgfSxcbiAgICAgIFwiT3RoZXIgQWdyb2ZvcmVzdHJ5XCI6IHtcbiAgICAgICAgZW46IFwiT3RoZXIgQWdyb2ZvcmVzdHJ5XCIsXG4gICAgICAgIGZyOiBcIkF1dHJlIGFncm9mb3Jlc3Rpw6hyZVwiXG4gICAgICB9LFxuICAgICAgUGFya2xhbmRzOiB7XG4gICAgICAgIGVuOiBcIlBhcmtsYW5kc1wiLFxuICAgICAgICBmcjogXCJQYXJjcyBhZ3JvZm9yZXN0aWVyc1wiXG4gICAgICB9LFxuICAgICAgXCJwSCBDb250cm9sXCI6IHtcbiAgICAgICAgZW46IFwicEggQ29udHJvbFwiLFxuICAgICAgICBmcjogXCJDb250csO0bGUgZHUgcEhcIlxuICAgICAgfSxcbiAgICAgIFNpbHZvcGFzdHVyZToge1xuICAgICAgICBlbjogXCJTaWx2b3Bhc3R1cmVcIixcbiAgICAgICAgZnI6IFwiU3lsdm9wYXN0b3JhbGlzbWVcIlxuICAgICAgfSxcbiAgICAgIFwiU3VwcGxlbWVudGFsIElycmlnYXRpb25cIjoge1xuICAgICAgICBlbjogXCJTdXBwbGVtZW50YWwgSXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJJcnJpZ2F0aW9uIHN1cHBsw6ltZW50YWlyZVwiXG4gICAgICB9LFxuICAgICAgXCJUaWxsYWdlIE1hbmFnZW1lbnRcIjoge1xuICAgICAgICBlbjogXCJUaWxsYWdlIE1hbmFnZW1lbnRcIixcbiAgICAgICAgZnI6IFwiR2VzdGlvbiBkdSB0cmF2YWlsIGR1IHNvbFwiXG4gICAgICB9LFxuICAgICAgXCJXYXRlciBIYXJ2ZXN0aW5nXCI6IHtcbiAgICAgICAgZW46IFwiV2F0ZXIgSGFydmVzdGluZ1wiLFxuICAgICAgICBmcjogXCJDb2xsZWN0ZSBkZXMgZWF1eFwiXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIGFkb3B0aW9uIGZhY3RvcnMsIHdpdGggYXJ0aWNsZXNcbiAgZGF0YS5hZG9wdGlvbl9mYWN0b3JzX3dpdGhfYXJ0aWNsZXMgPSB7XG4gICAgZW46IFwiYWRvcHRpb25fZmFjdG9yc1wiLFxuICAgIGZyOiBcImZhY3RldXJzX2RhZG9wdGlvblwiLFxuICAgIHZhbHVlczoge1xuICAgICAgXCJBY2Nlc3MgdG8gY3JlZGl0XCI6IHsgZW46IFwiQWNjZXNzIHRvIGNyZWRpdFwiLCBmcjogXCJMJ0FjY8OocyBhdSBjcsOpZGl0XCIgfSxcbiAgICAgIFwiQWNjZXNzIHRvIGluZm9ybWF0aW9uXCI6IHtcbiAgICAgICAgZW46IFwiQWNjZXNzIHRvIGluZm9ybWF0aW9uXCIsXG4gICAgICAgIGZyOiBcIkwnQWNjw6hzIMOgIGwnaW5mb3JtYXRpb25cIlxuICAgICAgfSxcbiAgICAgIFwiQXZhaWxhYmlsaXR5IG9mIGxhYm9yXCI6IHtcbiAgICAgICAgZW46IFwiQXZhaWxhYmlsaXR5IG9mIGxhYm9yXCIsXG4gICAgICAgIGZyOiBcIkxhIERpc3BvbmliaWxpdMOpIGRlIGxhIG1haW4tZCfFk3V2cmVcIlxuICAgICAgfSxcbiAgICAgIFwiQmlvcGh5aXNjYWwgZmFjdG9yc1wiOiB7XG4gICAgICAgIGVuOiBcIkJpb3BoeWlzY2FsIGZhY3RvcnNcIixcbiAgICAgICAgZnI6IFwiTGVzIEZhY3RldXJzIGJpb3BoeXNpcXVlc1wiXG4gICAgICB9LFxuICAgICAgXCJDaGFuZ2VzIGluIHdlYXRoZXJcIjoge1xuICAgICAgICBlbjogXCJDaGFuZ2VzIGluIHdlYXRoZXJcIixcbiAgICAgICAgZnI6IFwiTGVzIENoYW5nZW1lbnRzIGNsaW1hdGlxdWVzXCJcbiAgICAgIH0sXG4gICAgICBcIkRpc3RhbmNlIHRvIG1hcmtldFwiOiB7XG4gICAgICAgIGVuOiBcIkRpc3RhbmNlIHRvIG1hcmtldFwiLFxuICAgICAgICBmcjogXCJMYSBEaXN0YW5jZSBhdSBtYXJjaMOpXCJcbiAgICAgIH0sXG4gICAgICBcIkV4cG9zdXJlIHRvIHJpc2tzIGFuZCBzaG9ja3NcIjoge1xuICAgICAgICBlbjogXCJFeHBvc3VyZSB0byByaXNrcyBhbmQgc2hvY2tzXCIsXG4gICAgICAgIGZyOiBcIkwnRXhwb3NpdGlvbiBhdXggcmlzcXVlcyBldCBjaG9jc1wiXG4gICAgICB9LFxuICAgICAgT3RoZXI6IHsgZW46IFwiT3RoZXJcIiwgZnI6IFwiQXV0cmVcIiB9LFxuICAgICAgXCJSZXNvdXJjZSBlbmRvd21lbnRzXCI6IHtcbiAgICAgICAgZW46IFwiUmVzb3VyY2UgZW5kb3dtZW50c1wiLFxuICAgICAgICBmcjogXCJMYSBEb3RhdGlvbiBlbiByZXNzb3VyY2VzXCJcbiAgICAgIH0sXG4gICAgICBcIlNlY3VyZSB0ZW51cmVcIjogeyBlbjogXCJTZWN1cmUgdGVudXJlXCIsIGZyOiBcIkxhIFRlbnVyZSBzw6ljdXJpc8OpZVwiIH0sXG4gICAgICBcIlNvY2lhbCBjYXBpdGFsXCI6IHsgZW46IFwiU29jaWFsIGNhcGl0YWxcIiwgZnI6IFwiTGEgQ2FwaXRhbCBzb2NpYWxcIiB9LFxuICAgICAgXCJTb2Npby1kZW1vZ3JhcGhpY3NcIjoge1xuICAgICAgICBlbjogXCJTb2Npby1kZW1vZ3JhcGhpY3NcIixcbiAgICAgICAgZnI6IFwiTGEgU29jaW8tZMOpbW9ncmFwaGllXCJcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gY3JvcCBhcnRpY2xlc1xuICBkYXRhLkNyb3Bfd2l0aF9hcnRpY2xlcyA9IHtcbiAgICBlbjogXCJjcm9wX3dpdGhfYXJ0aWNsZXNcIixcbiAgICBmcjogXCJjcm9wX3dpdGhfYXJ0aWNsZXNcIixcbiAgICB2YWx1ZXM6IHtcbiAgICAgIE1haXplOiB7IGVuOiBcIm1haXplXCIsIGZyOiBcImxlIG1hw69zXCIgfSxcbiAgICAgIFJpY2U6IHsgZW46IFwicmljZVwiLCBmcjogXCJsZSByaXpcIiB9LFxuICAgICAgXCJQZWFybCBNaWxsZXRcIjogeyBlbjogXCJwZWFybCBtaWxsZXRcIiwgZnI6IFwibGUgbWlsbGV0IHBlcmzDqVwiIH0sXG4gICAgICBTb3JnaHVtOiB7IGVuOiBcInNvcmdodW1cIiwgZnI6IFwibGUgc29yZ2hvXCIgfSxcbiAgICAgIENvd3BlYTogeyBlbjogXCJjb3dwZWFcIiwgZnI6IFwibGUgbmnDqWLDqVwiIH0sXG4gICAgICBcIkNvbW1vbiBCZWFuXCI6IHsgZW46IFwiY29tbW9uIGJlYW5cIiwgZnI6IFwibGUgaGFyaWNvdCBjb21tdW5cIiB9LFxuICAgICAgU295YmVhbjogeyBlbjogXCJzb3liZWFuXCIsIGZyOiBcImxlIHNvamFcIiB9LFxuICAgICAgQ2Fzc2F2YTogeyBlbjogXCJjYXNzYXZhXCIsIGZyOiBcImxlIG1hbmlvY1wiIH0sXG4gICAgICBHcm91bmRudXQ6IHsgZW46IFwiZ3JvdW5kbnV0XCIsIGZyOiBcImwnYXJhY2hpZGVcIiB9LFxuICAgICAgV2hlYXQ6IHsgZW46IFwid2hlYXRcIiwgZnI6IFwibGUgYmzDqVwiIH0sXG4gICAgICBZYW06IHsgZW46IFwieWFtXCIsIGZyOiBcImwnaWduYW1lXCIgfSxcbiAgICAgIENvdHRvbjogeyBlbjogXCJjb3R0b25cIiwgZnI6IFwiY290b25cIiB9LFxuICAgICAgVGVmZjogeyBlbjogXCJ0ZWZmXCIsIGZyOiBcImxlIHRlZmZcIiB9LFxuICAgICAgVG9tYXRvOiB7IGVuOiBcInRvbWF0b1wiLCBmcjogXCJsYSB0b21hdGVcIiB9LFxuICAgICAgUG90YXRvOiB7IGVuOiBcInBvdGF0b1wiLCBmcjogXCJsYSBwb21tZSBkZSB0ZXJyZVwiIH0sXG4gICAgICBcIlN1Z2FyIENhbmVcIjogeyBlbjogXCJzdWdhciBjYW5lXCIsIGZyOiBcImxhIGNhbm5lIMOgIHN1Y3JlXCIgfSxcbiAgICAgIFwiUGlnZW9uIFBlYVwiOiB7IGVuOiBcInBpZ2VvbiBwZWFcIiwgZnI6IFwibGUgcG9pcyBjYWphblwiIH0sXG4gICAgICBDaGlja3BlYTogeyBlbjogXCJjaGlja3BlYVwiLCBmcjogXCJsZSBwb2lzIGNoaWNoZVwiIH0sXG4gICAgICBPa3JhOiB7IGVuOiBcIm9rcmFcIiwgZnI6IFwibGUgZ29tYm9cIiB9LFxuICAgICAgXCJTd2VldCBQb3RhdG9cIjogeyBlbjogXCJzd2VldCBwb3RhdG9cIiwgZnI6IFwibGEgcGF0YXRlIGRvdWNlXCIgfSxcbiAgICAgIFwiRm9kZGVyIExlZ3VtZVwiOiB7XG4gICAgICAgIGVuOiBcImZvZGRlciBsZWd1bWVcIixcbiAgICAgICAgZnI6IFwibGEgbMOpZ3VtaW5ldXNlIGZvdXJyYWfDqHJlXCJcbiAgICAgIH0sXG4gICAgICBCYXJsZXk6IHsgZW46IFwiYmFybGV5XCIsIGZyOiBcImwnb3JnZVwiIH0sXG4gICAgICBPbGl2ZTogeyBlbjogXCJvbGl2ZVwiLCBmcjogXCJsJ29saXZlXCIgfSxcbiAgICAgIENhYmJhZ2U6IHsgZW46IFwiY2FiYmFnZVwiLCBmcjogXCJsZSBjaG91XCIgfSxcbiAgICAgIFwiQmFuYW5hIFN3ZWV0XCI6IHsgZW46IFwiYmFuYW5hIHN3ZWV0XCIsIGZyOiBcImxhIGJhbmFuZSBkb3VjZVwiIH0sXG4gICAgICBSYXBlOiB7IGVuOiBcInJhcGVcIiwgZnI6IFwibGUgY29semFcIiB9LFxuICAgICAgU3VuZmxvd2VyOiB7IGVuOiBcInN1bmZsb3dlclwiLCBmcjogXCJsZSB0b3VybmVzb2xcIiB9LFxuICAgICAgXCJDb29raW5nIEJhbmFuYVwiOiB7XG4gICAgICAgIGVuOiBcImNvb2tpbmcgYmFuYW5hXCIsXG4gICAgICAgIGZyOiBcImxhIGJhbmFuZSBkZSBjdWlzaW5lXCJcbiAgICAgIH0sXG4gICAgICBTZXNhbWU6IHsgZW46IFwic2VzYW1lXCIsIGZyOiBcImxlIHPDqXNhbWVcIiB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZvcm1hdCBudW1iZXIsIGxvbmcgbm90YXRpb25cbmZvcm1hdE51bUNvbXBhY3RMb25nID0gZnVuY3Rpb24gKG51bWJlciwgeyBsb2NhbGUgPSBcImVuLVVTXCIgfSA9IHt9KSB7XG4gIHJldHVybiBuZXcgSW50bC5OdW1iZXJGb3JtYXQobG9jYWxlLCB7XG4gICAgbm90YXRpb246IFwiY29tcGFjdFwiLFxuICAgIGNvbXBhY3REaXNwbGF5OiBcImxvbmdcIixcbiAgICB1bml0RGlzcGxheTogXCJsb25nXCIsXG4gIH0pLmZvcm1hdChudW1iZXIpO1xufTtcblxuZm9ybWF0TnVtU3RhbmRhcmQgPSBmdW5jdGlvbiAobnVtYmVyLCB7IGxvY2FsZSA9IFwiZW4tVVNcIiB9ID0ge30pIHtcbiAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdChsb2NhbGUsIHt9KS5mb3JtYXQobnVtYmVyKTtcbn07XG5cbi8vIGZvcm1hdCBudW1iZXIsIDIgZGVjaW1hbCBwbGFjZXNcbmZvcm1hdE51bSA9IGQzLmZvcm1hdChcIi4yZlwiKTtcblxuZm9ybWF0Q29tbWEgPSBkMy5mb3JtYXQoXCIsXCIpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIFRSVUUgb3IgRkFMU0Ugc3RyaW5ncyAoZnJvbSBSKSwgb3RoZXJ3aXNlIG51bGxcbnBhcnNlQm9vbCA9IChkKSA9PiB7XG4gIGlmIChkID09PSBcIlRSVUVcIikgcmV0dXJuIHRydWU7XG4gIGlmIChkID09PSBcIkZBTFNFXCIpIHJldHVybiBmYWxzZTtcbiAgZWxzZSByZXR1cm4gbnVsbDtcbn07XG5cbi8vIFBhcnNpbmcgbnVtYmVycywgYmxhbmsgc3RyaW5ncyBhcyBOYU4nc1xucGFyc2VOdW0gPSAoZCkgPT4ge1xuICBpZiAodHlwZW9mIGQgPT09IFwibnVtYmVyXCIgJiYgIWlzTmFOKGQpKSByZXR1cm4gZDtcbiAgcmV0dXJuIGQudHJpbSgpID09PSBcIlwiID8gTmFOIDogK2Q7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNvbG9yWWVsbG93R3JlZW4gPSBbXCIjRjdENzMyXCIsIFwiIzIxNjcyOVwiXVxuXG4vLyBhZXogY29sb3Igc2NhbGVcbmFlekNvbG9yX25ldyA9IHtcbiAgY29uc3QgbG9va3VwQUVaID0gKGFleikgPT4gX2xhbmcodGQuQUVaX0NsYXNzX0ZBTy52YWx1ZXNbYWV6XSlcbiAgcmV0dXJuIHtcbiAgICBkb21haW46IFtcbiAgICAgIGxvb2t1cEFFWignRGVzZXJ0L0FyaWQgY2xpbWF0ZScpLFxuICAgICAgbG9va3VwQUVaKFwiVHJvcGljcywgaGlnaGxhbmQ7IHNlbWktYXJpZFwiKSxcbiAgICAgIGxvb2t1cEFFWihcIlRyb3BpY3MsIGxvd2xhbmQ7IHNlbWktYXJpZFwiKSxcbiAgICAgIGxvb2t1cEFFWihcIlN1YnRyb3BpY3MsIG1vZGVyYXRlbHkgY29vbDsgc3ViLWh1bWlkXCIpLFxuICAgICAgbG9va3VwQUVaKFwiVHJvcGljcywgaGlnaGxhbmQ7IHN1Yi1odW1pZFwiKSxcbiAgICAgIGxvb2t1cEFFWihcIlRyb3BpY3MsIGxvd2xhbmQ7IHN1Yi1odW1pZFwiKSxcbiAgICAgIGxvb2t1cEFFWihcIlRyb3BpY3MsIGhpZ2hsYW5kOyBodW1pZFwiKSxcbiAgICAgIGxvb2t1cEFFWihcIlRyb3BpY3MsIGxvd2xhbmQ7IGh1bWlkXCIpLFxuICAgICAgbG9va3VwQUVaKFwiTGFuZCB3aXRoIGFtcGxlIGlycmlnYXRlZCBzb2lsc1wiKSxcbiAgICAgIGxvb2t1cEFFWihcIlNldmVyZSBzb2lsL3RlcnJhaW4gbGltaXRhdGlvbnNcIiksXG4gICAgICBsb29rdXBBRVooXCJEb21pbmFudGx5IHVyYmFuL2J1aWx0LXVwIGxhbmRcIiksXG4gICAgXSxcbiAgICByYW5nZTogW1xuICAgICAgXCIjRjNENkIwXCIsXG4gICAgICBcIiNGQ0EwMzRcIixcbiAgICAgIFwiI0Y3RDczMlwiLFxuICAgICAgXCIjNTIzRDRFXCIsXG4gICAgICBcIiNFRjZEOTRcIixcbiAgICAgIFwiI0Y5QjFDMVwiLFxuICAgICAgXCIjMkE3OUE4XCIsXG4gICAgICBcIiM3OUExQjdcIixcbiAgICAgIFwiIzc0Qjk1QVwiLFxuICAgICAgXCIjMkU3NjM3XCIsXG4gICAgICBcIiNCMUIxQjFcIlxuICAgIF1cbiAgfTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyByZWFkIGV4Y2VsIHNoZWV0XG53b3JrYm9va19tZWFuRGlmZmVyZW5jZSA9IEZpbGVBdHRhY2htZW50KFwiL2RhdGEvRGlzY292ZXJTb2x1dGlvbnMvTWVhbl95aWVsZF9kaWZmZXJlbmNlLnhsc3hcIikueGxzeCgpXG5cbmRhdGFfZXh0ZW5kZWRUYWJsZTIgPSB7XG4gIC8vIGRhdGEgZnJvbSBmaWxlXG4gIGNvbnN0IGZpbGUgPSBGaWxlQXR0YWNobWVudChcIi9kYXRhL0Rpc2NvdmVyU29sdXRpb25zL3Nwb3RsaWdodDJfRXh0ZW5kZWQgVGFibGUgMi5jc3ZcIikuY3N2KCk7XG5cbiAgLy8gcmV0dXJuIGRhdGFcbiAgcmV0dXJuIGZpbGUudGhlbigoeCkgPT4ge1xuICAgIHJldHVybiB4Lm1hcCgocm93KSA9PiAoe1xuICAgICAgcHJhY3RpY2U6IFN0cmluZyhyb3cuUHJhY3RpY2UpLFxuICAgICAgb3V0Y29tZTogU3RyaW5nKHJvdy5PdXRjb21lKSxcbiAgICAgIHByb2R1Y3Q6IFN0cmluZyhyb3cuUHJvZHVjdCksXG4gICAgICBpc19jb21ibzogcGFyc2VCb29sKHJvd1tcIklzLkNvbWJvXCJdKSxcbiAgICAgIG9ic2VydmF0aW9uczogcGFyc2VOdW0ocm93Lk9ic2VydmF0aW9ucyksXG4gICAgICBzdHVkaWVzOiBwYXJzZU51bShyb3cuU3R1ZGllcyksXG4gICAgICB2YWx1ZTogcGFyc2VOdW0ocm93LlZhbHVlKSxcbiAgICAgIHNpZzogcGFyc2VOdW0ocm93LlNpZyksXG4gICAgICB2YWx1ZV9zZTogcGFyc2VOdW0ocm93W1wiVmFsdWUuc2VcIl0pLFxuICAgICAgY2lfbG93OiBwYXJzZU51bShyb3cuQ0lsb3cpLFxuICAgICAgY2lfaGlnaDogcGFyc2VOdW0ocm93LkNJaGlnaCksXG4gICAgICBzb3VyY2U6IFN0cmluZyhyb3cuU291cmNlKVxuICAgIH0pKTtcbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YV9leHRlbmRlZFRhYmxlMl90b3RhbCA9IHtcbiAgLy8gZGF0YSBmcm9tIGZpbGVcbiAgY29uc3QgZmlsZSA9IEZpbGVBdHRhY2htZW50KFwiL2RhdGEvRGlzY292ZXJTb2x1dGlvbnMvc3BvdGxpZ2h0Ml9FeHRlbmRlZCBUYWJsZSAyQDEuY3N2XCIpLmNzdigpO1xuXG4gIC8vIHJldHVybiBkYXRhXG4gIHJldHVybiBmaWxlLnRoZW4oKHgpID0+IHtcbiAgICByZXR1cm4geC5tYXAoKHJvdykgPT4gKHtcbiAgICAgIHByYWN0aWNlOiBTdHJpbmcocm93LlByYWN0aWNlKSxcbiAgICAgIG91dGNvbWU6IFN0cmluZyhyb3cuT3V0Y29tZSksXG4gICAgICBwcm9kdWN0OiBTdHJpbmcocm93LlByb2R1Y3QpLFxuICAgICAgLy8gaXNfY29tYm86IHBhcnNlQm9vbChyb3dbXCJJcy5Db21ib1wiXSksXG4gICAgICBvYnNlcnZhdGlvbnM6IHBhcnNlTnVtKHJvdy5PYnNlcnZhdGlvbnMpLFxuICAgICAgc3R1ZGllczogcGFyc2VOdW0ocm93LlN0dWRpZXMpLFxuICAgICAgdmFsdWU6IHBhcnNlTnVtKHJvdy5WYWx1ZSksXG4gICAgICBzaWc6IHBhcnNlTnVtKHJvdy5TaWcpLFxuICAgICAgdmFsdWVfc2U6IHBhcnNlTnVtKHJvd1tcIlZhbHVlLnNlXCJdKSxcbiAgICAgIGNpX2xvdzogcGFyc2VOdW0ocm93LkNJbG93KSxcbiAgICAgIGNpX2hpZ2g6IHBhcnNlTnVtKHJvdy5DSWhpZ2gpLFxuICAgICAgLy8gc291cmNlOiBTdHJpbmcocm93LlNvdXJjZSlcbiAgICB9KSk7XG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNzYU1hbnVhbHMgPSB7XG4gIGNvbnN0IGZpbGUgPSBGaWxlQXR0YWNobWVudChcIi9kYXRhL0Rpc2NvdmVyU29sdXRpb25zL0NTQS1NYW51YWxzX1NoZWV0MS5jc3ZcIikuY3N2KClcblxuICAvLyBwYXJzZSBjb2x1bW5zXG4gIHJldHVybiBmaWxlLnRoZW4oKHgpID0+IHtcbiAgICByZXR1cm4geC5tYXAoZCA9PiAoe1xuICAgICAgcHJhY3RpY2U6IFN0cmluZyhkWydQcmFjdGljZSddKS50cmltKCksXG4gICAgICBjb3VudHJ5X3JlZ2lvbjogU3RyaW5nKGRbJ0NvdW50cnkgb3IgUmVnaW9uJ10pLnRyaW0oKSxcbiAgICAgIHN5c3RlbTogU3RyaW5nKGRbJ1N5c3RlbSddKS50cmltKCksXG4gICAgICBhdXRob3I6IFN0cmluZyhkWydBdXRob3InXSkudHJpbSgpLFxuICAgICAgdGl0bGU6IFN0cmluZyhkWydUaXRsZSddKS50cmltKCksXG4gICAgICBsaW5rOiBTdHJpbmcoZFsnTGluayddKS50cmltKClcbiAgICB9KSlcbiAgfSlcbn1cblxuLy8gc2VsZWN0aW9uc1xuY3NhUmVzb3VyY2VIdG1sID0ge1xuICBjb25zdCBkYXRhID0gVC50aWR5KFxuICAgIGNzYU1hbnVhbHMsXG4gICAgVC5maWx0ZXIoKGQpID0+IGQucHJhY3RpY2UgPT0gc2VsZWN0UmVzb3VyY2VQcmFjdGljZS5maWVsZCksXG4gICAgVC5hcnJhbmdlKFtcInN5c3RlbVwiLCBcInRpdGxlXCJdKVxuICApO1xuICBjb25zdCB0cmFuc2xhdGVTeXN0ZW0gPSAoZCkgPT4gX2xhbmcodGQuc3VtbWFyeVN5c3RlbXMudmFsdWVzPy5bZF0pO1xuICBjb25zdCBzeXN0ZW1Xb3JkID0gTGFuZy50b1RpdGxlQ2FzZShfbGFuZyh0ZC5zdW1tYXJ5U3lzdGVtcykpXG5cbiAgY29uc3QgaHRtbExpc3QgPSBkYXRhLm1hcCgoZCkgPT4ge1xuICAgIGNvbnN0IHN5c3RlbSA9IHRyYW5zbGF0ZVN5c3RlbShkLnN5c3RlbSk7XG4gICAgcmV0dXJuIGA8bGkgc3R5bGU9J3BhZGRpbmc6IDEwcHggMCc+JHtzeXN0ZW19OiA8YSBocmVmPSR7ZC5saW5rfSB0YXJnZXQ9J19ibGFuayc+JHtkLnRpdGxlfTwvYT48L2xpPmA7XG4gIH0pO1xuXG4gIHJldHVybiBgPGI+JHtzeXN0ZW1Xb3JkfTwvYj5cbjx1bCBzdHlsZT0nbGlzdC1zdHlsZS10eXBlOm5vbmU7IHBhZGRpbmc6IDAnPiR7aHRtbExpc3Quam9pbihcbiAgICBcIlwiXG4gICl9PC91bD5gO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFfbWVhbkRpZmZfcHJhY3RpY2VDcm9wID0ge1xuICBjb25zdCByYXcgPSB3b3JrYm9va19tZWFuRGlmZmVyZW5jZS5zaGVldChcIlByYWN0aWNlX0Nyb3BcIiwgeyBoZWFkZXJzOiB0cnVlIH0pO1xuICByZXR1cm4gcmF3LmZpbHRlcigoZCkgPT4ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhkKS5sZW5ndGggPiAwXG4gICAgICAmJiBtZWFuRGlmZkNyb3BMaXN0LmluY2x1ZGVzKGQuQ3JvcClcbiAgfSk7XG59XG5cbmRhdGFfbWVhbkRpZmZfcHJhY3RpY2VDcm9wX25ldyA9IHtcbiAgY29uc3QgcmF3ID0gYXdhaXQgRmlsZUF0dGFjaG1lbnQoXCIvZGF0YS9EaXNjb3ZlclNvbHV0aW9ucy9maWd1cmVfMl9kYXRhQDEuY3N2XCIpLmNzdih7dHlwZWQ6IHRydWV9KVxuXG4gIHJldHVybiByYXcubWFwKGQgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBQcmFjdGljZTogZFsnUHJhY3RpY2UnXSxcbiAgICAgIENyb3A6IGRbJ0Nyb3AnXSxcbiAgICAgIE5fT2JzOiBkWydOX09icyddLFxuICAgICAgTl9QdWI6IGRbXCJOX1B1YlwiXSxcbiAgICAgIE1lYW5fVHJlYXRtZW50OiBkW1wiTWVhbl9UXCJdLFxuICAgICAgTWVhbl9Db250cm9sOiBkW1wiTWVhbl9DXCJdLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiBkW1wiTWVhbl9EaWZmZXJlbmNlXCJdLFxuICAgICAgU2U6IGRbJ1NlJ10sXG4gICAgICBMb3dlcjogZFtcIkxvd2VyXCJdLFxuICAgICAgVXBwZXI6IGRbXCJVcHBlclwiXSxcbiAgICB9XG4gIH0pXG59XG5cbi8vIHNoYXJlZCBjb2x1bW4gZm9yIG1lYW4gZGlmZmVyZW5jZSBkb3QgcGxvdHNcbnZpZXdvZiBzZWxlY3RDcm9wTWVhbkRpZmYgPSBJbnB1dHMuc2VsZWN0KG1lYW5EaWZmQ3JvcExpc3QsIHtsYWJlbDogXCJDcm9wXCIsIHVuaXF1ZTogdHJ1ZSwgc29ydDogdHJ1ZSwgdmFsdWU6ICdNYWl6ZSd9KVxuXG4vLyBsaXN0IG9mIGNyb3BzIHRvIHNob3cgZm9yIG1lYW4gZGlmZmVyZW5jZSAoc3R1ZHkgY3V0b2ZmKVxubWVhbkRpZmZDcm9wTGlzdCA9IFtcbiAgJ01haXplJyxcbiAgJ0Nvd3BlYScsXG4gICdTb3JnaHVtJyxcbiAgJ1JpY2UnLFxuICAnUGVhcmwgTWlsbGV0JyxcbiAgJ0Nhc3NhdmEgb3IgWXVjYScsXG4gICdDb21tb24gQmVhbicsXG4gICdHcm91bmRudXQnLFxuICAnU295YmVhbicsXG4gICdXaGVhdCcsXG4gICdUb21hdG8nLFxuICAnUG90YXRvJyxcbiAgJ1lhbScsXG4gICdDb3R0b24nLFxuICAnU3VnYXIgQ2FuZScsXG4gICdPa3JhJyxcbiAgJ1N3ZWV0IFBvdGF0bycsXG4gICdUZWZmJyxcbiAgJ1BpZ2VvbiBQZWEnLFxuICAnU2VzYW1lIFNlZWQnLFxuXVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFfbWVhbkRpZmZfYWV6UHJhY3RpY2VDcm9wX25ldyA9IHtcbiAgY29uc3QgcmF3ID0gYXdhaXQgRmlsZUF0dGFjaG1lbnQoXCIvZGF0YS9EaXNjb3ZlclNvbHV0aW9ucy9NZWFuX3lpZWxkX2RpZmZlcmVuY2VAMS5jc3ZcIikuY3N2KHt0eXBlZDogdHJ1ZX0pXG4gIFxuICBjb25zdCBmb3JtYXR0ZWQgPSBULnRpZHkoXG4gICAgcmF3LFxuICAgIFQuZmlsdGVyKChkKSA9PiBPYmplY3Qua2V5cyhkKS5sZW5ndGggPiAwKSxcbiAgICBULnJlbmFtZSh7XG4gICAgICBNZWFuX1Q6ICdNZWFuX1RyZWF0bWVudCcsXG4gICAgICBNZWFuX0M6ICdNZWFuX0NvbnRyb2wnLFxuICAgIH0pXG4gIClcbiAgcmV0dXJuIGZvcm1hdHRlZFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFfbGNsUmlzayA9IGRhdGFfZXh0ZW5kZWRUYWJsZTIuZmlsdGVyKChkKSA9PiBkLm91dGNvbWUgPT0gXCJMQ0wgUmlza1wiKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhZG9wdGlvbkZhY3RvckFsbExhYmVsID0gXCJBbGwgcHJhY3RpY2VzXCJcblxucmF3QWRvcHRpb25GYWN0b3JzID0ge1xuICBjb25zdCByYXcgPSBhd2FpdCBGaWxlQXR0YWNobWVudChcIi9kYXRhL0Rpc2NvdmVyU29sdXRpb25zL2Fkb3B0aW9uX2ZhY3RvcnNfMjBtYXIyNC5jc3ZcIikuY3N2KClcblxuICByZXR1cm4gcmF3Lm1hcChkID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgaW5kZXg6IGRbJyddLFxuICAgICAgcHJhY3RpY2U6IFN0cmluZyhkWydwcmFjdGljZXMnXSksXG4gICAgICBmYWN0b3I6IFN0cmluZyhkWydhZG9wdGlvbl9mYWN0b3JzJ10pLFxuICAgICAgZGlyZWN0aW9uOiBTdHJpbmcoZFsnZGlyZWN0aW9uJ10pLFxuICAgICAgbjogcGFyc2VOdW0oZC5uKVxuICAgIH1cbiAgfSlcbn1cblxuZGF0YUFkb3B0aW9uRmFjdG9ycyA9IHtcbiAgY29uc3QgYWxsUHJhY3RpY2VzID0gVC50aWR5KFxuICAgIHJhd0Fkb3B0aW9uRmFjdG9ycyxcbiAgICBULmdyb3VwQnkoXG4gICAgICBbXCJmYWN0b3JcIiwgXCJkaXJlY3Rpb25cIl0sXG4gICAgICBbXG4gICAgICAgIFQuc3VtbWFyaXplKHtcbiAgICAgICAgICBuOiBULnN1bShcIm5cIilcbiAgICAgICAgfSlcbiAgICAgIF1cbiAgICApLFxuICAgIFQuZ3JvdXBCeShcbiAgICAgIFtcImZhY3RvclwiXSxcbiAgICAgIFtcbiAgICAgICAgVC5tdXRhdGVXaXRoU3VtbWFyeSh7XG4gICAgICAgICAgdG90YWw6IFQuc3VtKFwiblwiKVxuICAgICAgICB9KVxuICAgICAgXVxuICAgICksXG4gICAgVC5tdXRhdGUoeyBwZXJjOiAoZCkgPT4gKGQubiAvIGQudG90YWwpICogMTAwIH0pLFxuICAgIFQubXV0YXRlKHsgcHJhY3RpY2U6IChkKSA9PiBhZG9wdGlvbkZhY3RvckFsbExhYmVsIH0pLFxuICAgIFQuc2VsZWN0KFtcInByYWN0aWNlXCIsIFQuZXZlcnl0aGluZygpXSlcbiAgKTtcblxuICBjb25zdCB3cmFuZ2xlZCA9IFQudGlkeShcbiAgICByYXdBZG9wdGlvbkZhY3RvcnMsXG4gICAgVC5zZWxlY3QoVC5uZWdhdGUoXCJpbmRleFwiKSksXG4gICAgVC5ncm91cEJ5KFxuICAgICAgW1wicHJhY3RpY2VcIiwgXCJmYWN0b3JcIl0sXG4gICAgICBbVC5tdXRhdGVXaXRoU3VtbWFyeSh7IHRvdGFsOiBULnN1bShcIm5cIikgfSldXG4gICAgKSxcbiAgICBULm11dGF0ZSh7XG4gICAgICBwZXJjOiAoZCkgPT4gKGQubiAvIGQudG90YWwpICogMTAwXG4gICAgfSlcbiAgKTtcblxuICByZXR1cm4gW1xuICAgIC4uLndyYW5nbGVkLFxuICAgIC4uLmFsbFByYWN0aWNlc1xuICBdXG59XG5cbi8vIG1hcHBlZCBhZG9wdGlvbiBkYXRhXG5kYXRhQWRvcHRpb25GYWN0b3JzTWFwID0gZDMuZ3JvdXAoZGF0YUFkb3B0aW9uRmFjdG9ycywgZCA9PiBkLnByYWN0aWNlKVxuXG5hZG9wdGlvbkZhY3RvcnNMb29rdXAgPSAoe1xuICBcIk5vdCBzaWduaWZpY2FudFwiOiBfbGFuZyhuYlRleHQuYWRvcHRpb25GYWN0b3JzLnBsb3QubGFiZWxzLm5vdFNpZyksXG4gIFwiTmVnYXRpdmVcIjogX2xhbmcobmJUZXh0LmFkb3B0aW9uRmFjdG9ycy5wbG90LmxhYmVscy5uZWcpLFxuICBcIlBvc2l0aXZlXCI6IF9sYW5nKG5iVGV4dC5hZG9wdGlvbkZhY3RvcnMucGxvdC5sYWJlbHMucG9zKSxcbn0pXG5cbmZ1bmN0aW9uIG1hcmtCb2xkU2lkZWJhclRleHQoZGF0YSwge3RleHRGb3JtYXQ9KGQpID0+IGQgKyAnIG9icy4nLCAuLi5vcHRpb25zIH0gPSB7fSkge1xuICByZXR1cm4gUGxvdC5tYXJrcyhcbiAgICAvLyBvYnNlcnZhdGlvbiBjb3VudHNcbiAgICBQbG90LnRleHRZKFxuICAgICAgZGF0YSxcbiAgICAgIFBsb3QubWFwKFxuICAgICAgICB7IHRleHQ6ICh2YWx1ZXMpID0+IHZhbHVlcy5tYXAoKGQpID0+IHRleHRGb3JtYXQoZCkpIH0sXG4gICAgICAgIFBsb3QuZ3JvdXBZKFxuICAgICAgICAgIHsgdGV4dDogXCJzdW1cIiB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZyYW1lQW5jaG9yOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICB0ZXh0QW5jaG9yOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICBkeDogMTYsXG4gICAgICAgICAgICAuLi5vcHRpb25zXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICApXG4gICAgKSxcbiAgICAvLyBkaWdpdGFsIHdoaXRlLW91dFxuICAgIFBsb3QudGV4dFkoXG4gICAgICBkYXRhLFxuICAgICAgUGxvdC5wb2ludGVyWShcbiAgICAgICAgUGxvdC5tYXAoXG4gICAgICAgICAgeyB0ZXh0OiAodmFsdWVzKSA9PiB2YWx1ZXMubWFwKChkKSA9PiB0ZXh0Rm9ybWF0KGQpKSB9LFxuICAgICAgICAgIFBsb3QuZ3JvdXBZKFxuICAgICAgICAgICAgeyB0ZXh0OiBcInN1bVwiIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIC8vIHk6IFwiZmFjdG9yXCIsXG4gICAgICAgICAgICAgIC8vIHRleHQ6IFwiblwiLFxuICAgICAgICAgICAgICBmcmFtZUFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICAgIGR4OiAxNixcbiAgICAgICAgICAgICAgZmlsbDogXCJ3aGl0ZVwiLFxuICAgICAgICAgICAgICBzdHJva2U6IFwid2hpdGVcIixcbiAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDIsXG4gICAgICAgICAgICAgIC4uLm9wdGlvbnNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICApLFxuICAgIC8vIG9ic2VydmF0aW9uIGNvdW50cyBib2xkIGhvdmVyXG4gICAgUGxvdC50ZXh0WShcbiAgICAgIGRhdGEsXG4gICAgICBQbG90LnBvaW50ZXJZKFxuICAgICAgICBQbG90Lm1hcChcbiAgICAgICAgICB7IHRleHQ6ICh2YWx1ZXMpID0+IHZhbHVlcy5tYXAoKGQpID0+IHRleHRGb3JtYXQoZCkpIH0sXG4gICAgICAgICAgUGxvdC5ncm91cFkoXG4gICAgICAgICAgICB7IHRleHQ6IFwic3VtXCIgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgLy8geTogXCJmYWN0b3JcIixcbiAgICAgICAgICAgICAgLy8gdGV4dDogXCJuXCIsXG4gICAgICAgICAgICAgIGZyYW1lQW5jaG9yOiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgIHRleHRBbmNob3I6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgZHg6IDE2LFxuICAgICAgICAgICAgICBmb250V2VpZ2h0OiBcImJvbGRcIixcbiAgICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICAgICAgfVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJpbXBvcnQgeyBUIH0gZnJvbSBcIkBwYmVzaGFpL3RpZHlqc1wiO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwcmV0dHlMYW5ndWFnZVZpZXcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0Q3JvcE1lYW5EaWZmX25ldycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdyYWRpb1NvcnREb3RQbG90Q3JvcF9uZXcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndG9nZ2xlQ0lzQ3JvcF9uZXcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0Q3JvcE1lYW5EaWZmQUVaJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3JhZGlvU29ydERvdFBsb3RDcm9wQUVaX25ldycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhZXpTZWxlY3RfbmV3JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3RvZ2dsZUNJc0Nyb3BBRVpfbmV3JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdFByYWN0aWNlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2RhdGFBZG9wdGlvbkZhY3RvcnNfc2VsZWN0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3JhZGlvU29ydEFkb3B0aW9uRmFjdG9ycycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzZWxlY3RSZXNvdXJjZVByYWN0aWNlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2xhbmd1YWdlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdENyb3BNZWFuRGlmZicpIn1dfQ==</script><script type="module">"file:"===window.location.protocol&&alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."),window._ojs.paths.runtimeToDoc="../../notebooks/solutionsNB",window._ojs.paths.runtimeToRoot="../..",window._ojs.paths.docToRoot="../..",window._ojs.selfContained=!1,window._ojs.runtime.interpretFromScriptTags()</script><script id="quarto-html-after-body" type="application/javascript">window.document.addEventListener("DOMContentLoaded",function(t){const e=t=>{for(const e of t.classList)if(e.startsWith("code-annotation-"))return!0;return!1},n=function(t){const e=t.trigger;e.blur(),e.classList.add("code-copy-button-checked");var n=e.getAttribute("title");let o;e.setAttribute("title","Copied!"),window.bootstrap&&(e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-placement","left"),e.setAttribute("data-bs-title","Copied!"),o=new bootstrap.Tooltip(e,{trigger:"manual",customClass:"code-copy-button-tooltip",offset:[0,-8]}),o.show()),setTimeout(function(){o&&(o.hide(),e.removeAttribute("data-bs-title"),e.removeAttribute("data-bs-toggle"),e.removeAttribute("data-bs-placement")),e.setAttribute("title",n),e.classList.remove("code-copy-button-checked")},1e3),t.clearSelection()},o=function(t){const n=t.parentElement.cloneNode(!0).querySelector("code");for(const t of n.children)e(t)&&t.remove();return n.innerText};if(new window.ClipboardJS(".code-copy-button:not([data-in-quarto-modal])",{text:o}).on("success",n),window.document.getElementById("quarto-embedded-source-code-modal")){new window.ClipboardJS(".code-copy-button[data-in-quarto-modal]",{text:o,container:window.document.getElementById("quarto-embedded-source-code-modal")}).on("success",n)}for(var i=new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//),a=new RegExp(/^mailto:/),l=new RegExp("https://adaptationatlas.github.io/atlas_notebooks/"),r=t=>l.test(t)||i.test(t)||a.test(t),d=window.document.querySelectorAll("a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"),c=0;c<d.length;c++){const t=d[c];r(t.href)||void 0!==t.dataset.originalHref&&(t.href=t.dataset.originalHref)}function s(t,e,n,o){const i={allowHTML:!0,maxWidth:500,delay:100,arrow:!1,appendTo:function(t){return t.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"bottom-start"};e&&(i.content=e),n&&(i.onTrigger=n),o&&(i.onUntrigger=o),window.tippy(t,i)}const u=window.document.querySelectorAll('a[role="doc-noteref"]');for(c=0;c<u.length;c++){const t=u[c];s(t,function(){let e=t.getAttribute("data-footnote-href")||t.getAttribute("href");try{e=new URL(e).hash}catch{}const n=e.replace(/^#\/?/,""),o=window.document.getElementById(n);return o?o.innerHTML:""})}const h=window.document.querySelectorAll("a.quarto-xref"),m=(t,e)=>{const n=t=>{if(t.classList.remove("page-full","page-columns"),t.children)for(const e of t.children)n(e)};if(n(e),null===t||t.startsWith("sec-")){const t=document.createElement("div");if(e.children&&e.children.length>2){t.appendChild(e.children[0].cloneNode(!0));for(let n=1;n<e.children.length;n++){const o=e.children[n];if("P"!==o.tagName||""!==o.innerText){t.appendChild(o.cloneNode(!0));break}}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.innerHTML}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.innerHTML}{const t=e.querySelector("a.anchorjs-link");return t&&t.remove(),window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.classList.contains("callout")?e.outerHTML:e.innerHTML}};for(c=0;c<h.length;c++){const t=h[c];s(t,void 0,function(e){e.disable();let n,o=t.getAttribute("href");if(o.startsWith("#"))n=o;else try{n=new URL(o).hash}catch{}if(n){const t=n.replace(/^#\/?/,""),i=window.document.getElementById(t);if(null!==i)try{const n=m(t,i.cloneNode(!0));e.setContent(n)}finally{e.enable(),e.show()}else fetch(o.split("#")[0]).then(t=>t.text()).then(n=>{const o=(new DOMParser).parseFromString(n,"text/html").getElementById(t);if(null!==o){const n=m(t,o);e.setContent(n)}}).finally(()=>{e.enable(),e.show()})}else fetch(o).then(t=>t.text()).then(t=>{const n=(new DOMParser).parseFromString(t,"text/html").querySelector("main.content");if(null!==n){n.children.length>0&&"HEADER"===n.children[0].tagName&&n.children[0].remove();const t=m(null,n);e.setContent(t)}}).finally(()=>{e.enable(),e.show()})},function(t){})}let w;const g=t=>{window.document;const e=t.getAttribute("data-target-cell"),n=t.getAttribute("data-target-annotation");const o=window.document.querySelector('span[data-code-cell="'+e+'"][data-code-annotation="'+n+'"]').getAttribute("data-code-lines").split(",").map(t=>e+"-"+t);let i=null,a=null,l=null;if(o.length>0){const n=window.document.getElementById(o[0]);if(i=n.offsetTop,a=n.offsetHeight,l=n.parentElement.parentElement,o.length>1){const t=window.document.getElementById(o[o.length-1]);a=t.offsetTop+t.offsetHeight-i}if(null!==i&&null!==a&&null!==l){let t=window.document.getElementById("code-annotation-line-highlight");null===t&&(t=window.document.createElement("div"),t.setAttribute("id","code-annotation-line-highlight"),t.style.position="absolute",l.appendChild(t)),t.style.top=i-2+"px",t.style.height=a+4+"px",t.style.left=0;let n=window.document.getElementById("code-annotation-line-highlight-gutter");if(null===n){n=window.document.createElement("div"),n.setAttribute("id","code-annotation-line-highlight-gutter"),n.style.position="absolute";window.document.getElementById(e).querySelector(".code-annotation-gutter").appendChild(n)}n.style.top=i-2+"px",n.style.height=a+4+"px"}w=t}},p=()=>{["code-annotation-line-highlight","code-annotation-line-highlight-gutter"].forEach(t=>{const e=window.document.getElementById(t);e&&e.remove()}),w=void 0};window.addEventListener("resize",function(t,e){let n,o=!1;return(...i)=>{o?(n&&clearTimeout(n),n=setTimeout(()=>{t.apply(this,i),n=o=!1},e)):(t.apply(this,i),o=!0)}}(()=>{elRect=void 0,w&&g(w)},10));const f=window.document.querySelectorAll("dt[data-target-cell]");for(const t of f)t.addEventListener("click",t=>{const e=t.target;if(e!==w){p();const t=window.document.querySelector("dt[data-target-cell].code-annotation-active");t&&t.classList.remove("code-annotation-active"),g(e),e.classList.add("code-annotation-active")}else p(),e.classList.remove("code-annotation-active")});const b=t=>{const e=t.parentElement;if(e){const n=e.dataset.cites;return n?{el:t,cites:n.split(" ")}:b(t.parentElement)}};var y=window.document.querySelectorAll('a[role="doc-biblioref"]');for(c=0;c<y.length;c++){const t=y[c],e=b(t);e&&s(e.el,function(){var t=window.document.createElement("div");return e.cites.forEach(function(e){var n=window.document.createElement("div");n.classList.add("hanging-indent"),n.classList.add("csl-entry");var o=window.document.getElementById("ref-"+e);o&&(n.innerHTML=o.innerHTML),t.appendChild(n)}),t.innerHTML})}})</script></div></body></html>