<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta charset="utf-8"><meta name="generator" content="quarto-1.7.30"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes"><title>Atlas Notebook Guidelines</title><style>code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}div.columns{display:flex;gap:min(4vw,1.5em)}div.column{flex:auto;overflow-x:auto}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}ul.task-list li input[type=checkbox]{width:.8em;margin:0 .8em .2em -1em;vertical-align:middle}html{-webkit-text-size-adjust:100%}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em}pre.numberSource{margin-left:3em;padding-left:4px}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}</style><script src="../site_libs/quarto-nav/quarto-nav.js"></script><script src="../site_libs/quarto-nav/headroom.min.js"></script><link href="../images/atlas-icon.svg" rel="icon" type="image/svg+xml"><script src="../site_libs/clipboard/clipboard.min.js"></script><script src="../site_libs/quarto-html/quarto.js" type="module"></script><script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script><script src="../site_libs/quarto-html/popper.min.js"></script><script src="../site_libs/quarto-html/tippy.umd.min.js"></script><link href="../site_libs/quarto-html/tippy.css" rel="stylesheet"><link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="../site_libs/bootstrap/bootstrap.min.js"></script><link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"><link href="../site_libs/bootstrap/bootstrap-0a17c0afbaa279986b575ad00bd51621.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet"><link rel="stylesheet" href="../styles.css"></head><body class="nav-fixed quarto-light"><div id="quarto-search-results"></div><header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg" data-bs-theme="dark"><div class="navbar-container container-fluid"><div class="navbar-brand-container mx-auto"><a href="https://adaptationatlas.cgiar.org" class="navbar-brand navbar-brand-logo"><img src="../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo"></a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="window.quartoToggleHeadroom&&window.quartoToggleHeadroom()"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav navbar-nav-scroll ms-auto"><li class="nav-item"><a class="nav-link" href="../docs/doc_index.html"><i class="bi bi-info-circle" role="img" aria-label="More Information"></i> <span class="menu-text">Documentation</span></a></li><li class="nav-item"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks/issues/new"><span class="menu-text">Report an Issue</span></a></li><li class="nav-item compact"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks"><i class="bi bi-github" role="img" aria-label="GitHub"></i> <span class="menu-text"></span></a></li></ul></div><div class="quarto-navbar-tools"></div></div></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"><main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><div class="cell"><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb1" data-startfrom="11" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 10"><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasHero } <span class="im">from</span> <span class="st">"/helpers/uiComponents.ojs"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> hero_url <span class="op">=</span> <span class="st">"./../images/default_crop.webp"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">atlasHero</span>(nbTitle<span class="op">,</span> hero_url)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-2" data-nodetype="expression"></div></div></div></div><section id="overview" class="level1"><h1>Overview</h1><p>This notebook includes guidelines for the Agriculture Adaptation Atlas’ collection of Data Exploration Notebooks. It suggests best practices for consistent styling, narrative structure, and example cells that can be used as the Alliance Bioversity team and the community creates their own notebooks.</p><p>Please note: this should be considered a <em>living document</em> that will be added to and adjusted as needed.</p></section><section id="creating-a-narrative" class="level1"><h1>Creating a Narrative</h1><p>To create a narrative for your Observable Notebook, we suggest following a general story arc and structure:</p><ol type="1"><li><strong>Hero Image (with title).</strong> A succinct title capturing the premise of the Notebook. See below for additional information on creating a hero image with help from the Alliance Bioversity team.</li><li><strong>Introductory Paragraph.</strong> Introductory framing text for the Notebook.</li><li><strong>Narrative Sections.</strong> 3-4 sections that convey a narrative. They include headers, descriptive text, data presentations, and dynamic insights (if applicable).</li></ol><ul><li>1-2 data presentations/visualizations per each section. As applicable, controls can be global and be synced across all sections</li><li>Brief descriptive text, explaining the section takeaway and any context about the chart.</li><li>If applicable, a set of dynamic Insights that update based on user selection of various controls of the charts, located below the chart</li></ul><ol start="4" type="1"><li><strong>Summary Paragraph.</strong> Summary text for the Notebook. This section may include</li></ol><ul><li>Higher-level dynamic insights that summarize the key takeaways of the Notebook</li><li>Next steps or actions users can take such as hyperlinks to additional resources.</li></ul><ol start="5" type="1"><li><strong>Methods &amp; Sources.</strong> Methods &amp; sources for the Notebook.</li><li><strong>Appendix.</strong> This large section includes any cells that power the Notebook. This should exist at the bottom of the Notebook to mitigate any disruption to the narrative.</li></ol><p>Please reach out to us if you need help crafting your narrative, and we’d be happy to help.</p></section><section id="notebook-elements" class="level1"><h1>Notebook Elements</h1><section id="headers" class="level2"><h2 data-anchor-id="headers">Headers</h2><p>We recommend using title case for headers. Main section headings should be a question which is answered by the narrative and figures in the following section. For example, instead of <em>“Identifying Risk Hotspots”</em>, consider using <em>“Where Is Most At Risk?”</em></p><p>To best format the sections within the narrative, please use header tags:</p><ul><li>Adding “#” before text creates an H1 header. Use it for headings of main sections.</li><li>Adding “##” before text creates an H2 header. Use it for chart titles.</li><li>Adding “###” before text creates an H3 header. Use it for subtitles within charts and for titles for data insights related to charts.</li></ul><p>Because our content requires dynamic headers for translation, the standard Quarto header syntax needs a slight adjustment. There are several ways to create dynamic headers, but the method described here is the most straightforward and closely aligned with standard Quarto formatting:</p><div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>heading1 <span class="op">=</span> <span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span> <span class="st">"Heading 1"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Titre 1"</span>}) <span class="co">// define ojs var for heading</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># ``{ojs} heading1` {#example-heading2} &lt;!-- Use the ojs var as a heading &amp; add an id--&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p>Note that the id for the heading is assigned. This is important for the TOC generation and is required.</p></section><section id="table-of-contents" class="level2"><h2 data-anchor-id="table-of-contents">Table of Contents</h2><p>We have put together a table of contents function that should be used across notebooks. This can be imported from the ‘helpers’ directory. Below is an example of its use:</p><div class="cell"><details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode cell-code" id="cb3" data-startfrom="61" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 60"><span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasTOC } <span class="im">from</span> <span class="st">"/helpers/uiComponents.ojs"</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>toc_bottom <span class="op">=</span> <span class="fu">atlasTOC</span>({</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="dt">skip</span><span class="op">:</span> [<span class="st">'notebook-title'</span><span class="op">,</span> <span class="st">'appendix'</span><span class="op">,</span> <span class="st">'source-code'</span>]<span class="op">,</span> <span class="co">// heading ids to skip</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="dt">heading</span><span class="op">:</span> <span class="vs">`&lt;b&gt;In This Notebook&lt;/b&gt;`</span><span class="op">,</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selector</span><span class="op">:</span> <span class="st">"h1"</span><span class="op">,</span> <span class="co">// Selectors to include (e.g., "h1,h2,h3")</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class='floating-toc'&gt;</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>toc_bottom<span class="sc">}</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="vs">      `</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-3" data-nodetype="expression"></div></div></div></div><p>Notice that by defining the id’s for each header, we can specify which ones to ignore in the TOC. The function defaults to only show h1 headers but this can be adjusted by changing the selector variable, but in general it should stay as h1. You can copy the code above to use in notebooks and it should work with no modifications.</p></section><section id="dynamic-insights" class="level2"><h2 data-anchor-id="dynamic-insights">Dynamic Insights</h2><p>As can be seen in the “What’s at Risk” notebook, we have developed dynamic insights within the text that changes based on the selection of various controls throughout the tool. To emphasize that this text is dynamic, we <strong>bold</strong> the dynamic portion of the sentence.</p><p>Dynamic Insights are to be placed in a subsection with an H3 header ““###”” below each visualization at the end of each main section.</p><p>These dynamic insights can be in partial or full sentence form, and in either an bulleted list or not (could vary depending on the specific insight).</p></section><section id="color-scales" class="level2"><h2 data-anchor-id="color-scales">Color Scales</h2><p>Below are some example linear color scales you can use, all defined by endpoint color values.</p><p>Please note that color scales may need to be designed on a chart-by-chart basis. The color scales listed below are a few developed for various charts in the “What’s at Risk?” and “On-farm Solutions for Today” notebooks.</p><p>Regarding the direction to apply the scales, we have been mapping green (from the yellowGreen scale) to normatively “better” values and red (from the orangeRed scale) to normatively “worse” values.</p><div class="cell"><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb4" data-startfrom="71" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 70"><span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>colorScales <span class="op">=</span> [</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">name</span><span class="op">:</span> <span class="st">"yellowGreen"</span><span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#216729"</span>] }<span class="op">,</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">name</span><span class="op">:</span> <span class="st">"orangeRed"</span><span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="st">"#F4BB21"</span><span class="op">,</span> <span class="st">"#EC5A47"</span>] }</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>viewof select <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(colorScales<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Show a color scale"</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">name</span>})</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"linear"</span><span class="op">,</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    <span class="dt">range</span><span class="op">:</span> select<span class="op">.</span><span class="at">range</span><span class="op">,</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">cell</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">50</span>)<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span> d})</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  <span class="dt">axis</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">padding</span><span class="op">:</span> <span class="op">-</span><span class="fl">0.1</span>}<span class="op">,</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">600</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-3-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-3-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-3-3" data-nodetype="expression"></div></div></div><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb5" data-startfrom="92" data-source-offset="-439"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 91"><span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>viewof copyImport <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span>(<span class="vs">`Copy </span><span class="sc">${</span>select<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs"> color range`</span><span class="op">,</span> {<span class="dt">reduce</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="bu">navigator</span><span class="op">.</span><span class="at">clipboard</span><span class="op">.</span><span class="fu">writeText</span>(select<span class="op">.</span><span class="at">range</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-3-4" data-nodetype="declaration"></div></div></div></div></section><section id="visualizations" class="level2"><h2 data-anchor-id="visualizations">Visualizations</h2><p>To ensure a good user experience, all plots, maps, and figures within the notebooks should have a consistent fixed height to prevent page shifts during interactive changes. A maximum height of <strong>800px</strong> is recommended, although it can be adjusted based on specific design requirements. The height parameter should be set, especially for maps, where different admins will have different sizes, resulting in large content shifts if not set. A maximum width of <strong>1000px</strong> is suggested. Text should be large enough to be read with ease.</p><p>Most previous Data Exploration Notebooks have used the Observable Plot library for creating visualizations. Examples using this library can be found <a href="https://observablehq.com/@observablehq/plot-gallery">here</a> or within the Atlas <a href="https://observablehq.com/d/7539fd16f4fc40e3">here</a>. Some also use d3 to create more complex or interactive visualizations. Any JS plotting library should work fine so long as they allow:</p><ul><li><strong>Dynamic Plots:</strong> Plots should adapt dynamically based on user inputs such as region or crop selection, provided no data is unavailable.</li><li><strong>Tooltips for Additional Information:</strong> Tooltips can enhance understanding but should not overwhelm the main plot. Plots should generally convey information succinctly and effectively.</li></ul></section><section id="data-download-buttons" class="level2"><h2 data-anchor-id="data-download-buttons">Data Download buttons</h2><p>Every figure should include a data download button that can be used to download the data used in the figure. For consistency and ease, there is a function in the <code>/helpers</code> folder that can be used to create the download button.</p><div class="sourceCode" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { downloadButton } <span class="im">from</span> <span class="st">"/helpers/uiComponents.ojs"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [{<span class="dt">a</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="dv">2</span>}<span class="op">,</span> {<span class="dt">a</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="dv">4</span>}<span class="op">,</span> {<span class="dt">a</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="dv">6</span>}]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">downloadButton</span>(data<span class="op">,</span> filename<span class="op">,</span> label <span class="op">=</span> <span class="st">"Download"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></section><section id="selectors" class="level2"><h2 data-anchor-id="selectors">Selectors</h2><p>The Observable standard library comes with many inputs/selectors pre-included. These should be used when possible, rather than building selectors from scratch or importing them from elsewhere. Documentation on these selectors can be found <a href="https://observablehq.com/documentation/inputs/overview">here</a> with many examples on <a href="https://observablehq.com/collection/@observablehq/inputs">ObservableHQ</a>. We use a custom CSS to modify the styling of these inputs, these should be automatically applied on quarto render and preview.</p><p>When multiple selectors are used together - such as to select multiple admin levels - they should be grouped together in a single horizontal block using an <code>Inputs.form</code>, or other methods where necessary. When multiple selectors are used across a notebook to select the same variable in different places, there should be one master selector that is updated when other selectors are used (using <code>Inputs.bind()</code>). The below example shows how to do this, along with how to use the <code>Inputs.form</code> selector to group selectors together:</p><div class="cell"><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb7" data-startfrom="107" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 106"><span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>viewof var1_master <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"var1"</span><span class="op">,</span> <span class="st">"var2"</span><span class="op">,</span> <span class="st">"var3"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Variable 1"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"var1"</span>})</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>viewof form <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>( <span class="co">// returns a JS object of {var1: ..., var2: ...}</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var1</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"1"</span><span class="op">,</span> <span class="st">"2"</span><span class="op">,</span> <span class="st">"3"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Variable 1"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> var1_master})<span class="op">,</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>      viewof var1_master</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var2</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"a"</span><span class="op">,</span> <span class="st">"b"</span><span class="op">,</span> <span class="st">"c"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Variable 2"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"var2"</span>})</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div style="display: flex; gap: 3em"&gt;</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(inputs)<span class="sc">}</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;`</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>form</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-3" data-nodetype="expression"></div></div></div><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb8" data-startfrom="127" data-source-offset="-542"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 126"><span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>var1_master</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-4-4" data-nodetype="expression"></div></div></div></div></section><section id="images" class="level2"><h2 data-anchor-id="images">Images</h2><p>Each notebook should include a single hero image in <code>.webp</code> format, optimized for minimal file size without noticeable quality loss. Save the image in the <code>/images</code> directory using the notebook’s name as the filename. Included in the <code>/helpers</code> folder is a function to crop an image to the required size of 800x175 pixels and convert it to <code>webP</code>, if not already in this format. It is not required to use this function, but images do need to be in webP and cropped to this size for best performance. If a specific part of the image should be used, it should be manually cropped, rather than using the function.</p><p>The below example shows how to use this function:</p><div class="sourceCode" id="cb9"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">quarto</span> run helpers/cropToWebP.ts <span class="st">'default_im.webp'</span> <span class="st">'default_crop.webp'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></section></section><section id="data" class="level1"><h1>Data</h1><section id="storing-data" class="level2"><h2 data-anchor-id="storing-data">Storing Data</h2><p>A lot of the processing of data is/should be done before hand due to the limitations of client-side processing and page performance. This pre-processed data should be stored in the Adaptation Atlas S3 bucket in a cloud-optimized format, such as parquet for tabular data. For development this data could be sotored elsewhere, but should be migrated to the Atlas S3 bucket for production. Get in touch with us to complete this. Files that may need to be updated should be stored in the S3 bucket to allow easier updating and version control.</p><p>To easily manage data and allow users to access the raw datasets being queried and pulled from the S3, data paths, alongside some metadata, should be stored in a JSON file in the notebook sub-directory in the <code>/data</code> folder. At minimum this should include a dataset name, source, and the sections the data is used. See the example below:</p><div class="sourceCode" id="cb10"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"HeatData"</span> <span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"source"</span><span class="fu">:</span> <span class="st">"https://digital-atlas.s3.us-east-1.amazonaws.com/heat.parquet"</span><span class="fu">,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Historical and Future heat Data"</span><span class="fu">,</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"sections"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Where is the heat?"</span><span class="ot">,</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"How hot will it be in the Future?"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"OtherData"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"source"</span><span class="fu">:</span> <span class="st">"https://digital-atlas.s3.us-east-1.amazonaws.com/example.parquet"</span><span class="fu">,</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Some More Data"</span><span class="fu">,</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"sections"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Section 1"</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p>Data can also be stored within the quarto project and loaded into quarto notebooks using <a href="https://observablehq.com/documentation/data/files/file-attachments">File Attachments</a>. <strong>This should be reserved for the translations and small files with a specific use - such as datasets needed for a single plot or files requiring a specific format.</strong> Any data stored within the project should be within a sub-directory in the <code>/data</code> folder with the notebook name.</p></section><section id="importing-data" class="level2"><h2 data-anchor-id="importing-data">Importing data</h2><p>In general, DuckDB-wasm should be used for data import, querying, and some data processing. DuckDB can be used to directly query parquet data from the S3 bucket in an incredibly efficient manner. Some of the datasets used may be extremly large and contain may rows and columns - importing all of them at once would be terrible for page performance. We strongly suggest dynamically querying data by admin region and variable of interest to limit the about of data imported at a time. For large files, we suggest reading them as views, rather than tables, this can be seen in the below example. Some basic functions and data aggregation methods can also be performed using DuckDB, but JS methods can also be used for this, and are <em>sometimes</em> more efficient. Regarding data manipulation, it is recommended to consolidate data wrangling into a few OJS cells rather than splitting each processing step into seperate cells. For example, you can use a block within a js cell to define multiple lines (<a href="https://observablehq.com/documentation/cells/">see Cells from Observable Documentation</a> for examples).</p><p>To use DuckDB to import subsets data into the documents from the S3:</p><div class="cell"><details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode cell-code" id="cb11" data-startfrom="157" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 156"><span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>viewof time <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"historic"</span><span class="op">,</span> <span class="st">"2021_2040"</span><span class="op">,</span> <span class="st">"2041_2060"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Timeframe"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"historic"</span>})</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> {</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db <span class="op">=</span> <span class="cf">await</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>()</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW Hazard AS</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT admin0_name, admin1_name, admin2_name, scenario, timeframe, hazard, value</span></span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM read_parquet("s3://digital-atlas/hazards/hazard_timeseries_mean/annual/haz_means_adm.parquet")</span></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="op">;</span></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">await</span> db<span class="op">;</span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a> <span class="co">// The query below can be made dynamic using template literals</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a> <span class="co">// and it will automatically re-run when the interpolated values change.</span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM Hazard</span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a><span class="vs">    WHERE admin1_name IS NULL</span></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND "hazard" IN ('HSH_max', 'HSH_mean', 'NDWL0', 'NDWS', 'NTx35', 'NTx40', 'TAI', 'THI_max', 'THI_mean', 'TAVG', 'PTOT')</span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND "timeframe" = '</span><span class="sc">${</span>time<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a><span class="vs">    LIMIT 3`</span></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db<span class="op">.</span><span class="fu">query</span>(query)</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div><div id="ojs-cell-5-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-5-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-5-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-5-4" data-nodetype="expression"></div></div></div></div><p>To load File Attachements follow this pattern:</p><div class="sourceCode" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}  </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"/data/shared/atlas-region_admin0_simplified.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p><strong>Important Note:</strong> Windows devices using certain web browsers have a error which results in cached parquet data becoming invalid when using DuckDB. This results in errors across any figure/section using this data when the page is reloaded or refreshed. The GitHub issue can be followed <a href="https://github.com/duckdb/duckdb-wasm/issues/1658">here</a>. The solution to this is to prevent the use of cached parquet data on windows devices. There is an included function in the <code>/helpers</code> folder which itentifies if the device is a windows device and prevents the use of cached data though “cache busting”. It is <strong>required</strong> to use this function when loading parquet data into a notebook. Its use can be seen in the above example using DuckDB.</p></section><section id="country-boundaries-and-geospatial-data" class="level2"><h2 data-anchor-id="country-boundaries-and-geospatial-data">Country Boundaries and Geospatial data</h2><p>For all spatial data within the Adaptation Atlas data explorations, use the following guidelines to maintain consistency and efficiency:</p><ol type="1"><li>Ensure that all maps, geographic selectors, and other geospatial elements utilize the <strong>Adaptation Atlas boundary dataset</strong>. These boundaries are based on the GAUL 2024, but include modifications so that country boundaries appear as each country represents themselves, including disputed areas.</li><li>In general the Data Explorations should provide data to admin level 2 where possible, although data should be limited to the highest resolution data avaliable.</li><li>Analysis and any raster extraction should use the highest resoltuon boundaries from the Atlas boundary dataset.</li><li>Any visualizations within the data explorations should use the low or very low resolution boundaries, unless there is a valid reason for using higher resolution boundaries. This is to insure fast page load speeds, as there is a signifigant difference in file sizes between dataset resolution.</li><li>Only one set of admin boundaries should be used in each data exploration - all datasets with a spatial “aspect” should be stored in raw tabular format and merged to the admin boundries within each notebook using the matching ‘admin0_name’, ‘admin1_name’, and ‘admin2_name’ columns. This will prevent multiple large boundary datasets from being loaded in each notebook.</li></ol></section></section><section id="notebook-code" class="level1"><h1>Notebook Code</h1><section id="ojs-in-quarto" class="level2"><h2 data-anchor-id="ojs-in-quarto">OJS in Quarto</h2><p>OJS is slighty different than vanilla JavaScript and cells will automatically re-run when a variable they are dependent on is changed. The main differences can be outlined in <a href="https://observablehq.com/documentation/cells/observable-javascript">the documentation</a>. Quarto includes code blocks and OJS itself is based on cells, so it is important to note some differences. It is possible to have multiple <em>OJS Cells</em> within a quarto code block, and OJS cells can include blocks of JavaScript code. This can be seen in the below example, which return the same resutl using 3 different ways of structuring the code:</p><p><strong>Example 1:</strong></p><div class="sourceCode" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">+</span> <span class="dv">5</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> y <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p><strong>Example 2:</strong></p><div class="sourceCode" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">+</span> <span class="dv">5</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> y <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p><strong>Example 3:</strong></p><div class="sourceCode" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> x <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> y <span class="op">=</span> x <span class="op">+</span> <span class="dv">5</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p>Example 1 and 2 are exactly the same, just split up across quarto code blocks. Both result in globals of <em>x</em> and <em>y</em> and <em>result</em>. Example 3 uses 1 quarto code block and 1 OJS cell with a block to return just <em>result</em> rather than the intermediate variables. In general, using a block to avoid assigning globals is preferred. Multiple OJS cells can be used in one Quarto code blocks, but aim for consistent and logical methods of organizing code.</p><p>Inline code blocks are useful for simple and short code such as selectors and text chunks. <strong>NOTE: These should only have 1 backtick at the start. The below example uses a extra backtick at the start as a hack to get the code to show correctly and prevent it from executing.</strong> For more about inline code, see the <a href="https://quarto.org/docs/computations/inline-code.html">Quarto docs</a></p><div class="sourceCode" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>This is some text in my document `<span class="in">`{ojs} "example".toUpperCase()`</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">### ``{ojs} "example_h3".toUpperCase()`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></section><section id="modular-code" class="level2"><h2 data-anchor-id="modular-code">Modular code</h2><section id="quarto-modules" class="level3"><h3 data-anchor-id="quarto-modules">Quarto Modules</h3><p>Elements of a notebook can be split into multiple different .qmd documents. This can be useful in keeping code cleaner and more organized. This can be done using the <code>{{&lt; include _myFile.qmd &gt;}}</code> shortcode</p><p>A few <strong>important considerations</strong> when doing this: - <strong>Variables, Functions, and JS modules are shared between the imports</strong> because the include/merge is done on build/render. - This means having x defined in both or importing the same module in both will result in an error. - There are no performance implications of doing this, since the files are merged on build. - Any additional qmd module files used for these imports should be in the same directory as the main notebook, and <strong>imported modules should begin with an underscore so that quarto does not try to render them as standalone</strong></p></section><section id="imports-in-ojs" class="level3"><h3 data-anchor-id="imports-in-ojs">Imports in OJS</h3><p>OJS cells also have the ability to call in imports. Unlike the above quarto imports, this is done post-render on the client.This can include importing other OJS cells, using the .ojs extension, importing local JS code and modules, and importing modules from NPM. Although possible, this method should not be used to import large sections of a notebook - the above Quarto imports are better suited for this. However, this is useful for sharing functions and importing external libraries.</p><p>To import a local JS module or code in an OJS file (documented <a href="https://quarto.org/docs/interactive/ojs/code-reuse.html">here</a>):</p><div class="sourceCode" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { lang <span class="im">as</span> Lang } <span class="im">from</span> <span class="st">"/helpers/lang.js"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasTOC<span class="op">,</span> atlasHero  } <span class="im">from</span> <span class="st">"/helpers/uiComponents.ojs"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><p>To import an NPM module or something from an observableHQ notebook:</p><div class="sourceCode" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>topojson <span class="op">=</span> <span class="pp">require</span>(<span class="st">"topojson"</span>) <span class="co">// Regular import</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span>) <span class="co">// With a version</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {resolveWindowsCacheIssue} <span class="im">from</span> <span class="st">"cbd32f92c155bf5b"</span> <span class="co">// From an observableHQ notebook</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>initgeosJs <span class="op">=</span> (<span class="cf">await</span> <span class="im">import</span>(<span class="st">"https://cdn.skypack.dev/geos-wasm"</span>))<span class="op">.</span><span class="at">default</span><span class="op">;</span> <span class="co">// Directly from a CDN</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>duckdb <span class="op">=</span> <span class="im">import</span>(<span class="st">"https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm@1.28.1-dev215.0/+esm"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></section><section id="folder-and-file-structure" class="level3"><h3 data-anchor-id="folder-and-file-structure">Folder and File structure</h3><p>The main folder structure for the project is as follows:</p><pre><code>.
├── index.qmd                   # Main index file required by Quarto
├── data
│&nbsp;&nbsp; ├── notebook_name           # Named folder containing individual notebook data
│&nbsp;  │&nbsp;&nbsp; ├── dataset1.json       # Notebook specific data not stored in S3
│&nbsp;  │&nbsp;&nbsp; └── S3_data.json        # Paths to data stored externally in S3
│&nbsp;  │&nbsp;&nbsp; └── translations.json   # Notebook specific translations
│&nbsp;&nbsp; └── shared                  # Data shared across notebooks
├── helpers                     # Code and modules shared between notebooks
├── images
│&nbsp;&nbsp; └── notebook_name.webp      # A single hero image for each notebook
├── notebooks                   # Code for all notebooks will end here
│&nbsp;&nbsp; └── notebook_name           # Named folder containing individual notebook code
│&nbsp;&nbsp;  &nbsp;&nbsp; ├── notebook_name.qmd   # Main notebook file
│&nbsp;&nbsp;  &nbsp;&nbsp; ├── _module1.qmd        # Module imported into main notebook
│&nbsp;&nbsp;  &nbsp;&nbsp; ├── _module2.qmd
│&nbsp;&nbsp;  &nbsp;&nbsp; └── notebook_stye.css   # Notebook specific styling
├── _quarto.yml                 # Main project configuration
├── README.md                   # Main project README
├── _site                       # Output directory build by Quarto on render
└── styles.css                  # Main project styling</code></pre><p>A concise and descriptive folder name should be used for each notebook, and this name should be used consistently across the main project folders (<em>i.e.</em> as the sub-directory names in the <code>/notebooks</code>, and <code>/data</code> folders and file names in the <code>/images</code> folder).</p></section></section></section><section id="translations" class="level1"><h1>Translations</h1><p>A small json of general translations can be found in the <code>/data/shared</code> directory. These may be useful to add in some basic translations, but each notebook will need a stand-alone translation document. This file is a good example of how the translations are handled within each notebook. Each notebook requires English and French at a minimum. More info on how translations are managed in the Atlas notebooks can be found <a href="../docs/translation.html">here</a>.</p></section><section id="shared-project-resources" class="level1"><h1>Shared Project Resources</h1><section id="shared-data" class="level2"><h2 data-anchor-id="shared-data">Shared Data</h2><p>At the moment the only data shared across all notebooks is the admin0 boundaries and some general translations. The admin1 and admin2 boundaries are stored and queried from the S3 bucket, but will be included in this folder in the future following a data update.</p></section><section id="helpers-and-functions" class="level2"><h2 data-anchor-id="helpers-and-functions">Helpers and functions</h2><p>The <code>/helpers</code> folder contains code and modules that are used across the notebooks. This includes the <code>lang</code> module for the translations, some style builders to build elements on the page such as the TOC and hero image, and functions to handle other tasks. This folder also includes a post-render script which is automatically run to minify the CSS and JS files.</p></section><section id="styling" class="level2"><h2 data-anchor-id="styling">Styling</h2><p>The main styling for the project can be found in the root directory under <code>styles.css</code>. Any styling that is notebook specific should be stored within the `/notebooks/notebook_name/” directory and applied using the yaml header at the top of the document/imported with OJS, or it should be including within the notebook code itself as a style block.</p></section></section><section id="other-documentation" class="level1"><h1>Other Documentation</h1><ul><li><strong><a href="https://observablehq.com/documentation/">Observable Documentation</a></strong>: for any questions about Observable, their documentation is a great resource.</li><li><strong><a href="https://quarto.org/docs/interactive/ojs/">Quarto OJS Documentation</a></strong>: contains info and an overview of using OJS cells within quarto</li><li><strong><a href="https://quarto.org/docs/guide/">Quarto Documentation</a></strong>: this is the general documentation for Quarto projects and contains many great tips and tricks for Quarto.</li></ul></section><section id="gotchas-and-tips" class="level1"><h1>Gotchas and Tips</h1><ul><li>Regularly delete the <code>_site</code> and <code>.quarto</code> files. These are auto generated by Quarto on build and can occasionally result in unexpected behavior and old versions of the notebooks to render.</li><li>There is a .gitignore in the project root you can use as a template to avoid committing the build files and other unwanted files.</li></ul><div class="cell"><details class="code-fold hidden"><summary>Show the code</summary><div class="sourceCode cell-code hidden" id="cb20" data-startfrom="169" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 168"><span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>nbTitle <span class="op">=</span> <span class="st">'Agriculture Adaptation Atlas: Data Exploration Guidelines'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details><div class="cell-output cell-output-display"><div id="ojs-cell-6" data-nodetype="declaration"></div></div></div></section></main><script type="ojs-module-contents">eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGF0bGFzSGVybyB9IGZyb20gXCIvaGVscGVycy91aUNvbXBvbmVudHMub2pzXCJcblxue1xuICBsZXQgaGVyb191cmwgPSBcIi4vLi4vaW1hZ2VzL2RlZmF1bHRfY3JvcC53ZWJwXCJcbiAgcmV0dXJuIGF0bGFzSGVybyhuYlRpdGxlLCBoZXJvX3VybClcbn1cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHsgYXRsYXNUT0MgfSBmcm9tIFwiL2hlbHBlcnMvdWlDb21wb25lbnRzLm9qc1wiXG5cbnRvY19ib3R0b20gPSBhdGxhc1RPQyh7XG4gIHNraXA6IFsnbm90ZWJvb2stdGl0bGUnLCAnYXBwZW5kaXgnLCAnc291cmNlLWNvZGUnXSwgLy8gaGVhZGluZyBpZHMgdG8gc2tpcFxuICBoZWFkaW5nOiBgPGI+SW4gVGhpcyBOb3RlYm9vazwvYj5gLFxuICBzZWxlY3RvcjogXCJoMVwiLCAvLyBTZWxlY3RvcnMgdG8gaW5jbHVkZSAoZS5nLiwgXCJoMSxoMixoM1wiKVxufSlcblxuaHRsLmh0bWxgXG4gICAgICA8ZGl2IGNsYXNzPSdmbG9hdGluZy10b2MnPlxuICAgICAgJHt0b2NfYm90dG9tfVxuICAgICAgPC9kaXY+XG4gICAgICBgXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjb2xvclNjYWxlcyA9IFtcbiAgeyBuYW1lOiBcInllbGxvd0dyZWVuXCIsIHJhbmdlOiBbXCIjRjdENzMyXCIsIFwiIzIxNjcyOVwiXSB9LFxuICB7IG5hbWU6IFwib3JhbmdlUmVkXCIsIHJhbmdlOiBbXCIjRjRCQjIxXCIsIFwiI0VDNUE0N1wiXSB9XG5dXG5cbnZpZXdvZiBzZWxlY3QgPSBJbnB1dHMuc2VsZWN0KGNvbG9yU2NhbGVzLCB7bGFiZWw6IFwiU2hvdyBhIGNvbG9yIHNjYWxlXCIsIGZvcm1hdDogeCA9PiB4Lm5hbWV9KVxuXG5QbG90LnBsb3Qoe1xuICBjb2xvcjoge1xuICAgIHR5cGU6IFwibGluZWFyXCIsXG4gICAgcmFuZ2U6IHNlbGVjdC5yYW5nZSxcbiAgfSxcbiAgbWFya3M6IFtcbiAgICBQbG90LmNlbGwoZDMucmFuZ2UoNTApLCB7eDogZCA9PiBkLCBmaWxsOiBkID0+IGR9KVxuICBdLFxuICBheGlzOiBudWxsLFxuICBoZWlnaHQ6IDMwLFxuICB4OiB7cGFkZGluZzogLTAuMX0sXG4gIHdpZHRoOiA2MDBcbn0pXG5cbnZpZXdvZiBjb3B5SW1wb3J0ID0gSW5wdXRzLmJ1dHRvbihgQ29weSAke3NlbGVjdC5uYW1lfSBjb2xvciByYW5nZWAsIHtyZWR1Y2U6ICgpID0+IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHNlbGVjdC5yYW5nZSl9KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgdmFyMV9tYXN0ZXIgPSBJbnB1dHMucmFkaW8oW1widmFyMVwiLCBcInZhcjJcIiwgXCJ2YXIzXCJdLCB7bGFiZWw6IFwiVmFyaWFibGUgMVwiLCB2YWx1ZTogXCJ2YXIxXCJ9KVxuXG52aWV3b2YgZm9ybSA9IElucHV0cy5mb3JtKCAvLyByZXR1cm5zIGEgSlMgb2JqZWN0IG9mIHt2YXIxOiAuLi4sIHZhcjI6IC4uLn1cbiAge1xuICAgIHZhcjE6IElucHV0cy5iaW5kKFxuICAgICAgSW5wdXRzLnJhZGlvKFtcIjFcIiwgXCIyXCIsIFwiM1wiXSwge2xhYmVsOiBcIlZhcmlhYmxlIDFcIiwgdmFsdWU6IHZhcjFfbWFzdGVyfSksXG4gICAgICB2aWV3b2YgdmFyMV9tYXN0ZXJcbiAgICApLFxuICAgIHZhcjI6IElucHV0cy5zZWxlY3QoW1wiYVwiLCBcImJcIiwgXCJjXCJdLCB7bGFiZWw6IFwiVmFyaWFibGUgMlwiLCB2YWx1ZTogXCJ2YXIyXCJ9KVxuICB9LFxuICB7XG4gICAgdGVtcGxhdGU6IChpbnB1dHMpID0+IGh0bC5odG1sYFxuICAgICAgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGdhcDogM2VtXCI+XG4gICAgICAgICR7T2JqZWN0LnZhbHVlcyhpbnB1dHMpfVxuICAgICAgPC9kaXY+YFxuICB9XG4pXG5cbmZvcm1cblxudmFyMV9tYXN0ZXJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ilxudmlld29mIHRpbWUgPSBJbnB1dHMucmFkaW8oW1wiaGlzdG9yaWNcIiwgXCIyMDIxXzIwNDBcIiwgXCIyMDQxXzIwNjBcIl0sIHtsYWJlbDogXCJUaW1lZnJhbWVcIiwgdmFsdWU6IFwiaGlzdG9yaWNcIn0pXG5cbmRiID0ge1xuICBsZXQgZGIgPSBhd2FpdCBEdWNrREJDbGllbnQub2YoKVxuICBhd2FpdCBkYi5xdWVyeShgXG4gICAgQ1JFQVRFIFZJRVcgSGF6YXJkIEFTXG4gICAgU0VMRUNUIGFkbWluMF9uYW1lLCBhZG1pbjFfbmFtZSwgYWRtaW4yX25hbWUsIHNjZW5hcmlvLCB0aW1lZnJhbWUsIGhhemFyZCwgdmFsdWVcbiAgICBGUk9NIHJlYWRfcGFycXVldChcInMzOi8vZGlnaXRhbC1hdGxhcy9oYXphcmRzL2hhemFyZF90aW1lc2VyaWVzX21lYW4vYW5udWFsL2hhel9tZWFuc19hZG0ucGFycXVldFwiKVxuICBgKTtcbiAgcmV0dXJuIGF3YWl0IGRiO1xufVxuXG5kYXRhID0ge1xuIC8vIFRoZSBxdWVyeSBiZWxvdyBjYW4gYmUgbWFkZSBkeW5hbWljIHVzaW5nIHRlbXBsYXRlIGxpdGVyYWxzXG4gLy8gYW5kIGl0IHdpbGwgYXV0b21hdGljYWxseSByZS1ydW4gd2hlbiB0aGUgaW50ZXJwb2xhdGVkIHZhbHVlcyBjaGFuZ2UuXG4gIGxldCBxdWVyeSA9IGBcbiAgICBTRUxFQ1QgKlxuICAgIEZST00gSGF6YXJkXG4gICAgV0hFUkUgYWRtaW4xX25hbWUgSVMgTlVMTFxuICAgIEFORCBcImhhemFyZFwiIElOICgnSFNIX21heCcsICdIU0hfbWVhbicsICdORFdMMCcsICdORFdTJywgJ05UeDM1JywgJ05UeDQwJywgJ1RBSScsICdUSElfbWF4JywgJ1RISV9tZWFuJywgJ1RBVkcnLCAnUFRPVCcpXG4gICAgQU5EIFwidGltZWZyYW1lXCIgPSAnJHt0aW1lfSdcbiAgICBMSU1JVCAzYFxuICByZXR1cm4gZGIucXVlcnkocXVlcnkpXG59XG5cbmRhdGFcblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibmJUaXRsZSA9ICdBZ3JpY3VsdHVyZSBBZGFwdGF0aW9uIEF0bGFzOiBEYXRhIEV4cGxvcmF0aW9uIEd1aWRlbGluZXMnXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjb3B5SW1wb3J0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3ZhcjFfbWFzdGVyJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Zvcm0nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndGltZScpIn1dfQ==</script><script type="module">"file:"===window.location.protocol&&alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."),window._ojs.paths.runtimeToDoc="../../docs",window._ojs.paths.runtimeToRoot="../..",window._ojs.paths.docToRoot="..",window._ojs.selfContained=!1,window._ojs.runtime.interpretFromScriptTags()</script><script id="quarto-html-after-body" type="application/javascript">window.document.addEventListener("DOMContentLoaded",(function(t){const e=t=>{for(const e of t.classList)if(e.startsWith("code-annotation-"))return!0;return!1},n=function(t){const e=t.trigger;e.blur(),e.classList.add("code-copy-button-checked");var n=e.getAttribute("title");let o;e.setAttribute("title","Copied!"),window.bootstrap&&(e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-placement","left"),e.setAttribute("data-bs-title","Copied!"),o=new bootstrap.Tooltip(e,{trigger:"manual",customClass:"code-copy-button-tooltip",offset:[0,-8]}),o.show()),setTimeout((function(){o&&(o.hide(),e.removeAttribute("data-bs-title"),e.removeAttribute("data-bs-toggle"),e.removeAttribute("data-bs-placement")),e.setAttribute("title",n),e.classList.remove("code-copy-button-checked")}),1e3),t.clearSelection()},o=function(t){const n=t.previousElementSibling.cloneNode(!0);for(const t of n.children)e(t)&&t.remove();return n.innerText};if(new window.ClipboardJS(".code-copy-button:not([data-in-quarto-modal])",{text:o}).on("success",n),window.document.getElementById("quarto-embedded-source-code-modal")){new window.ClipboardJS(".code-copy-button[data-in-quarto-modal]",{text:o,container:window.document.getElementById("quarto-embedded-source-code-modal")}).on("success",n)}for(var i,l=new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//),a=new RegExp(/^mailto:/),r=new RegExp("https://adaptationatlas.github.io/atlas_notebooks/"),d=window.document.querySelectorAll("a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"),c=0;c<d.length;c++){const t=d[c];i=t.href,r.test(i)||l.test(i)||a.test(i)||void 0!==t.dataset.originalHref&&(t.href=t.dataset.originalHref)}function s(t,e,n,o){const i={allowHTML:!0,maxWidth:500,delay:100,arrow:!1,appendTo:function(t){return t.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"bottom-start"};e&&(i.content=e),n&&(i.onTrigger=n),o&&(i.onUntrigger=o),window.tippy(t,i)}const u=window.document.querySelectorAll('a[role="doc-noteref"]');for(c=0;c<u.length;c++){const t=u[c];s(t,(function(){let e=t.getAttribute("data-footnote-href")||t.getAttribute("href");try{e=new URL(e).hash}catch{}const n=e.replace(/^#\/?/,""),o=window.document.getElementById(n);return o?o.innerHTML:""}))}const h=window.document.querySelectorAll("a.quarto-xref"),m=(t,e)=>{const n=t=>{if(t.classList.remove("page-full","page-columns"),t.children)for(const e of t.children)n(e)};if(n(e),null===t||t.startsWith("sec-")){const t=document.createElement("div");if(e.children&&e.children.length>2){t.appendChild(e.children[0].cloneNode(!0));for(let n=1;n<e.children.length;n++){const o=e.children[n];if("P"!==o.tagName||""!==o.innerText){t.appendChild(o.cloneNode(!0));break}}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.innerHTML}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.innerHTML}{const t=e.querySelector("a.anchorjs-link");return t&&t.remove(),window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.classList.contains("callout")?e.outerHTML:e.innerHTML}};for(c=0;c<h.length;c++){const t=h[c];s(t,void 0,(function(e){e.disable();let n,o=t.getAttribute("href");if(o.startsWith("#"))n=o;else try{n=new URL(o).hash}catch{}if(n){const t=n.replace(/^#\/?/,""),i=window.document.getElementById(t);if(null!==i)try{const n=m(t,i.cloneNode(!0));e.setContent(n)}finally{e.enable(),e.show()}else fetch(o.split("#")[0]).then((t=>t.text())).then((n=>{const o=(new DOMParser).parseFromString(n,"text/html").getElementById(t);if(null!==o){const n=m(t,o);e.setContent(n)}})).finally((()=>{e.enable(),e.show()}))}else fetch(o).then((t=>t.text())).then((t=>{const n=(new DOMParser).parseFromString(t,"text/html").querySelector("main.content");if(null!==n){n.children.length>0&&"HEADER"===n.children[0].tagName&&n.children[0].remove();const t=m(null,n);e.setContent(t)}})).finally((()=>{e.enable(),e.show()}))}),(function(t){}))}let w;const g=t=>{window.document;const e=t.getAttribute("data-target-cell"),n=t.getAttribute("data-target-annotation");const o=window.document.querySelector('span[data-code-cell="'+e+'"][data-code-annotation="'+n+'"]').getAttribute("data-code-lines").split(",").map((t=>e+"-"+t));let i=null,l=null,a=null;if(o.length>0){const n=window.document.getElementById(o[0]);if(i=n.offsetTop,l=n.offsetHeight,a=n.parentElement.parentElement,o.length>1){const t=window.document.getElementById(o[o.length-1]);l=t.offsetTop+t.offsetHeight-i}if(null!==i&&null!==l&&null!==a){let t=window.document.getElementById("code-annotation-line-highlight");null===t&&(t=window.document.createElement("div"),t.setAttribute("id","code-annotation-line-highlight"),t.style.position="absolute",a.appendChild(t)),t.style.top=i-2+"px",t.style.height=l+4+"px",t.style.left=0;let n=window.document.getElementById("code-annotation-line-highlight-gutter");if(null===n){n=window.document.createElement("div"),n.setAttribute("id","code-annotation-line-highlight-gutter"),n.style.position="absolute";window.document.getElementById(e).querySelector(".code-annotation-gutter").appendChild(n)}n.style.top=i-2+"px",n.style.height=l+4+"px"}w=t}},p=()=>{["code-annotation-line-highlight","code-annotation-line-highlight-gutter"].forEach((t=>{const e=window.document.getElementById(t);e&&e.remove()})),w=void 0};window.addEventListener("resize",function(t,e){let n,o=!1;return(...i)=>{o?(n&&clearTimeout(n),n=setTimeout((()=>{t.apply(this,i),n=o=!1}),e)):(t.apply(this,i),o=!0)}}((()=>{elRect=void 0,w&&g(w)}),10));const f=window.document.querySelectorAll("dt[data-target-cell]");for(const t of f)t.addEventListener("click",(t=>{const e=t.target;if(e!==w){p();const t=window.document.querySelector("dt[data-target-cell].code-annotation-active");t&&t.classList.remove("code-annotation-active"),g(e),e.classList.add("code-annotation-active")}else p(),e.classList.remove("code-annotation-active")}));const b=t=>{const e=t.parentElement;if(e){const n=e.dataset.cites;return n?{el:t,cites:n.split(" ")}:b(t.parentElement)}};var y=window.document.querySelectorAll('a[role="doc-biblioref"]');for(c=0;c<y.length;c++){const t=y[c],e=b(t);e&&s(e.el,(function(){var t=window.document.createElement("div");return e.cites.forEach((function(e){var n=window.document.createElement("div");n.classList.add("hanging-indent"),n.classList.add("csl-entry");var o=window.document.getElementById("ref-"+e);o&&(n.innerHTML=o.innerHTML),t.appendChild(n)})),t.innerHTML}))}}))</script></div></body></html>