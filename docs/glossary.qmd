---
pagetitle: "Atlas Glossary"
nb-authors:
  - Hannah Lang
  - Lolita Muller
  - Brayden Youngberg
  - Pete Stewart
date-created: "2025-11-10"
date-edited: today

format:
  html:
    include-in-header:
      - text: |
          <script src="./../components/backToTop.js"></script>
filters:
  - ./../helpers/glossaryToJSON.lua
---

{{< include "/components/_toc.qmd" >}}

<back-to-top></back-to-top>

# Atlas Definitions

```{=html}
<input
  type="text"
  id="searchBox"
  placeholder="Search glossary..."
style="margin-bottom: 10px; padding: 8px; width: 100%; max-width: 400px; max-height : 40px;"
/>

<div id="output"></div>
```

```{=html}
<script>
const navEnd = document.querySelector(".navbar-nav.ms-auto .nav-item.compact");

if (navEnd) {
  // Only add it if it doesn't already exist
  if (!document.getElementById("nav-lang-selector")) {
    // Create wrapper
    const langSel = document.createElement("div");
    langSel.id = "nav-lang-selector";
    langSel.style.display = "flex";
    langSel.style.alignItems = "center";
    langSel.style.marginLeft = "10px";

    // Create inner container
    const langDiv = document.createElement("div");
    langDiv.style.display = "flex";
    langDiv.style.flexDirection = "column";

    // Build radios dynamically
    const langs = [
      { code: "EN", label: "English" },
      { code: "FR", label: "Français" },
    ];

    langs.forEach(lang => {
      const label = document.createElement("label");
      label.style.fontWeight = "500";
      label.style.cursor = "pointer";

      const input = document.createElement("input");
      input.type = "radio";
      input.name = "language";
      input.value = lang.code;
      input.style.accentColor = "var(--atlasGreen)";
      input.style.marginRight = "5px";
      input.style.cursor = "pointer";

      if (lang.code === "EN") input.checked = true;

      // When changed → handle switching logic
      input.addEventListener("change", e => {
        if (e.target.checked) {
          currentLang = lang.code;
          window.currentLang = lang.code;
          renderGlossary();
          updateSearchPlaceholder();
        }
      });

      label.appendChild(input);
      label.appendChild(document.createTextNode(lang.label));
      langDiv.appendChild(label);
    });

    // Assemble and attach
    langSel.appendChild(langDiv);
    navEnd.parentNode.appendChild(langSel);
  }
}
</script>
```

```{=html}
<script>
let currentLang = 'EN';
let glossaryData = null;
let searchQuery = '';

fetch("./../../data/shared/glossary.json")
  .then(response => {
    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
    return response.json();
  })
  .then(data => {
    glossaryData = data;
    renderGlossary();

    // Language toggle
    document.querySelectorAll('input[name="language"]').forEach(radio => {
      // currentLang = localStorage.getItem('glossaryLang') || 'EN';
      radio.addEventListener('change', event => {
        currentLang = event.target.value;
        updateSearchPlaceholder();
        renderGlossary();
        updateBackToTopLabel();
      });
    });

    // Search filter
    let searchTimeout;
    document.getElementById('searchBox').addEventListener('input', event => {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        searchQuery = event.target.value.toLowerCase();
        renderGlossary();
      }, 200);
    });
    updateSearchPlaceholder();
  })
  .catch(error => {
    console.error("Error loading JSON:", error);
    document.getElementById("output").innerHTML =
      `<p style="color: red;">Error loading glossary: ${error.message}</p>`;
  });

function updateSearchPlaceholder() {
  const searchBox = document.getElementById('searchBox');
  searchBox.placeholder =
    currentLang === 'FR' ? 'Rechercher dans le glossaire...' : 'Search glossary...';
}

// Sanitize section name for use as HTML ID
function sanitizeId(str) {
  return str
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-+|-+$/g, '');
}

// Render glossary
function renderGlossary() {
  if (!glossaryData) return;

  const sections = {};
  Object.entries(glossaryData).forEach(([key, entry]) => {
    const section = entry.Section || 'Other';
    if (!sections[section]) sections[section] = [];
    sections[section].push({ key, ...entry });
  });

  let html = '<div>';

  Object.keys(sections).sort().forEach(section => {
    const filteredEntries = sections[section].filter(entry => {
      const term = entry.Term?.toLowerCase() || '';
      const acronym = entry.Acronym?.toLowerCase() || '';
      const defEN = entry['Definition EN']?.toLowerCase() || entry['Definiton EN']?.toLowerCase() || '';
      const defFR = entry['Definition FR']?.toLowerCase() || '';
      const tooltipEN = entry['Tooltip EN']?.toLowerCase() || '';
      const tooltipFR = entry['Tooltip FR']?.toLowerCase() || '';

      return (
        !searchQuery ||
        term.includes(searchQuery) ||
        acronym.includes(searchQuery) ||
        defEN.includes(searchQuery) ||
        defFR.includes(searchQuery) ||
        tooltipEN.includes(searchQuery) ||
        tooltipFR.includes(searchQuery)
      );
    });

    if (filteredEntries.length === 0) return;

    const sectionId = sanitizeId(section);
    html += `<h1 id="section-${sectionId}">${section}</h1>`;

    filteredEntries
      .sort((a, b) => a.Term.localeCompare(b.Term))
      .forEach(entry => {
        const acronym = entry.Acronym?.trim() || null;
        const definition =
          currentLang === 'EN'
            ? entry['Definiton EN'] || entry['Definition EN'] || ''
            : entry['Definition FR'] || '';
        const tooltip =
          currentLang === 'EN' ? entry['Tooltip EN'] || '' : entry['Tooltip FR'] || '';

        html += '<div style="margin-bottom: 30px;">';
        html += `<h2 style="color: #555; margin-bottom: 5px; font-size: 1.3em;">
                  ${entry.Term}${acronym ? ` (${acronym})` : ''}
                 </h2>`;
        if (tooltip)
          html += `<p style="color: #667; font-style: italic; margin: 5px 0; font-size: 0.9em;">${tooltip}</p>`;
        if (definition)
          html += `<p style="color: #444; line-height: 1.6; margin-top: 10px;">${definition}</p>`;
        html += '</div>';
      });
  });

  html += '</div>';
  document.getElementById('output').innerHTML = html;
}
</script>
```
